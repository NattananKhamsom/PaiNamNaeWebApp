import{_ as Ye,m as Re,r as v,y as et,x as tt,i as lt,c,a as e,b as Ie,f as Y,h as V,v as G,z as Se,t as d,g as _,F as M,q as S,w as $e,T as Ne,B as ge,o as m,d as Ve,n as at,C as je,s as st}from"./DPSIKoxe.js";import{d as R}from"./B5yDJBm8.js";import{b as nt}from"./C5FTVxxA.js";import{u as ot}from"./DOK8vhV6.js";import{u as it}from"./BaxiziUg.js";import{s as rt}from"./x_rD_Ya3.js";import"./Cpj98o6Y.js";const dt={class:"px-4 py-8 mx-auto max-w-7xl sm:px-6 lg:px-8"},ut={class:"p-6 mb-8 bg-white border border-gray-300 rounded-lg shadow-md"},ct={class:"relative"},mt={class:"relative"},gt={class:"grid grid-cols-1 gap-6 lg:grid-cols-3"},pt={class:"lg:col-span-2"},vt={class:"bg-white border border-gray-300 rounded-lg shadow-md"},ft={class:"p-6 border-b border-gray-300"},bt={class:"text-lg font-semibold text-gray-900"},yt={key:0,class:"p-6 text-center text-gray-500"},xt={key:1,class:"divide-y divide-gray-200"},_t={key:0,class:"p-6 text-center text-gray-500"},ht=["onClick"],kt={class:"mb-6 font-semibold text-center text-gray-900"},wt={class:"flex items-start space-x-4"},Mt=["src","alt"],Pt={class:"flex-1"},Ct={class:"flex items-start justify-between"},Lt={class:"flex items-center"},At={class:"font-semibold text-gray-900"},Tt={key:0,class:"relative group ml-1.5 flex items-center"},Bt={class:"flex items-center mt-1"},It={class:"flex text-yellow-400"},St={class:"ml-2 text-sm text-gray-600"},$t={class:"text-right"},Nt={class:"text-lg font-bold text-blue-600"},Vt={class:"mt-3"},jt={class:"flex flex-wrap items-center text-sm text-gray-600"},zt={class:"font-medium"},Et={class:"ml-1"},Ft={class:"ml-1"},Dt={class:"ml-1"},Ot={class:"flex items-center mt-2 text-sm text-gray-600"},Ut={key:0,class:"pt-4 mt-4 duration-300 border-t border-gray-300 animate-in slide-in-from-top"},Kt={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},Gt={class:"space-y-1 text-sm text-gray-600"},Ht={key:0},Zt={key:1},qt={key:2},Wt={key:3},Jt={class:"space-y-1 text-sm text-gray-600"},Qt={class:"space-y-1 text-sm text-gray-600"},Xt={class:"mt-4 space-y-4"},Yt={key:0},Rt={class:"p-3 text-sm text-gray-700 border border-gray-300 rounded-md bg-gray-50"},el={key:1},tl={class:"grid grid-cols-3 gap-2 mt-2"},ll=["src"],al={class:"flex justify-end mt-4"},sl=["onClick","disabled"],nl={class:"lg:col-span-1"},ol={class:"sticky overflow-hidden bg-white border border-gray-300 rounded-lg shadow-md top-8"},il={class:"modal-content"},rl={key:0,class:"flex items-center justify-between p-6 border-b border-gray-300"},dl={class:"flex items-center justify-between p-4 border-b border-gray-300"},ul={class:"text-lg font-semibold text-gray-900"},cl={class:"p-0"},ml={class:"flex items-center justify-between p-4 border-t border-gray-200"},gl={class:"text-sm text-gray-700 truncate"},pl={class:"truncate"},vl=["disabled"],fl={class:"p-6"},bl={class:"mb-6"},yl={class:"flex items-center p-3 space-x-3 rounded-lg bg-gray-50"},xl=["src","alt"],_l={class:"flex items-center"},hl={class:"font-medium text-gray-900"},kl={key:0,class:"relative group ml-1.5 flex items-center"},wl={class:"flex items-center"},Ml={class:"flex text-sm text-yellow-400"},Pl={class:"ml-2 text-sm text-gray-600"},Cl={class:"grid grid-cols-1 gap-6 mb-6 md:grid-cols-2"},Ll={class:"p-3 text-gray-900 rounded-lg bg-gray-50"},Al={class:"p-3 text-gray-900 rounded-lg bg-gray-50"},Tl={class:"mb-6"},Bl={class:"flex items-center p-3 space-x-4 rounded-lg bg-gray-50"},Il={class:"flex-1"},Sl={class:"font-medium text-gray-900"},$l={class:"flex-1 text-right"},Nl={class:"font-medium text-gray-900"},Vl={class:"mb-6 space-y-4"},jl=["value"],zl={class:"relative"},El={class:"relative"},Fl={class:"p-4 mb-6 rounded-lg bg-blue-50"},Dl={class:"flex items-center justify-between mb-2"},Ol={class:"font-medium text-gray-900"},Ul={class:"flex items-center justify-between mb-2"},Kl={class:"font-medium text-gray-900"},Gl={class:"pt-2 mt-2 border-t border-gray-300"},Hl={class:"flex items-center justify-between"},Zl={class:"text-lg font-bold text-blue-600"},ql={class:"modal-content"},Wl={class:"flex items-center justify-between p-4 border-b border-gray-300"},Jl={class:"text-lg font-semibold text-gray-900"},Ql={class:"p-4 space-y-3"},Xl={class:"text-sm text-gray-700"},Yl={class:"truncate"},Rl={key:0,class:"text-gray-500"},ea={class:"flex gap-3 pt-2"},ta=["disabled"],pe="__gmapsReady__",la={__name:"index_v7",setup(aa){var Be;R.locale("th"),R.extend(nt);const{$api:ve}=Re(),{toast:ee}=st(),{token:ze}=ot(),Ee=et(),te=v(null),le=v(null);let P=null,C=null;const L=v({lat:null,lng:null,placeId:null,address:null,name:null}),A=v({lat:null,lng:null,placeId:null,address:null,name:null}),$=v(null),fe=v(null);let H=null,D=null;const k=v({name:"",lat:null,lng:null,placeId:null,address:null}),ae=v(null),se=v(null);let ne=null,oe=null;const ie=v(!1),j=v(null),be=v(null);let Z=null,O=null;const x=v({name:"",lat:null,lng:null}),Fe=[];(Be=window.google)!=null&&Be.maps||Fe.push({key:"gmaps",src:`https://maps.googleapis.com/maps/api/js?key=${Ee.public.googleMapsApiKey}&libraries=places,geometry&callback=${pe}`,async:!0,defer:!0}),it({});const b=v({origin:"",destination:"",date:"",seats:"1"}),T=v([]),N=v(null),re=v(!1),de=v(null);let w=null,q=null,W=null,J=null,z=null,E=null;const ue=v(!1),ce=v(!1),y=v(null),F=v(1),B=v(""),I=v(""),De=tt(()=>y.value?F.value*y.value.price:0);async function me(){re.value=!0,N.value=null;try{const s=await ve("/routes"),t=((s==null?void 0:s.data)||s||[]).filter(a=>a.status==="AVAILABLE");T.value=t.map(a=>{var o,n,u,r,i,g,p,f,h,K;return{id:a.id,availableSeats:a.availableSeats,price:a.pricePerSeat,departureTime:R(a.departureTime).format("HH:mm น."),date:R(a.departureTime).format("D MMMM BBBB"),start:a.startLocation,end:a.endLocation,originName:((o=a.startLocation)==null?void 0:o.name)||`(${a.startLocation.lat.toFixed(2)}, ${a.startLocation.lng.toFixed(2)})`,destinationName:((n=a.endLocation)==null?void 0:n.name)||`(${a.endLocation.lat.toFixed(2)}, ${a.endLocation.lng.toFixed(2)})`,originAddress:((u=a.startLocation)==null?void 0:u.address)||null,destinationAddress:((r=a.endLocation)==null?void 0:r.address)||null,driver:{name:`${((i=a.driver)==null?void 0:i.firstName)||""} ${((g=a.driver)==null?void 0:g.lastName)||""}`.trim()||"ไม่ระบุชื่อ",image:((p=a.driver)==null?void 0:p.profilePicture)||`https://ui-avatars.com/api/?name=${encodeURIComponent(((f=a.driver)==null?void 0:f.firstName)||"U")}&background=random&size=64`,rating:4.5,reviews:Math.floor(Math.random()*50)+5,isVerified:!!((h=a.driver)!=null&&h.isVerified)},carDetails:a.vehicle?[`${a.vehicle.vehicleModel} (${a.vehicle.vehicleType})`,...a.vehicle.amenities||[]]:["ไม่มีข้อมูลรถ"],conditions:a.conditions,photos:((K=a.vehicle)==null?void 0:K.photos)||[],durationText:a.duration||"-",distanceText:a.distance||"-",polyline:a.routePolyline||null}}),await xe();const l=T.value.map(async(a,o)=>{var g,p;const[n,u]=await Promise.all([ye(a.start.lat,a.start.lng),ye(a.end.lat,a.end.lng)]),r=await U(n),i=await U(u);!((g=a.start)!=null&&g.name)&&r.name&&(T.value[o].originName=r.name),!((p=a.end)!=null&&p.name)&&i.name&&(T.value[o].destinationName=i.name)});await Promise.allSettled(l)}catch(s){console.error("Failed to fetch routes:",s),T.value=[]}finally{re.value=!1}}function ye(s,t){return new Promise(l=>{if(!z)return l(null);z.geocode({location:{lat:s,lng:t}},(a,o)=>{if(o!=="OK"||!(a!=null&&a.length))return l(null);l(a[0])})})}async function U(s){if(!s)return{name:null,area:null};const t=s.address_components||[],l=p=>{var f;return(f=t.find(h=>h.types.includes(p)))==null?void 0:f.long_name},a=p=>{var f;return(f=t.find(h=>h.types.includes(p)))==null?void 0:f.short_name},o=s.types||[],n=o.includes("point_of_interest")||o.includes("establishment")||o.includes("premise");let u=null;if(n&&s.place_id){const p=await Ke(s.place_id);p&&(u=p)}if(!u){const p=l("street_number"),f=l("route");u=p&&f?`${p} ${f}`:f||s.formatted_address||null}const r=l("sublocality")||l("neighborhood")||l("locality")||l("administrative_area_level_2"),i=l("administrative_area_level_1")||a("administrative_area_level_1");let g=null;return r&&i?g=`${r}, ${i}`:i&&(g=i),u&&(u=u.replace(/,?\s*(Thailand|ไทย)\s*$/i,"")),{name:u,area:g}}const Oe=s=>{N.value&&N.value.id===s.id?(N.value=null,_e()):(N.value=s,Ue(s))};function xe(){return new Promise(s=>{if(ue.value)return s(!0);const t=rt(()=>{ue.value&&(clearInterval(t),s(!0))},50)})}function _e(){q&&(q.setMap(null),q=null),W&&(W.setMap(null),W=null),J&&(J.setMap(null),J=null)}async function Ue(s){var t;if(s&&(await xe(),!(!w||!(w instanceof google.maps.Map))))if(_e(),W=new google.maps.Marker({position:{lat:s.start.lat,lng:s.start.lng},map:w,label:"A"}),J=new google.maps.Marker({position:{lat:s.end.lat,lng:s.end.lng},map:w,label:"B"}),s.polyline&&((t=google.maps.geometry)!=null&&t.encoding)){const l=google.maps.geometry.encoding.decodePath(s.polyline);q=new google.maps.Polyline({path:l,map:w,strokeColor:"#2563eb",strokeOpacity:.9,strokeWeight:5});const a=new google.maps.LatLngBounds;l.forEach(o=>a.extend(o)),w.fitBounds(a)}else{const l=new google.maps.LatLng(Math.min(s.start.lat,s.end.lat),Math.min(s.start.lng,s.end.lng)),a=new google.maps.LatLng(Math.max(s.start.lat,s.end.lat),Math.max(s.start.lng,s.end.lng)),o=new google.maps.LatLngBounds(l,a);w.fitBounds(o)}}function Ke(s){return new Promise(t=>{if(!E||!s)return t(null);E.getDetails({placeId:s,fields:["name"]},(l,a)=>{a===google.maps.places.PlacesServiceStatus.OK&&(l!=null&&l.name)?t(l.name):t(null)})})}function Ge(s){if(!ze.value)return je("/login");s&&s.availableSeats>0&&(y.value=s,F.value=1,B.value="",I.value="",L.value={lat:null,lng:null,placeId:null,address:null,name:null},A.value={lat:null,lng:null,placeId:null,address:null,name:null},$.value=null,ce.value=!0,ge(()=>Je()))}function Q(){ce.value=!1,setTimeout(()=>{y.value=null},300)}async function He(){var t;if(!y.value)return;if(B.value&&!L.value.lat){const l=await Te(B.value);l&&(L.value=l)}if(I.value&&!A.value.lat){const l=await Te(I.value);l&&(A.value=l)}if(!L.value.lat||!A.value.lat){ee.warning("ข้อมูลไม่ครบถ้วน","กรุณาเลือกจุดขึ้นรถและจุดลงรถจากรายการหรือปักหมุดบนแผนที่");return}const s={routeId:y.value.id,numberOfSeats:F.value,pickupLocation:L.value,dropoffLocation:A.value};try{await ve("/bookings",{method:"POST",body:s}),Q(),ee.success("ส่งคำขอจองสำเร็จ!","คำขอของคุณถูกส่งไปให้ผู้ขับแล้ว โปรดรอการยืนยัน"),setTimeout(()=>je("/myTrip"),1500)}catch(l){console.error("Failed to create booking:",l),ee.error("เกิดข้อผิดพลาดในการจอง",((t=l.data)==null?void 0:t.message)||"โปรดลองใหม่อีกครั้งในภายหลัง")}}const he=()=>{!de.value||w||(w=new google.maps.Map(de.value,{center:{lat:13.7563,lng:100.5018},zoom:6,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!0}),z=new google.maps.Geocoder,E=new google.maps.places.PlacesService(w),ue.value=!0)};function ke(){var t,l;if(!ae.value||!se.value||!((l=(t=window.google)==null?void 0:t.maps)!=null&&l.places))return;const s={fields:["place_id","name","formatted_address","geometry"]};ne=new google.maps.places.Autocomplete(ae.value,{...s,types:["geocode","establishment"]}),ne.addListener("place_changed",()=>{var o,n,u,r,i,g;const a=ne.getPlace();a&&(b.value.origin=a.name||a.formatted_address||b.value.origin,b.value._originMeta={placeId:a.place_id||null,fullAddress:a.formatted_address||null,lat:((u=(n=(o=a.geometry)==null?void 0:o.location)==null?void 0:n.lat)==null?void 0:u.call(n))??null,lng:((g=(i=(r=a.geometry)==null?void 0:r.location)==null?void 0:i.lng)==null?void 0:g.call(i))??null})}),oe=new google.maps.places.Autocomplete(se.value,{...s,types:["geocode","establishment"]}),oe.addListener("place_changed",()=>{var o,n,u,r,i,g;const a=oe.getPlace();a&&(b.value.destination=a.name||a.formatted_address||b.value.destination,b.value._destinationMeta={placeId:a.place_id||null,fullAddress:a.formatted_address||null,lat:((u=(n=(o=a.geometry)==null?void 0:o.location)==null?void 0:n.lat)==null?void 0:u.call(n))??null,lng:((g=(i=(r=a.geometry)==null?void 0:r.location)==null?void 0:i.lng)==null?void 0:g.call(i))??null})})}function we(s){j.value=s,x.value={name:"",lat:null,lng:null},ie.value=!0,ge(()=>{const t={lat:13.7563,lng:100.5018},l=s==="origin"?b.value._originMeta:b.value._destinationMeta,a=l!=null&&l.lat&&(l!=null&&l.lng)?{lat:l.lat,lng:l.lng}:t;Z=new google.maps.Map(be.value,{center:a,zoom:l!=null&&l.lat?14:6,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1}),Z.addListener("click",o=>{const n=o.latLng;Ze(n),Me(n)})})}function Ze(s){if(O){O.setPosition(s);return}O=new google.maps.Marker({position:s,map:Z,draggable:!0}),O.addListener("dragend",t=>{Me(t.latLng)})}async function Me(s){const t=s.lat(),l=s.lng(),a=await new Promise(n=>{z.geocode({location:{lat:t,lng:l}},(u,r)=>{r==="OK"&&(u!=null&&u.length)?n(u[0]):n(null)})});let o="";if(a&&(o=(await U(a)).name||""),!o||We(o)){const n=await Pe(t,l,120);n!=null&&n.name?o=n.name:a!=null&&a.formatted_address&&(o=a.formatted_address.replace(/,?\s*(Thailand|ไทย)\s*$/i,""))}x.value={name:o,lat:t,lng:l}}function qe(){!j.value||!x.value.name||(j.value==="origin"?(b.value.origin=x.value.name,b.value._originMeta={placeId:null,fullAddress:null,lat:x.value.lat,lng:x.value.lng}):j.value==="destination"&&(b.value.destination=x.value.name,b.value._destinationMeta={placeId:null,fullAddress:null,lat:x.value.lat,lng:x.value.lng}),X())}function X(){ie.value=!1,j.value=null,O=null,Z=null}function We(s){return s?/^[A-Z0-9]{4,}\+[A-Z0-9]{2,}/i.test(s.trim()):!1}function Pe(s,t,l=100){return new Promise(a=>{if(!E)return a(null);E.nearbySearch({location:{lat:s,lng:t},radius:l},(o,n)=>{n===google.maps.places.PlacesServiceStatus.OK&&(o!=null&&o.length)?a(o[0]):a(null)})})}function Je(){var t,l,a,o;if(!((l=(t=window.google)==null?void 0:t.maps)!=null&&l.places))return;const s={fields:["place_id","name","formatted_address","geometry"],types:["geocode","establishment"]};te.value&&((a=P==null?void 0:P.unbindAll)==null||a.call(P),P=new google.maps.places.Autocomplete(te.value,s),P.addListener("place_changed",()=>{var u,r,i,g,p,f;const n=P.getPlace();n&&(B.value=n.name||n.formatted_address||B.value,L.value={lat:((i=(r=(u=n.geometry)==null?void 0:u.location)==null?void 0:r.lat)==null?void 0:i.call(r))??null,lng:((f=(p=(g=n.geometry)==null?void 0:g.location)==null?void 0:p.lng)==null?void 0:f.call(p))??null,placeId:n.place_id||null,address:n.formatted_address||null,name:n.name||null})})),le.value&&((o=C==null?void 0:C.unbindAll)==null||o.call(C),C=new google.maps.places.Autocomplete(le.value,s),C.addListener("place_changed",()=>{var u,r,i,g,p,f;const n=C.getPlace();n&&(I.value=n.name||n.formatted_address||I.value,A.value={lat:((i=(r=(u=n.geometry)==null?void 0:u.location)==null?void 0:r.lat)==null?void 0:i.call(r))??null,lng:((f=(p=(g=n.geometry)==null?void 0:g.location)==null?void 0:p.lng)==null?void 0:f.call(p))??null,placeId:n.place_id||null,address:n.formatted_address||null,name:n.name||null})}))}function Ce(s){$.value=s,k.value={name:"",lat:null,lng:null,placeId:null,address:null},ge(()=>{const t={lat:13.7563,lng:100.5018},l=s==="pickup"?L.value:A.value,a=l.lat&&l.lng?{lat:l.lat,lng:l.lng}:t;H=new google.maps.Map(fe.value,{center:a,zoom:l.lat?15:6,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1}),H.addListener("click",async o=>{const n=o.latLng;Qe(n),await Ae(n)})})}function Le(){$.value=null,H=null,D=null}function Qe(s){if(D)return D.setPosition(s);D=new google.maps.Marker({position:s,map:H,draggable:!0}),D.addListener("dragend",t=>Ae(t.latLng))}async function Ae(s){const t=s.lat(),l=s.lng(),a=await new Promise(r=>{z.geocode({location:{lat:t,lng:l}},(i,g)=>{g==="OK"&&(i!=null&&i.length)?r(i[0]):r(null)})});let o="",n=(a==null?void 0:a.place_id)||null,u=(a==null?void 0:a.formatted_address)||null;if(a&&(o=(await U(a)).name||""),!o){const r=await Pe(t,l,120);if(r!=null&&r.place_id){n=r.place_id;const i=await new Promise(g=>{E.getDetails({placeId:r.place_id,fields:["name","formatted_address"]},(p,f)=>g(f===google.maps.places.PlacesServiceStatus.OK?p:null))});o=(i==null?void 0:i.name)||r.name||o,u=(i==null?void 0:i.formatted_address)||u}}u&&(u=u.replace(/,?\s*(Thailand|ไทย)\s*$/i,"")),k.value={name:o,lat:t,lng:l,placeId:n,address:u}}function Xe(){if(!$.value||!k.value.name)return;const s={lat:k.value.lat,lng:k.value.lng,placeId:k.value.placeId,address:k.value.address,name:k.value.name};$.value==="pickup"?(B.value=s.name||s.address||"",L.value=s):(I.value=s.name||s.address||"",A.value=s),Le()}function Te(s){return new Promise(t=>{if(!s)return t(null);z.geocode({address:s},async(l,a)=>{var i,g,p,f,h,K;if(a!=="OK"||!(l!=null&&l.length))return t(null);const o=l[0],n=(p=(g=(i=o.geometry)==null?void 0:i.location)==null?void 0:g.lat)==null?void 0:p.call(g),u=(K=(h=(f=o.geometry)==null?void 0:f.location)==null?void 0:h.lng)==null?void 0:K.call(h),r=await U(o);t({lat:n,lng:u,placeId:o.place_id||null,address:(o.formatted_address||"").replace(/,?\s*(Thailand|ไทย)\s*$/i,""),name:r.name||null})})})}return lt(()=>{var s;if((s=window.google)!=null&&s.maps){he(),ke(),me();return}window[pe]=()=>{try{delete window[pe]}catch{}he(),ke(),me()}}),(s,t)=>(m(),c("div",null,[e("div",dt,[e("div",ut,[t[19]||(t[19]=e("h2",{class:"mb-6 text-xl font-semibold text-gray-900"},"ค้นหาการเดินทาง",-1)),e("form",{onSubmit:Y(me,["prevent"]),class:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-5"},[e("div",null,[t[12]||(t[12]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"จุดเริ่มต้น",-1)),e("div",ct,[V(e("input",{ref_key:"originInputEl",ref:ae,"onUpdate:modelValue":t[0]||(t[0]=l=>b.value.origin=l),type:"text",placeholder:"เช่น กรุงเทพฯ",class:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[G,b.value.origin]]),e("button",{type:"button",onClick:t[1]||(t[1]=l=>we("origin")),class:"absolute inset-y-0 my-auto text-gray-500 right-2 hover:text-blue-600",title:"เลือกจากแผนที่"},t[11]||(t[11]=[e("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[e("path",{d:"M12 2a7 7 0 00-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 00-7-7zm0 9.5a2.5 2.5 0 110-5 2.5 2.5 0 010 5z"})],-1)]))])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"จุดปลายทาง",-1)),e("div",mt,[V(e("input",{ref_key:"destinationInputEl",ref:se,"onUpdate:modelValue":t[2]||(t[2]=l=>b.value.destination=l),type:"text",placeholder:"เช่น เชียงใหม่",class:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[G,b.value.destination]]),e("button",{type:"button",onClick:t[3]||(t[3]=l=>we("destination")),class:"absolute inset-y-0 my-auto text-gray-500 right-2 hover:text-blue-600",title:"เลือกจากแผนที่"},t[13]||(t[13]=[e("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[e("path",{d:"M12 2a7 7 0 00-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 00-7-7zm0 9.5a2.5 2.5 0 110-5 2.5 2.5 0 010 5z"})],-1)]))])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"วันที่",-1)),V(e("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>b.value.date=l),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[G,b.value.date]])]),e("div",null,[t[17]||(t[17]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"จำนวนที่นั่ง",-1)),V(e("select",{"onUpdate:modelValue":t[5]||(t[5]=l=>b.value.seats=l),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},t[16]||(t[16]=[e("option",{value:"1"},"1 ที่นั่ง",-1),e("option",{value:"2"},"2 ที่นั่ง",-1),e("option",{value:"3"},"3 ที่นั่ง",-1),e("option",{value:"4"},"4 ที่นั่ง",-1)]),512),[[Se,b.value.seats]])]),t[18]||(t[18]=e("div",{class:"flex items-end"},[e("button",{type:"submit",class:"w-full px-4 py-2 text-white transition duration-200 bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"}," ค้นหา ")],-1))],32)]),e("div",gt,[e("div",pt,[e("div",vt,[e("div",ft,[e("h3",bt,"ผลการค้นหา ("+d(T.value.length)+" รายการ)",1)]),re.value?(m(),c("div",yt," กำลังค้นหาเส้นทาง... ")):(m(),c("div",xt,[T.value.length===0?(m(),c("div",_t," ไม่พบเส้นทางที่ค้นหา ")):_("",!0),(m(!0),c(M,null,S(T.value,l=>(m(),c("div",{key:l.id,class:"p-6 transition-all duration-300 cursor-pointer route-card hover:shadow-lg",onClick:a=>Oe(l)},[e("h1",kt,[Ve(d(l.originName)+" ",1),t[20]||(t[20]=e("span",{class:"mx-1 font-semibold text-gray-900"},"→",-1)),Ve(" "+d(l.destinationName),1)]),e("div",wt,[e("img",{src:l.driver.image,alt:l.driver.name,class:"object-cover w-12 h-12 rounded-full"},null,8,Mt),e("div",Pt,[e("div",Ct,[e("div",null,[e("div",Lt,[e("h4",At,d(l.driver.name),1),l.driver.isVerified?(m(),c("div",Tt,t[21]||(t[21]=[e("svg",{class:"w-5 h-5 text-blue-600",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8.603 3.799A4.49 4.49 0 0112 2.25c1.357 0 2.573.6 3.397 1.549a4.49 4.49 0 013.498 1.307 4.491 4.491 0 011.307 3.497A4.49 4.49 0 0121.75 12c0 1.357-.6 2.573-1.549 3.397a4.49 4.49 0 01-1.307 3.498 4.491 4.491 0 01-3.497 1.307A4.49 4.49 0 0112 21.75a4.49 4.49 0 01-3.397-1.549 4.49 4.49 0 01-3.498-1.306 4.491 4.491 0 01-1.307-3.498A4.49 4.49 0 012.25 12c0-1.357.6-2.573 1.549-3.397a4.49 4.49 0 011.307-3.497 4.49 4.49 0 013.497-1.307zm7.007 6.387a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.07-.01l3.5-4.875z","clip-rule":"evenodd"})],-1),e("span",{class:"absolute px-2 py-1 mb-2 text-xs text-white transition-opacity -translate-x-1/2 bg-gray-800 rounded-md opacity-0 pointer-events-none bottom-full left-1/2 w-max group-hover:opacity-100"}," ผู้ขับขี่ยืนยันตัวตนแล้ว ",-1)]))):_("",!0)]),e("div",Bt,[e("div",It,[(m(),c(M,null,S(5,a=>e("span",{key:a},d(a<=l.driver.rating?"★":"☆"),1)),64))]),e("span",St,d(l.driver.rating)+" ("+d(l.driver.reviews)+" รีวิว) ",1)])]),e("div",$t,[e("div",Nt,d(l.price)+" บาท",1),t[22]||(t[22]=e("div",{class:"text-sm text-gray-600"},"ต่อที่นั่ง",-1))])]),e("div",Vt,[e("div",jt,[e("span",zt,d(l.date),1),t[23]||(t[23]=e("span",{class:"mx-2 text-gray-300"},"|",-1)),t[24]||(t[24]=e("span",{class:"font-medium"},"เวลาออก:",-1)),e("span",Et,d(l.departureTime),1),t[25]||(t[25]=e("span",{class:"mx-2 text-gray-300"},"|",-1)),t[26]||(t[26]=e("span",{class:"font-medium"},"ระยะเวลา:",-1)),e("span",Ft,d(l.durationText),1),t[27]||(t[27]=e("span",{class:"mx-2 text-gray-300"},"|",-1)),t[28]||(t[28]=e("span",{class:"font-medium"},"ระยะทาง:",-1)),e("span",Dt,d(l.distanceText),1)]),e("div",Ot,[e("span",{class:at(["px-2 py-1 rounded-full text-xs font-medium",l.availableSeats>2?"bg-green-100 text-green-800":l.availableSeats>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"])},d(l.availableSeats>0?`เหลือ ${l.availableSeats}
                                                    ที่นั่ง`:"เต็มแล้ว"),3)])])])]),N.value&&N.value.id===l.id?(m(),c("div",Ut,[e("div",Kt,[e("div",null,[t[29]||(t[29]=e("h5",{class:"mb-2 font-medium text-gray-900"},"รายละเอียดเส้นทาง",-1)),e("ul",Gt,[l.originArea?(m(),c("li",Ht,"• จุดเริ่มต้น (พื้นที่): "+d(l.originArea),1)):_("",!0),l.destinationArea?(m(),c("li",Zt,"• จุดปลายทาง (พื้นที่): "+d(l.destinationArea),1)):_("",!0),l.originAddress?(m(),c("li",qt,"• จุดเริ่มต้น (ที่อยู่): "+d(l.originAddress),1)):_("",!0),l.destinationAddress?(m(),c("li",Wt,"• จุดปลายทาง (ที่อยู่): "+d(l.destinationAddress),1)):_("",!0),(m(!0),c(M,null,S(l.stops,a=>(m(),c("li",{key:a},"• "+d(a),1))),128))]),e("ul",Jt,[(m(!0),c(M,null,S(l.stops,a=>(m(),c("li",{key:a},"• "+d(a),1))),128))])]),e("div",null,[t[30]||(t[30]=e("h5",{class:"mb-2 font-medium text-gray-900"},"รายละเอียดรถ",-1)),e("ul",Qt,[(m(!0),c(M,null,S(l.carDetails,a=>(m(),c("li",{key:a},"• "+d(a),1))),128))])])]),e("div",Xt,[l.conditions?(m(),c("div",Yt,[t[31]||(t[31]=e("h5",{class:"mb-2 font-medium text-gray-900"},"เงื่อนไขการเดินทาง",-1)),e("p",Rt,d(l.conditions),1)])):_("",!0),l.photos&&l.photos.length>0?(m(),c("div",el,[t[32]||(t[32]=e("h5",{class:"mb-2 font-medium text-gray-900"},"รูปภาพรถยนต์",-1)),e("div",tl,[(m(!0),c(M,null,S(l.photos.slice(0,3),(a,o)=>(m(),c("div",{key:o,class:""},[e("img",{src:a,alt:"Vehicle photo",class:"object-cover w-full transition-opacity border border-gray-300 rounded-lg shadow-sm cursor-pointer aspect-video hover:opacity-90"},null,8,ll)]))),128))])])):_("",!0)]),e("div",al,[e("button",{onClick:Y(a=>Ge(l),["stop"]),disabled:l.availableSeats===0,class:"px-6 py-2 text-white transition duration-200 bg-blue-600 rounded-md hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed"}," จองที่นั่ง ",8,sl)])])):_("",!0)],8,ht))),128))]))])]),e("div",nl,[e("div",ol,[t[33]||(t[33]=e("div",{class:"p-6 border-b border-gray-300"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"แผนที่เส้นทาง")],-1)),e("div",{ref_key:"mapContainer",ref:de,class:"h-96"},null,512)])])])]),Ie(Ne,{name:"modal-fade"},{default:$e(()=>[ce.value&&y.value?(m(),c("div",{key:0,class:"modal-overlay",onClick:Y(Q,["self"])},[e("div",il,[$.value?(m(),c(M,{key:1},[e("div",dl,[e("h3",ul," เลือก"+d($.value==="pickup"?"จุดขึ้นรถ":"จุดลงรถ"),1),e("button",{onClick:Le,class:"text-gray-400 hover:text-gray-600"},t[36]||(t[36]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",cl,[e("div",{ref_key:"bookingPickerMapEl",ref:fe,class:"w-full",style:{height:"72vh"}},null,512),e("div",ml,[e("div",gl,[t[37]||(t[37]=e("span",{class:"font-medium"},"ตำแหน่ง:",-1)),e("span",pl,d(k.value.name||"— ยังไม่เลือก —"),1)]),e("button",{class:"px-4 py-2 text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed",disabled:!k.value.name,onClick:Xe}," ใช้ตำแหน่งนี้ ",8,vl)])])],64)):(m(),c("div",rl,[t[35]||(t[35]=e("h3",{class:"text-xl font-semibold text-gray-900"},"ยืนยันการจอง",-1)),e("button",{onClick:Q,class:"text-gray-400 hover:text-gray-600"},t[34]||(t[34]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))])),e("div",fl,[e("div",bl,[t[39]||(t[39]=e("h4",{class:"mb-3 font-semibold text-gray-900"},"เดินทางกับ",-1)),e("div",yl,[e("img",{src:y.value.driver.image,alt:y.value.driver.name,class:"object-cover w-12 h-12 rounded-full"},null,8,xl),e("div",null,[e("div",_l,[e("div",hl,d(y.value.driver.name),1),y.value.driver.isVerified?(m(),c("div",kl,t[38]||(t[38]=[e("svg",{class:"w-5 h-5 text-blue-600",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8.603 3.799A4.49 4.49 0 0112 2.25c1.357 0 2.573.6 3.397 1.549a4.49 4.49 0 013.498 1.307 4.491 4.491 0 011.307 3.497A4.49 4.49 0 0121.75 12c0 1.357-.6 2.573-1.549 3.397a4.49 4.49 0 01-1.307 3.498 4.491 4.491 0 01-3.497 1.307A4.49 4.49 0 0112 21.75a4.49 4.49 0 01-3.397-1.549 4.49 4.49 0 01-3.498-1.306 4.491 4.491 0 01-1.307-3.498A4.49 4.49 0 012.25 12c0-1.357.6-2.573 1.549-3.397a4.49 4.49 0 011.307-3.497 4.49 4.49 0 013.497-1.307zm7.007 6.387a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.07-.01l3.5-4.875z","clip-rule":"evenodd"})],-1),e("span",{class:"absolute px-2 py-1 mb-2 text-xs text-white transition-opacity -translate-x-1/2 bg-gray-800 rounded-md opacity-0 pointer-events-none bottom-full left-1/2 w-max group-hover:opacity-100"}," ผู้ขับขี่ยืนยันตัวตนแล้ว ",-1)]))):_("",!0)]),e("div",wl,[e("div",Ml,[(m(),c(M,null,S(5,l=>e("span",{key:l},d(l<=y.value.driver.rating?"★":"☆"),1)),64))]),e("span",Pl,d(y.value.driver.rating)+" ("+d(y.value.driver.reviews)+" รีวิว)",1)])])])]),e("div",Cl,[e("div",null,[t[40]||(t[40]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"วันที่เดินทาง",-1)),e("div",Ll,d(y.value.date),1)]),e("div",null,[t[41]||(t[41]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"เวลาออก",-1)),e("div",Al,d(y.value.departureTime),1)])]),e("div",Tl,[t[45]||(t[45]=e("h4",{class:"mb-3 font-semibold text-gray-900"},"เส้นทางการเดินทาง",-1)),e("div",Bl,[e("div",Il,[e("div",Sl,d(y.value.originName),1),t[42]||(t[42]=e("div",{class:"text-sm text-gray-600"},"จุดเริ่มต้น",-1))]),t[44]||(t[44]=e("div",{class:"text-blue-600"},[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})])],-1)),e("div",$l,[e("div",Nl,d(y.value.destinationName),1),t[43]||(t[43]=e("div",{class:"text-sm text-gray-600"},"จุดปลายทาง",-1))])])]),e("div",Vl,[e("div",null,[t[46]||(t[46]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"จำนวนที่นั่งที่ต้องการจอง",-1)),V(e("select",{"onUpdate:modelValue":t[6]||(t[6]=l=>F.value=l),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},[(m(!0),c(M,null,S(y.value.availableSeats,l=>(m(),c("option",{key:l,value:l},d(l)+" ที่นั่ง ",9,jl))),128))],512),[[Se,F.value]])]),e("div",null,[t[48]||(t[48]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"เลือกจุดขึ้นรถ",-1)),e("div",zl,[V(e("input",{ref_key:"pickupInputEl",ref:te,"onUpdate:modelValue":t[7]||(t[7]=l=>B.value=l),type:"text",placeholder:"พิมพ์ชื่อสถานที่...",class:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[G,B.value]]),e("button",{type:"button",onClick:t[8]||(t[8]=l=>Ce("pickup")),class:"absolute inset-y-0 my-auto text-gray-500 right-2 hover:text-blue-600",title:"เลือกจากแผนที่"},t[47]||(t[47]=[e("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M12 2a7 7 0 00-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 00-7-7zm0 9.5a2.5 2.5 0 110-5 2.5 2.5 0 010 5z"})],-1)]))])]),e("div",null,[t[50]||(t[50]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"เลือกจุดลงรถ",-1)),e("div",El,[V(e("input",{ref_key:"dropoffInputEl",ref:le,"onUpdate:modelValue":t[9]||(t[9]=l=>I.value=l),type:"text",placeholder:"พิมพ์ชื่อสถานที่...",class:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[G,I.value]]),e("button",{type:"button",onClick:t[10]||(t[10]=l=>Ce("dropoff")),class:"absolute inset-y-0 my-auto text-gray-500 right-2 hover:text-blue-600",title:"เลือกจากแผนที่"},t[49]||(t[49]=[e("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M12 2a7 7 0 00-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 00-7-7zm0 9.5a2.5 2.5 0 110-5 2.5 2.5 0 010 5z"})],-1)]))])])]),e("div",Fl,[e("div",Dl,[t[51]||(t[51]=e("span",{class:"text-gray-700"},"ราคาต่อที่นั่ง",-1)),e("span",Ol,d(y.value.price)+" บาท",1)]),e("div",Ul,[t[52]||(t[52]=e("span",{class:"text-gray-700"},"จำนวนที่นั่ง",-1)),e("span",Kl,d(F.value)+" ที่นั่ง",1)]),e("div",Gl,[e("div",Hl,[t[53]||(t[53]=e("span",{class:"font-semibold text-gray-900"},"ยอดรวม",-1)),e("span",Zl,d(De.value)+" บาท",1)])])]),e("div",{class:"flex space-x-4"},[e("button",{onClick:Q,class:"flex-1 px-4 py-3 font-semibold text-gray-800 transition duration-200 bg-gray-200 rounded-md hover:bg-gray-300"}," ยกเลิก "),e("button",{onClick:He,class:"flex-1 px-4 py-3 font-semibold text-white transition duration-200 bg-blue-600 rounded-md hover:bg-blue-700"}," ยืนยันการจอง ")])])])])):_("",!0)]),_:1}),Ie(Ne,{name:"modal-fade"},{default:$e(()=>[ie.value?(m(),c("div",{key:0,class:"modal-overlay",onClick:Y(X,["self"])},[e("div",ql,[e("div",Wl,[e("h3",Jl,"เลือก"+d(j.value==="origin"?"จุดเริ่มต้น":"จุดปลายทาง"),1),e("button",{onClick:X,class:"text-gray-400 hover:text-gray-600"},t[54]||(t[54]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",Ql,[e("div",{ref_key:"placePickerMapEl",ref:be,class:"w-full border border-gray-200 rounded-md h-80"},null,512),e("div",Xl,[t[55]||(t[55]=e("div",{class:"font-medium"},"ตำแหน่งที่เลือก:",-1)),e("div",Yl,d(x.value.name||"— ยังไม่เลือก —"),1),x.value.lat&&x.value.lng?(m(),c("div",Rl," lat: "+d(x.value.lat.toFixed(6))+", lng: "+d(x.value.lng.toFixed(6)),1)):_("",!0)]),e("div",ea,[e("button",{onClick:X,class:"flex-1 px-4 py-2 font-semibold text-gray-800 bg-gray-200 rounded-md hover:bg-gray-300"}," ยกเลิก "),e("button",{disabled:!x.value.name,onClick:qe,class:"flex-1 px-4 py-2 font-semibold text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed"}," ใช้ตำแหน่งนี้ ",8,ta)])])])])):_("",!0)]),_:1})]))}},ca=Ye(la,[["__scopeId","data-v-709a4167"]]);export{ca as default};
