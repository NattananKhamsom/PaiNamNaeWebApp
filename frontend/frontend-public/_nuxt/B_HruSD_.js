import{_ as U,m as $,r as u,A as _,p as H,x as L,i as F,c as d,a as e,b as O,e as v,g as j,d as x,t as g,f as R,h as D,v as N,o,s as T}from"./DPSIKoxe.js";import{_ as G}from"./BE2kpsnt.js";import{u as q}from"./DOK8vhV6.js";import"./Lcixqshc.js";const J={class:"bg-gray-50"},K={class:"flex items-center justify-center min-h-screen py-8"},Q={class:"flex w-full max-w-6xl mx-4 overflow-hidden bg-white border border-gray-300 rounded-lg shadow-lg"},W={class:"flex-1 p-8"},X={class:"mb-8"},Y={class:"p-6 bg-white border border-gray-300 shadow rounded-xl"},Z={class:"flex items-center mb-4"},tt={key:0,class:"ml-auto"},et={key:0,class:"inline-flex items-center px-3 py-1 text-sm font-medium rounded-full bg-emerald-50 text-emerald-700 ring-1 ring-inset ring-emerald-200"},at={key:1,class:"inline-flex items-center px-3 py-1 text-sm font-medium rounded-full bg-amber-50 text-amber-700 ring-1 ring-inset ring-amber-200"},st={key:0,class:"text-gray-500"},lt={key:1,class:"grid grid-cols-1 gap-4 md:grid-cols-2"},dt={class:"font-medium text-gray-900"},ot={class:"font-medium text-gray-900"},it={class:"flex items-center font-medium text-gray-900 break-all"},nt=["aria-label"],rt={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ut={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},vt={class:"font-medium text-gray-900"},ct={key:2,class:"text-gray-500"},mt={class:"p-8 bg-white rounded-xl"},ft={class:"relative"},xt={class:"grid gap-6 mb-6 md:grid-cols-2"},gt={key:0,class:"text-center"},pt=["src"],ht={class:"relative"},bt={class:"grid gap-6 mb-6 md:grid-cols-2"},yt={key:0,class:"text-center"},kt=["src"],wt={class:"relative"},It={class:"grid grid-cols-1 gap-4 mb-6 md:grid-cols-2"},Pt={class:"flex justify-end gap-4 pt-6"},_t=["disabled"],jt=["disabled"],Dt={key:0,class:"w-5 h-5 mr-3 -ml-1 text-white animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Nt={__name:"verification",setup(Mt){const{$api:k}=$(),{user:M}=q(),{toast:b}=T(),c=u(!1),p=u(null),h=u(null);let C=null;const l=_({nationalIdNumber:"",nationalIdExpiryDate:"",nationalIdPhoto:null,selfiePhoto:null}),m=u(""),n=u(null),y=u(!1),f=u(!1),z=s=>{if(!s)return"-";try{return new Date(s).toLocaleDateString("th-TH",{day:"2-digit",month:"long",year:"numeric"})}catch{return"-"}},B=s=>{if(!s)return"-";const t=String(s).replace(/\D/g,"").slice(0,13);return t.length<13?t:`${t[0]}-${t.slice(1,5)}-${t.slice(5,10)}-${t.slice(10,12)}-${t.slice(12,13)}`},V=s=>{if(!s)return"-";const t=String(s),a=t.slice(-4);return"•".repeat(Math.max(0,t.length-4))+a},E=async()=>{y.value=!0;try{const s=await k("/users/me"),t=s&&typeof s=="object"&&"data"in s?s.data:s;n.value=t||null}catch{n.value=null}finally{y.value=!1}};H(m,s=>{const a=s.replace(/\D/g,"").slice(0,13);l.nationalIdNumber=a;let i="";a.length>0&&(i+=a.substring(0,1)),a.length>1&&(i+="-"+a.substring(1,5)),a.length>5&&(i+="-"+a.substring(5,10)),a.length>10&&(i+="-"+a.substring(10,12)),a.length>12&&(i+="-"+a.substring(12,13)),i!==s&&(m.value=i)});const r=_({nationalIdPhoto:"",selfiePhoto:""}),w=L(()=>{const s=l.nationalIdPhoto||r.nationalIdPhoto,t=l.selfiePhoto||r.selfiePhoto;return l.nationalIdNumber&&l.nationalIdExpiryDate&&s&&t}),A=()=>{l.nationalIdNumber="",m.value="",l.nationalIdExpiryDate="",l.nationalIdPhoto=null,l.selfiePhoto=null,r.nationalIdPhoto="",r.selfiePhoto="",p.value&&(p.value.value=""),h.value&&(h.value.value="")},I=s=>{var t,a;s==="nationalIdPhoto"?(t=p.value)==null||t.click():s==="selfiePhoto"&&((a=h.value)==null||a.click())},P=(s,t)=>{var i;const a=(i=s.target.files)==null?void 0:i[0];a&&(t==="nationalIdPhoto"?(l.nationalIdPhoto=a,r.nationalIdPhoto=URL.createObjectURL(a)):t==="selfiePhoto"&&(l.selfiePhoto=a,r.selfiePhoto=URL.createObjectURL(a)))},S=async()=>{var s;if(!w.value){b.warning("ข้อมูลไม่ครบถ้วน","กรุณากรอกข้อมูลและอัปโหลดรูปภาพให้ครบทุกช่อง");return}c.value=!0;try{const t=new FormData;t.append("nationalIdNumber",l.nationalIdNumber);const a=new Date(l.nationalIdExpiryDate).toISOString();t.append("nationalIdExpiryDate",a),l.nationalIdPhoto instanceof File&&t.append("nationalIdPhotoUrl",l.nationalIdPhoto),l.selfiePhoto instanceof File&&t.append("selfiePhotoUrl",l.selfiePhoto);const i=await k("/users/me",{method:"PUT",body:t});M.value=i,C={...i},b.success("ส่งข้อมูลสำเร็จ","คำขอยืนยันตัวตนของคุณถูกส่งแล้ว")}catch(t){b.error("เกิดข้อผิดพลาด",((s=t.data)==null?void 0:s.message)||"ไม่สามารถส่งข้อมูลได้")}finally{c.value=!1}};return F(()=>{E()}),(s,t)=>(o(),d("div",J,[e("div",K,[e("div",Q,[O(G),e("main",W,[e("div",X,[e("div",Y,[e("div",Z,[t[9]||(t[9]=e("h2",{class:"text-lg font-semibold text-gray-900"}," ข้อมูลการยืนยันขั้นพื้นฐานของฉัน ",-1)),n.value?(o(),d("div",tt,[n.value.isVerified?(o(),d("span",et,t[7]||(t[7]=[e("svg",{class:"w-4 h-4 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),x(" ยืนยันแล้ว ")]))):(o(),d("span",at,t[8]||(t[8]=[e("svg",{class:"w-4 h-4 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),x(" ยังไม่ยืนยัน ")])))])):j("",!0)]),y.value?(o(),d("div",st,"กำลังโหลดข้อมูล...")):n.value?(o(),d("div",lt,[e("div",null,[t[10]||(t[10]=e("div",{class:"text-sm text-gray-500"},"ชื่อ",-1)),e("div",dt,g(n.value.firstName||"-"),1)]),e("div",null,[t[11]||(t[11]=e("div",{class:"text-sm text-gray-500"},"นามสกุล",-1)),e("div",ot,g(n.value.lastName||"-"),1)]),e("div",null,[t[14]||(t[14]=e("div",{class:"text-sm text-gray-500"},"เลขประจำตัว",-1)),e("div",it,[e("span",null,g(f.value?B(n.value.nationalIdNumber):V(n.value.nationalIdNumber)),1),e("button",{type:"button",onClick:t[0]||(t[0]=a=>f.value=!f.value),class:"p-1 ml-2 text-gray-500 rounded hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":f.value?"ซ่อนเลขประจำตัว":"แสดงเลขประจำตัว",title:"สลับการแสดงเลขประจำตัว"},[f.value?(o(),d("svg",ut,t[13]||(t[13]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.477 0-8.268-2.943-9.542-7a10.053 10.053 0 012.227-3.592M6.223 6.223A10.05 10.05 0 0112 5c4.477 0 8.268 2.943 9.542 7a10.05 10.05 0 01-2.042 3.33M15 12a3 3 0 00-3-3M3 3l18 18"},null,-1)]))):(o(),d("svg",rt,t[12]||(t[12]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)])))],8,nt)])]),e("div",null,[t[15]||(t[15]=e("div",{class:"text-sm text-gray-500"},"วันหมดอายุบัตรประชาชน",-1)),e("div",vt,g(z(n.value.nationalIdExpiryDate)),1)])])):(o(),d("div",ct," ยังไม่มีประวัติการยืนยันขั้นพื้นฐาน "))])]),t[27]||(t[27]=v('<div class="mb-8 text-center" data-v-94d5d900><div class="inline-flex items-center justify-center w-16 h-16 mb-4 bg-blue-600 rounded-full" data-v-94d5d900><svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-94d5d900><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" data-v-94d5d900></path></svg></div><h1 class="mb-2 text-3xl font-bold text-gray-800" data-v-94d5d900>การยืนยันตัวตนขั้นพื้นฐาน</h1><p class="max-w-md mx-auto text-gray-600" data-v-94d5d900> อัปโหลดภาพบัตรประชาชนและรูปถ่าย เพื่อยืนยันตัวตนของคุณ </p></div>',1)),e("div",mt,[e("form",{onSubmit:R(S,["prevent"]),novalidate:"",class:"space-y-8"},[e("div",ft,[t[18]||(t[18]=v('<div class="flex items-center mb-6" data-v-94d5d900><div class="mr-4 step-indicator" data-v-94d5d900>1</div><label class="text-xl font-semibold text-gray-800" data-v-94d5d900> รูปบัตรประชาชน (ด้านหน้า) <span class="text-red-500" data-v-94d5d900>*</span></label></div><h4 class="mb-2 text-sm font-medium text-gray-700" data-v-94d5d900>ตัวอย่างที่ถูกต้อง:</h4>',2)),e("div",xt,[t[17]||(t[17]=v('<div class="space-y-4" data-v-94d5d900><div class="relative h-40 p-6 license-card" data-v-94d5d900><div class="relative z-10 flex flex-col justify-between h-full" data-v-94d5d900><div class="flex items-start justify-between" data-v-94d5d900><div data-v-94d5d900><div class="thai-text" data-v-94d5d900>ใบบัตรประชาชน</div><div class="text-xs font-bold text-blue-800" data-v-94d5d900>ID CARD</div></div></div><div class="flex items-center space-x-3" data-v-94d5d900><div class="flex items-center justify-center w-12 h-12 bg-blue-300 rounded-md" data-v-94d5d900><svg class="w-6 h-6 text-blue-700" fill="currentColor" viewBox="0 0 20 20" data-v-94d5d900><path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" data-v-94d5d900></path></svg></div><div data-v-94d5d900><div class="text-xs font-semibold text-blue-800" data-v-94d5d900>นาย สมชาย ใจดี </div><div class="text-xs text-blue-700" data-v-94d5d900>เลขที่ 12345678</div><div class="text-xs text-blue-600" data-v-94d5d900>หมดอายุ 01/01/2027</div></div></div></div></div><p class="text-xs text-center text-gray-600" data-v-94d5d900>วางบัตรบนพื้นผิวเรียบ ถ่ายให้ชัดเจน </p></div>',1)),e("div",{onClick:t[2]||(t[2]=a=>I("nationalIdPhoto")),class:"relative flex items-center justify-center h-40 p-8 border-2 border-gray-300 border-dashed rounded-lg upload-zone bg-gray-50 hover:bg-gray-100 hover:border-blue-400"},[r.nationalIdPhoto?(o(),d("img",{key:1,src:r.nationalIdPhoto,class:"object-cover w-full h-full rounded-md"},null,8,pt)):(o(),d("div",gt,t[16]||(t[16]=[v('<svg class="w-12 h-12 mx-auto mb-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-94d5d900><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" data-v-94d5d900></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" data-v-94d5d900></path></svg><p class="mb-2 text-lg text-gray-600" data-v-94d5d900>คลิกเพื่ออัปโหลด</p><p class="text-sm text-gray-500" data-v-94d5d900>JPG, PNG (ไม่เกิน 10MB)</p>',3)]))),e("input",{type:"file",ref_key:"nationalIdInput",ref:p,onChange:t[1]||(t[1]=a=>P(a,"nationalIdPhoto")),class:"hidden",accept:"image/png, image/jpeg"},null,544)])])]),e("div",ht,[t[21]||(t[21]=v('<div class="flex items-center mb-6" data-v-94d5d900><div class="mr-4 step-indicator" data-v-94d5d900>2</div><label class="text-xl font-semibold text-gray-800" data-v-94d5d900> รูปถ่าย (Selfie) <span class="text-red-500" data-v-94d5d900>*</span></label></div><h4 class="mb-2 text-sm font-medium text-gray-700" data-v-94d5d900>ตัวอย่างที่ถูกต้อง:</h4>',2)),e("div",bt,[t[20]||(t[20]=v('<div class="space-y-4" data-v-94d5d900><div class="relative h-40 p-6 selfie-frame" data-v-94d5d900><div class="relative z-10 flex items-center justify-center h-full" data-v-94d5d900><div class="flex items-center space-x-4" data-v-94d5d900><div class="flex items-center justify-center w-20 h-20 person-silhouette" data-v-94d5d900><svg class="w-12 h-12 text-gray-200" fill="currentColor" viewBox="0 0 20 20" data-v-94d5d900><path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" data-v-94d5d900></path></svg></div></div></div></div><p class="text-xs text-center text-gray-600" data-v-94d5d900>ถือบัตรชิดข้างใบหน้า ให้เห็นทั้งสองอย่างชัดเจน</p></div>',1)),e("div",{onClick:t[4]||(t[4]=a=>I("selfiePhoto")),class:"relative flex items-center justify-center h-40 p-8 border-2 border-gray-300 border-dashed rounded-lg upload-zone bg-gray-50 hover:bg-gray-100 hover:border-blue-400"},[r.selfiePhoto?(o(),d("img",{key:1,src:r.selfiePhoto,class:"object-cover w-full h-full rounded-md"},null,8,kt)):(o(),d("div",yt,t[19]||(t[19]=[v('<svg class="w-12 h-12 mx-auto mb-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-94d5d900><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" data-v-94d5d900></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" data-v-94d5d900></path></svg><p class="mb-2 text-lg text-gray-600" data-v-94d5d900>คลิกเพื่ออัปโหลด</p><p class="text-sm text-gray-500" data-v-94d5d900>JPG, PNG (ไม่เกิน 10MB)</p>',3)]))),e("input",{type:"file",ref_key:"selfieInput",ref:h,onChange:t[3]||(t[3]=a=>P(a,"selfiePhoto")),class:"hidden",accept:"image/png, image/jpeg"},null,544)])])]),e("div",wt,[t[24]||(t[24]=e("div",{class:"flex items-center mb-4"},[e("div",{class:"mr-4 step-indicator"},"3"),e("h2",{class:"text-xl font-semibold text-gray-800"},"ข้อมูลในบัตรประจำตัวประชาชน")],-1)),e("div",It,[e("div",null,[t[22]||(t[22]=e("label",{for:"nationalIdNumber",class:"block mb-2 text-sm font-medium text-gray-700"},[x("เลขบัตรประชาชน "),e("span",{class:"text-red-500"},"*")],-1)),D(e("input",{"onUpdate:modelValue":t[5]||(t[5]=a=>m.value=a),id:"nationalIdNumber",type:"text",maxlength:"17",placeholder:"x-xxxx-xxxxx-xx-x",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[N,m.value]])]),e("div",null,[t[23]||(t[23]=e("label",{for:"nationalIdExpiryDate",class:"block mb-2 text-sm font-medium text-gray-700"},[x("วันหมดอายุในบัตร "),e("span",{class:"text-red-500"},"*")],-1)),D(e("input",{"onUpdate:modelValue":t[6]||(t[6]=a=>l.nationalIdExpiryDate=a),id:"nationalIdExpiryDate",type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[N,l.nationalIdExpiryDate]])])])]),t[26]||(t[26]=e("p",{class:"mt-4 text-sm text-center text-gray-500"}," ข้อมูลของคุณจะได้รับการตรวจสอบโดยเจ้าหน้าที่ระบบโดยเร็วที่สุด ",-1)),e("div",Pt,[e("button",{type:"button",onClick:A,disabled:c.value,class:"px-6 py-3 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-400 disabled:opacity-50"}," ยกเลิก ",8,_t),e("button",{type:"submit",disabled:!w.value||c.value,class:"flex items-center px-6 py-3 font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-blue-400 disabled:cursor-not-allowed"},[c.value?(o(),d("svg",Dt,t[25]||(t[25]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):j("",!0),x(" "+g(c.value?"กำลังส่งข้อมูล...":"ส่งคำขอยืนยันตัวตน"),1)],8,jt)])],32)])])])])]))}},Et=U(Nt,[["__scopeId","data-v-94d5d900"]]);export{Et as default};
