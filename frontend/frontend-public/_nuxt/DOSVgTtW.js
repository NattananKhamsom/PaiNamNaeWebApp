import{_ as Be}from"./Lcixqshc.js";import{_ as je,m as Oe,r as C,x as Ce,y as De,i as Ie,p as Ve,c as i,a as s,b as $e,F as b,q as $,t as r,g as f,s as He,o as l,n as J,d as y,f as P,w as ze}from"./DPSIKoxe.js";import{d as B}from"./B5yDJBm8.js";import{b as Ue}from"./C5FTVxxA.js";import{C as Ge}from"./CL2Ezi0q.js";import{s as We}from"./x_rD_Ya3.js";import{u as qe}from"./BaxiziUg.js";import"./Cpj98o6Y.js";const Ke={class:"px-4 py-8 mx-auto max-w-7xl sm:px-6 lg:px-8"},Je={class:"p-6 mb-8 bg-white border border-gray-300 rounded-lg shadow-md"},Ye={class:"flex flex-wrap gap-2"},Qe=["onClick"],Xe={class:"grid grid-cols-1 gap-6 lg:grid-cols-3"},Ze={class:"lg:col-span-2"},es={class:"bg-white border border-gray-300 rounded-lg shadow-md"},ss={class:"p-6 border-b border-gray-300"},ts={class:"text-lg font-semibold text-gray-900"},os={key:0,class:"p-12 text-center text-gray-500"},as={key:1,class:"divide-y divide-gray-200"},ns={key:0,class:"p-12 text-center text-gray-500"},is=["onClick"],ls={class:"flex items-start justify-between mb-4"},rs={class:"flex-1"},ds={class:"flex items-center justify-between"},cs={class:"text-lg font-semibold text-gray-900"},us={class:"mt-1 text-sm text-gray-600"},ms={class:"mt-1 text-sm text-gray-600"},gs={class:"ml-1"},fs={class:"ml-1"},ps={key:0,class:"pt-4 mt-4 mb-5 duration-300 border-t border-gray-300 animate-in slide-in-from-top"},vs={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},ys={class:"space-y-1 text-sm text-gray-600"},hs={class:"font-medium text-gray-900"},xs={key:0},_s={class:"mt-2 text-gray-700"},bs={class:"mt-1"},ks={class:"font-medium text-gray-900"},ws={key:0},Cs={class:"space-y-1 text-sm text-gray-600"},$s={class:"mt-4 space-y-4"},Ms={key:0},As={class:"p-3 text-sm text-gray-700 border border-gray-300 rounded-md bg-gray-50"},Ns={key:1},Ts={class:"grid grid-cols-3 gap-2 mt-2"},Rs=["src"],Ls={key:2},Es={class:"mb-2 font-medium text-gray-900"},Ps={class:"space-y-3"},Ss=["src","alt"],Fs={class:"flex-1"},Bs={class:"flex items-center"},js={class:"font-medium text-gray-900"},Os={key:0,class:"relative group ml-1.5 flex items-center"},Ds={class:"text-sm text-gray-600"},Is={key:0,class:"mx-2 text-gray-300"},Vs=["href"],Hs={key:2,class:"divide-y divide-gray-200"},zs={key:0,class:"p-12 text-center text-gray-500"},Us=["onClick"],Gs={class:"flex items-start justify-between mb-4"},Ws={class:"flex-1"},qs={class:"flex items-center justify-between"},Ks={class:"text-lg font-semibold text-gray-900"},Js={key:0,class:"status-badge status-pending"},Ys={key:1,class:"status-badge status-confirmed"},Qs={key:2,class:"status-badge status-rejected"},Xs={key:3,class:"status-badge status-cancelled"},Zs={class:"mt-1 text-sm text-gray-600"},et={class:"text-sm text-gray-600"},st={key:0,class:"p-2 mt-2 border border-gray-200 rounded-md bg-gray-50"},tt={class:"text-sm text-gray-700"},ot={class:"font-medium"},at={class:"flex items-center mb-4 space-x-4"},nt=["src","alt"],it={class:"flex-1"},lt={class:"flex items-center"},rt={class:"font-medium text-gray-900"},dt={key:0,class:"relative group ml-1.5 flex items-center"},ct={class:"flex"},ut={key:0,class:"text-xs text-gray-500 mt-0.5"},mt=["href"],gt=["onClick"],ft={class:"flex items-center mt-1"},pt={class:"flex text-sm text-yellow-400"},vt={class:"ml-2 text-sm text-gray-600"},yt={class:"text-right"},ht={class:"text-lg font-bold text-blue-600"},xt={class:"text-sm text-gray-600"},_t={key:0,class:"pt-4 mt-4 mb-5 duration-300 border-t border-gray-300 animate-in slide-in-from-top"},bt={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},kt={class:"space-y-1 text-sm text-gray-600"},wt={class:"font-medium text-gray-900"},Ct={key:0},$t={class:"mt-2 text-gray-700"},Mt={class:"mt-1"},At={class:"font-medium text-gray-900"},Nt={key:0},Tt={class:"space-y-1 text-sm text-gray-600"},Rt={class:"mt-4 space-y-4"},Lt={key:0},Et={class:"p-3 text-sm text-gray-700 border border-gray-300 rounded-md bg-gray-50"},Pt={key:1},St={class:"grid grid-cols-3 gap-2 mt-2"},Ft=["src"],Bt=["onClick"],jt=["onClick"],Ot={key:1,class:"px-4 py-2 text-sm text-white transition duration-200 bg-blue-600 rounded-md hover:bg-blue-700"},Dt=["onClick"],It={class:"lg:col-span-1"},Vt={class:"sticky overflow-hidden bg-white border border-gray-300 rounded-lg shadow-md top-8"},Ht={class:"p-3 border-gray-300"},zt={class:"mt-1 text-sm text-gray-600"},le="__gmapsReady__",Ut={__name:"index",setup(Gt){var ve;B.locale("th"),B.extend(Ue);const{$api:I}=Oe(),{toast:L}=He(),h=C("pending"),M=C(null),Y=C(!1),Q=C(null),x=C([]),_=C([]);let w=null,V=null,H=null,z=null,X=null,Z=null;const ee=C(!1);let U=[];const Me=[{status:"pending",label:"รอดำเนินการ"},{status:"confirmed",label:"ยืนยันแล้ว"},{status:"rejected",label:"ปฏิเสธ"},{status:"cancelled",label:"ยกเลิก"},{status:"all",label:"ทั้งหมด"},{status:"myRoutes",label:"เส้นทางของฉัน"}];function j(o){return(o||"").replace(/,?\s*(Thailand|ไทย|ประเทศ)\s*$/i,"").replace(/\s{2,}/g," ").trim()}const Ae={CHANGE_OF_PLAN:"เปลี่ยนแผน/มีธุระกะทันหัน",FOUND_ALTERNATIVE:"พบวิธีเดินทางอื่นแล้ว",DRIVER_DELAY:"คนขับล่าช้าหรือเลื่อนเวลา",PRICE_ISSUE:"ราคาหรือค่าใช้จ่ายไม่เหมาะสม",WRONG_LOCATION:"เลือกจุดรับ–ส่งผิด",DUPLICATE_OR_WRONG_DATE:"จองซ้ำหรือจองผิดวัน",SAFETY_CONCERN:"กังวลด้านความปลอดภัย",WEATHER_OR_FORCE_MAJEURE:"สภาพอากาศ/เหตุสุดวิสัย",COMMUNICATION_ISSUE:"สื่อสารไม่สะดวก/ติดต่อไม่ได้"};function Ne(o){return Ae[o]||o}const N=Ce(()=>h.value==="all"?x.value:x.value.filter(o=>o.status===h.value)),re=Ce(()=>{if(h.value==="myRoutes"){const t=_.value.find(c=>c.id===M.value);return t?`${t.origin} → ${t.destination}`:null}const o=x.value.find(t=>t.id===M.value);return o?`${o.origin} → ${o.destination}`:null});async function se(){var o,t,c,e,a,p,g,v,k,S;Y.value=!0;try{const F=await I("/routes/me"),Pe=new Set(["AVAILABLE","FULL","IN_TRANSIT"]),ye=[],he=[];for(const n of F){const A=[],ne=String(n.status||"").toUpperCase();if(!Pe.has(ne))continue;n.vehicle?(A.push(`${n.vehicle.vehicleModel} (${n.vehicle.vehicleType})`),Array.isArray(n.vehicle.amenities)&&n.vehicle.amenities.length>0&&A.push(...n.vehicle.amenities)):A.push("ไม่มีข้อมูลรถ");const m=n.startLocation,u=n.endLocation,W=[[m.lat,m.lng],[u.lat,u.lng]],R=n.waypoints||{},ie=Array.isArray(R.used)&&R.used.length?R.used:Array.isArray(R.requested)?R.requested:[],xe=Array.isArray(R.optimizedOrder)&&R.optimizedOrder.length===ie.length?R.optimizedOrder.map(d=>ie[d]):ie,_e=xe.map(d=>{const q=(d==null?void 0:d.name)||"",O=j((d==null?void 0:d.address)||""),K=(d==null?void 0:d.lat)!=null&&(d==null?void 0:d.lng)!=null?`(${d.lat.toFixed(6)}, ${d.lng.toFixed(6)})`:"",D=q||K;return O?`${D} — ${O}`:D}).filter(Boolean),be=xe.map(d=>d&&typeof d.lat=="number"&&typeof d.lng=="number"?{lat:d.lat,lng:d.lng,name:d.name||"",address:d.address||""}:null).filter(Boolean);for(const d of n.bookings||[])ye.push({id:d.id,status:(d.status||"").toLowerCase(),origin:(m==null?void 0:m.name)||`(${Number(m.lat).toFixed(2)}, ${Number(m.lng).toFixed(2)})`,destination:(u==null?void 0:u.name)||`(${Number(u.lat).toFixed(2)}, ${Number(u.lng).toFixed(2)})`,originHasName:!!(m!=null&&m.name),destinationHasName:!!(u!=null&&u.name),pickupPoint:((o=d.pickupLocation)==null?void 0:o.name)||"-",date:B(n.departureTime).format("D MMMM BBBB"),time:B(n.departureTime).format("HH:mm น."),price:(n.pricePerSeat||0)*(d.numberOfSeats||0),seats:d.numberOfSeats||0,passenger:{name:`${((t=d.passenger)==null?void 0:t.firstName)||""} ${((c=d.passenger)==null?void 0:c.lastName)||""}`.trim()||"ผู้โดยสาร",image:((e=d.passenger)==null?void 0:e.profilePicture)||`https://ui-avatars.com/api/?name=${encodeURIComponent(((a=d.passenger)==null?void 0:a.firstName)||"P")}&background=random&size=64`,email:((p=d.passenger)==null?void 0:p.email)||"",isVerified:!!((g=d.passenger)!=null&&g.isVerified),rating:4.5,reviews:Math.floor(Math.random()*50)+5},coords:W,polyline:n.routePolyline||null,stops:_e,stopsCoords:be,cancelReason:d.cancelReason||null,carDetails:A,conditions:n.conditions,photos:((v=n.vehicle)==null?void 0:v.photos)||[],originAddress:m!=null&&m.address?j(m.address):null,destinationAddress:u!=null&&u.address?j(u.address):null,durationText:(typeof n.duration=="string"?fe(n.duration):n.duration)||(n.durationSeconds?`${Math.round(n.durationSeconds/60)} นาที`:"-"),distanceText:(typeof n.distance=="string"?ge(n.distance):n.distance)||(n.distanceMeters?`${(n.distanceMeters/1e3).toFixed(1)} กม.`:"-")});const Fe=(n.bookings||[]).filter(d=>(d.status||"").toUpperCase()==="CONFIRMED");he.push({id:n.id,status:(n.status||"").toLowerCase(),origin:(m==null?void 0:m.name)||`(${Number(m.lat).toFixed(2)}, ${Number(m.lng).toFixed(2)})`,destination:(u==null?void 0:u.name)||`(${Number(u.lat).toFixed(2)}, ${Number(u.lng).toFixed(2)})`,originAddress:m!=null&&m.address?j(m.address):null,destinationAddress:u!=null&&u.address?j(u.address):null,date:B(n.departureTime).format("D MMMM BBBB"),time:B(n.departureTime).format("HH:mm น."),pricePerSeat:n.pricePerSeat||0,availableSeats:n.availableSeats??0,coords:[[m.lat,m.lng],[u.lat,u.lng]],polyline:n.routePolyline||null,stops:_e,stopsCoords:be,carDetails:n.vehicle?[`${n.vehicle.vehicleModel} (${n.vehicle.vehicleType})`,...n.vehicle.amenities||[]]:["ไม่มีข้อมูลรถ"],photos:((k=n.vehicle)==null?void 0:k.photos)||[],conditions:n.conditions||"",passengers:Fe.map(d=>{var q,O,K,D,ke,we;return{id:d.id,seats:d.numberOfSeats||0,status:"confirmed",name:`${((q=d.passenger)==null?void 0:q.firstName)||""} ${((O=d.passenger)==null?void 0:O.lastName)||""}`.trim()||"ผู้โดยสาร",image:((K=d.passenger)==null?void 0:K.profilePicture)||`https://ui-avatars.com/api/?name=${encodeURIComponent(((D=d.passenger)==null?void 0:D.firstName)||"P")}&background=random&size=64`,email:((ke=d.passenger)==null?void 0:ke.email)||"",isVerified:!!((we=d.passenger)!=null&&we.isVerified),rating:4.5,reviews:Math.floor(Math.random()*50)+5}}),durationText:(typeof n.duration=="string"?fe(n.duration):n.duration)||(n.durationSeconds?`${Math.round(n.durationSeconds/60)} นาที`:"-"),distanceText:(typeof n.distance=="string"?ge(n.distance):n.distance)||(n.distanceMeters?`${(n.distanceMeters/1e3).toFixed(1)} กม.`:"-")})}x.value=ye,_.value=he,await ce();const Se=x.value.map(async(n,A)=>{const[ne,m]=await Promise.all([ue(n.coords[0][0],n.coords[0][1]),ue(n.coords[1][0],n.coords[1][1])]),u=await me(ne),W=await me(m);!x.value[A].originHasName&&u.name&&(x.value[A].origin=u.name),!x.value[A].destinationHasName&&W.name&&(x.value[A].destination=W.name)});await Promise.allSettled(Se)}catch(F){console.error("Failed to fetch routes:",F),x.value=[],_.value=[],L.error("เกิดข้อผิดพลาด",((S=F==null?void 0:F.data)==null?void 0:S.message)||"ไม่สามารถโหลดข้อมูลได้")}finally{Y.value=!1}}const Te=o=>o==="all"?x.value.length:o==="myRoutes"?_.value.length:x.value.filter(t=>t.status===o).length,de=o=>{const t=h.value==="myRoutes"?_.value.find(c=>c.id===o):x.value.find(c=>c.id===o);t&&E(t),M.value=M.value===o?null:o};function ce(){return new Promise(o=>{if(ee.value)return o(!0);const t=We(()=>{ee.value&&(clearInterval(t),o(!0))},50)})}function ue(o,t){return new Promise(c=>{if(!X)return c(null);X.geocode({location:{lat:o,lng:t}},(e,a)=>{if(a!=="OK"||!(e!=null&&e.length))return c(null);c(e[0])})})}async function me(o){var p,g;if(!o)return{name:null,area:null};const t=o.address_components||[],c=o.types||[],e=c.includes("point_of_interest")||c.includes("establishment")||c.includes("premise");let a=null;if(e&&o.place_id){const v=await Re(o.place_id);v&&(a=v)}if(!a){const v=(p=t.find(S=>S.types.includes("street_number")))==null?void 0:p.long_name,k=(g=t.find(S=>S.types.includes("route")))==null?void 0:g.long_name;a=v&&k?`${v} ${k}`:k||o.formatted_address||null}return a&&(a=a.replace(/,?\s*(Thailand|ไทย)\s*$/i,"")),{name:a}}function Re(o){return new Promise(t=>{if(!Z||!o)return t(null);Z.getDetails({placeId:o,fields:["name"]},(c,e)=>{e===google.maps.places.PlacesServiceStatus.OK&&(c!=null&&c.name)?t(c.name):t(null)})})}async function E(o){var e,a,p;if(!o||(await ce(),!w))return;V&&(V.setMap(null),V=null),H&&(H.setMap(null),H=null),z&&(z.setMap(null),z=null),U.length&&(U.forEach(g=>g.setMap(null)),U=[]);const t={lat:Number(o.coords[0][0]),lng:Number(o.coords[0][1])},c={lat:Number(o.coords[1][0]),lng:Number(o.coords[1][1])};if(H=new google.maps.Marker({position:t,map:w,label:"A"}),z=new google.maps.Marker({position:c,map:w,label:"B"}),Array.isArray(o.stopsCoords)&&o.stopsCoords.length&&(U=o.stopsCoords.map((g,v)=>new google.maps.Marker({position:{lat:g.lat,lng:g.lng},map:w,icon:"http://maps.google.com/mapfiles/ms/icons/green-dot.png",title:g.name||g.address||`จุดแวะ ${v+1}`}))),o.polyline&&((e=google.maps.geometry)!=null&&e.encoding)){const g=google.maps.geometry.encoding.decodePath(o.polyline);V=new google.maps.Polyline({path:g,map:w,strokeColor:"#2563eb",strokeOpacity:.9,strokeWeight:5});const v=new google.maps.LatLngBounds;g.forEach(k=>v.extend(k)),(a=o.stopsCoords)!=null&&a.length&&o.stopsCoords.forEach(k=>v.extend(new google.maps.LatLng(k.lat,k.lng))),w.fitBounds(v)}else{const g=new google.maps.LatLngBounds;g.extend(t),g.extend(c),(p=o.stopsCoords)!=null&&p.length&&o.stopsCoords.forEach(v=>g.extend(new google.maps.LatLng(v.lat,v.lng))),w.fitBounds(g)}}const te=C(!1),G=C(null),T=C({title:"",message:"",confirmText:"",action:null,variant:"danger"}),oe=(o,t)=>{G.value=o,t==="confirm"?T.value={title:"ยืนยันคำขอจอง",message:`ยืนยันคำขอของผู้โดยสาร "${o.passenger.name}" ใช่หรือไม่?`,confirmText:"ยืนยันคำขอ",action:"confirm",variant:"primary"}:t==="reject"?T.value={title:"ปฏิเสธคำขอจอง",message:`ต้องการปฏิเสธคำขอของ "${o.passenger.name}" ใช่หรือไม่?`,confirmText:"ปฏิเสธ",action:"reject",variant:"danger"}:t==="delete"&&(T.value={title:"ยืนยันการลบรายการ",message:"ต้องการลบคำขอนี้ออกจากรายการใช่หรือไม่?",confirmText:"ลบรายการ",action:"delete",variant:"danger"}),te.value=!0},ae=()=>{te.value=!1,G.value=null},Le=async()=>{var c;if(!G.value)return;const o=T.value.action,t=G.value.id;try{o==="confirm"?(await I(`/bookings/${t}/status`,{method:"PATCH",body:{status:"CONFIRMED"}}),L.success("สำเร็จ","ยืนยันคำขอแล้ว")):o==="reject"?(await I(`/bookings/${t}/status`,{method:"PATCH",body:{status:"REJECTED"}}),L.success("สำเร็จ","ปฏิเสธคำขอแล้ว")):o==="delete"&&(await I(`/bookings/${t}`,{method:"DELETE"}),L.success("ลบรายการสำเร็จ","ลบคำขอออกจากรายการแล้ว")),ae(),await se()}catch(e){console.error(`Failed to ${o} booking:`,e),L.error("เกิดข้อผิดพลาด",((c=e==null?void 0:e.data)==null?void 0:c.message)||"ไม่สามารถดำเนินการได้"),ae()}},Ee=async o=>{try{await navigator.clipboard.writeText(o),L.success("คัดลอกแล้ว",o)}catch{L.error("คัดลอกไม่สำเร็จ","ลองใหม่อีกครั้ง")}};function ge(o){if(typeof o!="string")return o;const t=o.split("+");if(t.length<=1)return o;let c=0;for(const e of t){const a=parseFloat(e.replace(/[^\d.]/g,""));Number.isNaN(a)||(/กม/.test(e)?c+=a*1e3:(/เมตร|ม\./.test(e),c+=a))}if(c>=1e3){const e=Math.round(c/1e3*10)/10;return`${e%1===0?e.toFixed(0):e} กม.`}return`${Math.round(c)} ม.`}function fe(o){if(typeof o!="string")return o;const t=o.split("+");if(t.length<=1)return o;let c=0;for(const p of t){const g=parseFloat(p.replace(/[^\d.]/g,""));Number.isNaN(g)||(/ชม/.test(p)?c+=g*60:c+=g)}const e=Math.floor(c/60),a=Math.round(c%60);return e?a?`${e} ชม. ${a} นาที`:`${e} ชม.`:`${a} นาที`}qe({script:(ve=window.google)!=null&&ve.maps?[]:[{key:"gmaps",src:`https://maps.googleapis.com/maps/api/js?key=${De().public.googleMapsApiKey}&libraries=places,geometry&callback=${le}`,async:!0,defer:!0}]}),Ie(()=>{var o;if((o=window.google)!=null&&o.maps){pe(),se().then(()=>{h.value==="myRoutes"?_.value.length&&E(_.value[0]):N.value.length&&E(N.value[0])});return}window[le]=()=>{try{delete window[le]}catch{}pe(),se().then(()=>{h.value==="myRoutes"?_.value.length&&E(_.value[0]):N.value.length&&E(N.value[0])})}});function pe(){!Q.value||w||(w=new google.maps.Map(Q.value,{center:{lat:13.7563,lng:100.5018},zoom:6,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!0}),X=new google.maps.Geocoder,Z=new google.maps.places.PlacesService(w),ee.value=!0)}return Ve(h,()=>{M.value=null,h.value==="myRoutes"?_.value.length>0&&E(_.value[0]):N.value.length>0&&E(N.value[0])}),(o,t)=>{const c=Be;return l(),i("div",null,[s("div",Ke,[t[34]||(t[34]=s("div",{class:"mb-8"},[s("h2",{class:"text-2xl font-bold text-gray-900"},"คำขอจองเส้นทางของฉัน"),s("p",{class:"mt-2 text-gray-600"},"ดูและจัดการคำขอจองจากผู้โดยสารในเส้นทางที่คุณสร้าง")],-1)),s("div",Je,[s("div",Ye,[(l(),i(b,null,$(Me,e=>s("button",{key:e.status,onClick:a=>h.value=e.status,class:J(["tab-button px-4 py-2 rounded-md font-medium",{active:h.value===e.status}])},r(e.label)+" ("+r(Te(e.status))+") ",11,Qe)),64))])]),s("div",Xe,[s("div",Ze,[s("div",es,[s("div",ss,[s("h3",ts,r(h.value==="myRoutes"?"เส้นทางของฉัน":"รายการคำขอจอง"),1)]),Y.value?(l(),i("div",os,t[3]||(t[3]=[s("p",null,"กำลังโหลดข้อมูล...",-1)]))):h.value==="myRoutes"?(l(),i("div",as,[_.value.length===0?(l(),i("div",ns,t[4]||(t[4]=[s("p",null,"ยังไม่มีเส้นทางที่คุณสร้าง",-1)]))):f("",!0),(l(!0),i(b,null,$(_.value,e=>(l(),i("div",{key:e.id,class:"p-6 transition-colors duration-200 cursor-pointer trip-card hover:bg-gray-50",onClick:a=>de(e.id)},[s("div",ls,[s("div",rs,[s("div",ds,[s("h4",cs,r(e.origin)+" → "+r(e.destination),1),s("span",{class:J(["status-badge",{"status-confirmed":e.status==="available","status-pending":e.status==="full"}])},r(e.status==="available"?"เปิดรับผู้โดยสาร":"เต็ม"),3)]),s("p",us,[y(" วันที่: "+r(e.date)+" ",1),t[5]||(t[5]=s("span",{class:"mx-2 text-gray-300"},"|",-1)),y(" เวลา: "+r(e.time)+" ",1),t[6]||(t[6]=s("span",{class:"mx-2 text-gray-300"},"|",-1)),y(" ระยะเวลา: "+r(e.durationText)+" ",1),t[7]||(t[7]=s("span",{class:"mx-2 text-gray-300"},"|",-1)),y(" ระยะทาง: "+r(e.distanceText),1)]),s("div",ms,[t[8]||(t[8]=s("span",{class:"font-medium"},"ที่นั่งว่าง:",-1)),s("span",gs,r(e.availableSeats),1),t[9]||(t[9]=s("span",{class:"mx-2 text-gray-300"},"|",-1)),t[10]||(t[10]=s("span",{class:"font-medium"},"ราคาต่อที่นั่ง:",-1)),s("span",fs,r(e.pricePerSeat)+" บาท",1)])])]),M.value===e.id?(l(),i("div",ps,[s("div",vs,[s("div",null,[t[13]||(t[13]=s("h5",{class:"mb-2 font-medium text-gray-900"},"รายละเอียดเส้นทาง",-1)),s("ul",ys,[s("li",null,[t[11]||(t[11]=y(" • จุดเริ่มต้น: ")),s("span",hs,r(e.origin),1),e.originAddress?(l(),i("span",xs," — "+r(e.originAddress),1)):f("",!0)]),e.stops&&e.stops.length?(l(),i(b,{key:0},[s("li",_s,"• จุดแวะระหว่างทาง ("+r(e.stops.length)+" จุด):",1),(l(!0),i(b,null,$(e.stops,(a,p)=>(l(),i("li",{key:p},"  - จุดแวะ "+r(p+1)+": "+r(a),1))),128))],64)):f("",!0),s("li",bs,[t[12]||(t[12]=y(" • จุดปลายทาง: ")),s("span",ks,r(e.destination),1),e.destinationAddress?(l(),i("span",ws," — "+r(e.destinationAddress),1)):f("",!0)])])]),s("div",null,[t[14]||(t[14]=s("h5",{class:"mb-2 font-medium text-gray-900"},"รายละเอียดรถ",-1)),s("ul",Cs,[(l(!0),i(b,null,$(e.carDetails,a=>(l(),i("li",{key:a},"• "+r(a),1))),128))])])]),s("div",$s,[e.conditions?(l(),i("div",Ms,[t[15]||(t[15]=s("h5",{class:"mb-2 font-medium text-gray-900"},"เงื่อนไขการเดินทาง",-1)),s("p",As,r(e.conditions),1)])):f("",!0),e.photos&&e.photos.length>0?(l(),i("div",Ns,[t[16]||(t[16]=s("h5",{class:"mb-2 font-medium text-gray-900"},"รูปภาพรถยนต์",-1)),s("div",Ts,[(l(!0),i(b,null,$(e.photos.slice(0,3),(a,p)=>(l(),i("div",{key:p},[s("img",{src:a,alt:"Vehicle photo",class:"object-cover w-full transition-opacity rounded-lg shadow-sm cursor-pointer aspect-video hover:opacity-90"},null,8,Rs)]))),128))])])):f("",!0),e.passengers&&e.passengers.length?(l(),i("div",Ls,[s("h5",Es,"ผู้โดยสาร ("+r(e.passengers.length)+" คน)",1),s("div",Ps,[(l(!0),i(b,null,$(e.passengers,a=>(l(),i("div",{key:a.id,class:"flex items-center space-x-3"},[s("img",{src:a.image,alt:a.name,class:"object-cover w-12 h-12 rounded-full"},null,8,Ss),s("div",Fs,[s("div",Bs,[s("span",js,r(a.name),1),a.isVerified?(l(),i("div",Os,t[17]||(t[17]=[s("svg",{class:"w-4 h-4 text-blue-600",viewBox:"0 0 24 24",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M8.603 3.799A4.49 4.49 0 0112 2.25c1.357 0 2.573.6 3.397 1.549a4.49 4.49 0 013.498 1.307 4.491 4.491 0 011.307 3.497A4.49 4.49 0 0121.75 12c0 1.357-.6 2.573-1.549 3.397a4.49 4.49 0 01-1.307 3.498 4.491 4.491 0 01-3.497 1.307A4.49 4.49 0 0112 21.75a4.49 4.49 0 01-3.397-1.549 4.49 4.49 0 01-3.498-1.306 4.491 4.491 0 01-1.307-3.498A4.49 4.49 0 012.25 12c0-1.357.6-2.573 1.549-3.397a4.49 4.49 0 011.307-3.497 4.49 4.49 0 013.497-1.307zm7.007 6.387a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.07-.01l3.5-4.875z","clip-rule":"evenodd"})],-1)]))):f("",!0)]),s("div",Ds,[y(" ที่นั่ง: "+r(a.seats)+" ",1),a.email?(l(),i("span",Is,"|")):f("",!0),a.email?(l(),i("a",{key:1,href:`mailto:${a.email}`,class:"text-blue-600 hover:underline",onClick:t[0]||(t[0]=P(()=>{},["stop"]))},r(a.email),9,Vs)):f("",!0)])])]))),128))])])):f("",!0)])])):f("",!0),s("div",{class:J(["flex justify-end",{"mt-4":M.value!==e.id}])},[$e(c,{to:`/myRoute/${e.id}/edit`,class:"px-4 py-2 text-sm text-white transition duration-200 bg-blue-600 rounded-md hover:bg-blue-700",onClick:t[1]||(t[1]=P(()=>{},["stop"]))},{default:ze(()=>t[18]||(t[18]=[y(" แก้ไขเส้นทาง ")])),_:2,__:[18]},1032,["to"])],2)],8,is))),128))])):(l(),i("div",Hs,[N.value.length===0?(l(),i("div",zs,t[19]||(t[19]=[s("p",null,"ไม่พบรายการในหมวดหมู่นี้",-1)]))):f("",!0),(l(!0),i(b,null,$(N.value,e=>(l(),i("div",{key:e.id,class:"p-6 transition-colors duration-200 cursor-pointer trip-card hover:bg-gray-50",onClick:a=>de(e.id)},[s("div",Gs,[s("div",Ws,[s("div",qs,[s("h4",Ks,r(e.origin)+" → "+r(e.destination),1),e.status==="pending"?(l(),i("span",Js,"รอดำเนินการ")):e.status==="confirmed"?(l(),i("span",Ys,"ยืนยันแล้ว")):e.status==="rejected"?(l(),i("span",Qs,"ปฏิเสธ")):e.status==="cancelled"?(l(),i("span",Xs,"ยกเลิก")):f("",!0)]),s("p",Zs,"จุดนัดพบ: "+r(e.pickupPoint),1),s("p",et,[y(" วันที่: "+r(e.date)+" ",1),t[20]||(t[20]=s("span",{class:"mx-2 text-gray-300"},"|",-1)),y(" เวลา: "+r(e.time)+" ",1),t[21]||(t[21]=s("span",{class:"mx-2 text-gray-300"},"|",-1)),y(" ระยะเวลา: "+r(e.durationText)+" ",1),t[22]||(t[22]=s("span",{class:"mx-2 text-gray-300"},"|",-1)),y(" ระยะทาง: "+r(e.distanceText),1)]),h.value==="cancelled"&&e.status==="cancelled"&&e.cancelReason?(l(),i("div",st,[s("span",tt,[t[23]||(t[23]=y(" เหตุผลการยกเลิกของผู้โดยสาร: ")),s("span",ot,r(Ne(e.cancelReason)),1)])])):f("",!0)])]),s("div",at,[s("img",{src:e.passenger.image,alt:e.passenger.name,class:"object-cover rounded-full w-15 h-15"},null,8,nt),s("div",it,[s("div",lt,[s("h5",rt,r(e.passenger.name),1),e.passenger.isVerified?(l(),i("div",dt,t[24]||(t[24]=[s("svg",{class:"w-5 h-5 text-blue-600",viewBox:"0 0 24 24",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M8.603 3.799A4.49 4.49 0 0112 2.25c1.357 0 2.573.6 3.397 1.549a4.49 4.49 0 013.498 1.307 4.491 4.491 0 011.307 3.497A4.49 4.49 0 0121.75 12c0 1.357-.6 2.573-1.549 3.397a4.49 4.49 0 01-1.307 3.498 4.491 4.491 0 01-3.497 1.307A4.49 4.49 0 0112 21.75a4.49 4.49 0 01-3.397-1.549 4.49 4.49 0 01-3.498-1.306 4.491 4.491 0 01-1.307-3.498A4.49 4.49 0 012.25 12c0-1.357.6-2.573 1.549-3.397a4.49 4.49 0 011.307-3.497 4.49 4.49 0 013.497-1.307zm7.007 6.387a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.07-.01l3.5-4.875z","clip-rule":"evenodd"})],-1),s("span",{class:"absolute px-2 py-1 mb-2 text-xs text-white transition-opacity -translate-x-1/2 bg-gray-800 rounded-md opacity-0 pointer-events-none bottom-full left-1/2 w-max group-hover:opacity-100"}," ผู้โดยสารยืนยันตัวตนแล้ว ",-1)]))):f("",!0)]),s("div",ct,[e.passenger.email?(l(),i("p",ut,[t[25]||(t[25]=y(" อีเมล: ")),s("a",{href:`mailto:${e.passenger.email}`,class:"text-blue-600 hover:underline",onClick:t[2]||(t[2]=P(()=>{},["stop"]))},r(e.passenger.email),9,mt)])):f("",!0),e.passenger.email?(l(),i("button",{key:1,class:"inline-flex items-center ml-1 text-gray-500 rounded hover:text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",title:"คัดลอกอีเมล","aria-label":"คัดลอกอีเมล",onClick:P(a=>Ee(e.passenger.email),["stop"])},t[26]||(t[26]=[s("svg",{class:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7h8a2 2 0 012 2v8a2 2 0 01-2 2H8a2 2 0 01-2-2V9a2 2 0 012-2z"}),s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7V5a2 2 0 00-2-2H8a2 2 0 00-2 2v2"})],-1)]),8,gt)):f("",!0)]),s("div",ft,[s("div",pt,[s("span",null,r("★".repeat(Math.round(e.passenger.rating)))+r("☆".repeat(5-Math.round(e.passenger.rating))),1)]),s("span",vt,r(e.passenger.rating)+" ("+r(e.passenger.reviews)+" รีวิว) ",1)])]),s("div",yt,[s("div",ht,r(e.price)+" บาท",1),s("div",xt,"จำนวน "+r(e.seats)+" ที่นั่ง",1)])]),M.value===e.id?(l(),i("div",_t,[s("div",bt,[s("div",null,[t[29]||(t[29]=s("h5",{class:"mb-2 font-medium text-gray-900"},"รายละเอียดเส้นทาง",-1)),s("ul",kt,[s("li",null,[t[27]||(t[27]=y(" • จุดเริ่มต้น: ")),s("span",wt,r(e.origin),1),e.originAddress?(l(),i("span",Ct," — "+r(e.originAddress),1)):f("",!0)]),e.stops&&e.stops.length?(l(),i(b,{key:0},[s("li",$t,"• จุดแวะระหว่างทาง ("+r(e.stops.length)+" จุด):",1),(l(!0),i(b,null,$(e.stops,(a,p)=>(l(),i("li",{key:p},"  - จุดแวะ "+r(p+1)+": "+r(a),1))),128))],64)):f("",!0),s("li",Mt,[t[28]||(t[28]=y(" • จุดปลายทาง: ")),s("span",At,r(e.destination),1),e.destinationAddress?(l(),i("span",Nt," — "+r(e.destinationAddress),1)):f("",!0)])])]),s("div",null,[t[30]||(t[30]=s("h5",{class:"mb-2 font-medium text-gray-900"},"รายละเอียดรถ",-1)),s("ul",Tt,[(l(!0),i(b,null,$(e.carDetails,a=>(l(),i("li",{key:a},"• "+r(a),1))),128))])])]),s("div",Rt,[e.conditions?(l(),i("div",Lt,[t[31]||(t[31]=s("h5",{class:"mb-2 font-medium text-gray-900"},"เงื่อนไขการเดินทาง",-1)),s("p",Et,r(e.conditions),1)])):f("",!0),e.photos&&e.photos.length>0?(l(),i("div",Pt,[t[32]||(t[32]=s("h5",{class:"mb-2 font-medium text-gray-900"},"รูปภาพรถยนต์",-1)),s("div",St,[(l(!0),i(b,null,$(e.photos.slice(0,3),(a,p)=>(l(),i("div",{key:p},[s("img",{src:a,alt:"Vehicle photo",class:"object-cover w-full transition-opacity rounded-lg shadow-sm cursor-pointer aspect-video hover:opacity-90"},null,8,Ft)]))),128))])])):f("",!0)])])):f("",!0),s("div",{class:J(["flex justify-end space-x-3",{"mt-4":M.value!==e.id}])},[e.status==="pending"?(l(),i(b,{key:0},[s("button",{onClick:P(a=>oe(e,"confirm"),["stop"]),class:"px-4 py-2 text-sm text-white transition duration-200 bg-blue-600 rounded-md hover:bg-blue-700"}," ยืนยันคำขอ ",8,Bt),s("button",{onClick:P(a=>oe(e,"reject"),["stop"]),class:"px-4 py-2 text-sm text-red-600 transition duration-200 border border-red-300 rounded-md hover:bg-red-50"}," ปฏิเสธ ",8,jt)],64)):e.status==="confirmed"?(l(),i("button",Ot," แชทกับผู้โดยสาร ")):["rejected","cancelled"].includes(e.status)?(l(),i("button",{key:2,onClick:P(a=>oe(e,"delete"),["stop"]),class:"px-4 py-2 text-sm text-gray-600 transition duration-200 border border-gray-300 rounded-md hover:bg-gray-50"}," ลบรายการ ",8,Dt)):f("",!0)],2)],8,Us))),128))]))])]),s("div",It,[s("div",Vt,[s("div",Ht,[t[33]||(t[33]=s("h3",{class:"text-lg font-semibold text-gray-900"},"แผนที่เส้นทาง",-1)),s("p",zt,r(re.value?re.value:"คลิกที่รายการเพื่อดูเส้นทาง"),1)]),s("div",{ref_key:"mapContainer",ref:Q,id:"map"},null,512)])])])]),$e(Ge,{show:te.value,title:T.value.title,message:T.value.message,confirmText:T.value.confirmText,variant:T.value.variant,onConfirm:Le,onCancel:ae},null,8,["show","title","message","confirmText","variant"])])}}},eo=je(Ut,[["__scopeId","data-v-4c1abb84"]]);export{eo as default};
