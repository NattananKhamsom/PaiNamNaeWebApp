import{_ as Re,m as Le,r as $,x as we,y as Se,i as Fe,p as je,c as i,a as s,b as Be,F as _,q as M,t as r,g as f,s as Oe,o as l,n as J,d as v,f as L}from"./DPSIKoxe.js";import{d as j}from"./B5yDJBm8.js";import{b as De}from"./C5FTVxxA.js";import{C as Ve}from"./CL2Ezi0q.js";import{s as Ie}from"./x_rD_Ya3.js";import{u as He}from"./BaxiziUg.js";import"./Cpj98o6Y.js";const ze={class:"px-4 py-8 mx-auto max-w-7xl sm:px-6 lg:px-8"},Ue={class:"p-6 mb-8 bg-white border border-gray-300 rounded-lg shadow-md"},Ge={class:"flex flex-wrap gap-2"},We=["onClick"],qe={class:"grid grid-cols-1 gap-6 lg:grid-cols-3"},Ke={class:"lg:col-span-2"},Je={class:"bg-white border border-gray-300 rounded-lg shadow-md"},Ye={class:"p-6 border-b border-gray-300"},Qe={class:"text-lg font-semibold text-gray-900"},Xe={key:0,class:"p-12 text-center text-gray-500"},Ze={key:1,class:"divide-y divide-gray-200"},es={key:0,class:"p-12 text-center text-gray-500"},ss=["onClick"],ts={class:"flex items-start justify-between mb-4"},as={class:"flex-1"},os={class:"flex items-center justify-between"},ns={class:"text-lg font-semibold text-gray-900"},is={class:"mt-1 text-sm text-gray-600"},ls={class:"mt-1 text-sm text-gray-600"},rs={class:"ml-1"},ds={class:"ml-1"},cs={key:0,class:"pt-4 mt-4 mb-5 duration-300 border-t border-gray-300 animate-in slide-in-from-top"},us={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},ms={class:"space-y-1 text-sm text-gray-600"},gs={class:"font-medium text-gray-900"},fs={key:0},ps={class:"mt-2 text-gray-700"},vs={class:"mt-1"},ys={class:"font-medium text-gray-900"},hs={key:0},xs={class:"space-y-1 text-sm text-gray-600"},_s={class:"mt-4 space-y-4"},bs={key:0},ks={class:"p-3 text-sm text-gray-700 border border-gray-300 rounded-md bg-gray-50"},ws={key:1},Cs={class:"grid grid-cols-3 gap-2 mt-2"},$s=["src"],Ms={key:2},As={class:"mb-2 font-medium text-gray-900"},Ns={class:"space-y-3"},Ts=["src","alt"],Ps={class:"flex-1"},Es={class:"flex items-center"},Rs={class:"font-medium text-gray-900"},Ls={key:0,class:"relative group ml-1.5 flex items-center"},Ss={class:"text-sm text-gray-600"},Fs={key:0,class:"mx-2 text-gray-300"},js=["href"],Bs=["onClick"],Os={key:2,class:"divide-y divide-gray-200"},Ds={key:0,class:"p-12 text-center text-gray-500"},Vs=["onClick"],Is={class:"flex items-start justify-between mb-4"},Hs={class:"flex-1"},zs={class:"flex items-center justify-between"},Us={class:"text-lg font-semibold text-gray-900"},Gs={key:0,class:"status-badge status-pending"},Ws={key:1,class:"status-badge status-confirmed"},qs={key:2,class:"status-badge status-rejected"},Ks={key:3,class:"status-badge status-cancelled"},Js={class:"mt-1 text-sm text-gray-600"},Ys={class:"text-sm text-gray-600"},Qs={key:0,class:"p-2 mt-2 border border-gray-200 rounded-md bg-gray-50"},Xs={class:"text-sm text-gray-700"},Zs={class:"font-medium"},et={class:"flex items-center mb-4 space-x-4"},st=["src","alt"],tt={class:"flex-1"},at={class:"flex items-center"},ot={class:"font-medium text-gray-900"},nt={key:0,class:"relative group ml-1.5 flex items-center"},it={class:"flex"},lt={key:0,class:"text-xs text-gray-500 mt-0.5"},rt=["href"],dt=["onClick"],ct={class:"flex items-center mt-1"},ut={class:"flex text-sm text-yellow-400"},mt={class:"ml-2 text-sm text-gray-600"},gt={class:"text-right"},ft={class:"text-lg font-bold text-blue-600"},pt={class:"text-sm text-gray-600"},vt={key:0,class:"pt-4 mt-4 mb-5 duration-300 border-t border-gray-300 animate-in slide-in-from-top"},yt={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},ht={class:"space-y-1 text-sm text-gray-600"},xt={class:"font-medium text-gray-900"},_t={key:0},bt={class:"mt-2 text-gray-700"},kt={class:"mt-1"},wt={class:"font-medium text-gray-900"},Ct={key:0},$t={class:"space-y-1 text-sm text-gray-600"},Mt={class:"mt-4 space-y-4"},At={key:0},Nt={class:"p-3 text-sm text-gray-700 border border-gray-300 rounded-md bg-gray-50"},Tt={key:1},Pt={class:"grid grid-cols-3 gap-2 mt-2"},Et=["src"],Rt=["onClick"],Lt=["onClick"],St={key:1,class:"px-4 py-2 text-sm text-white transition duration-200 bg-blue-600 rounded-md hover:bg-blue-700"},Ft=["onClick"],jt={class:"lg:col-span-1"},Bt={class:"sticky overflow-hidden bg-white border border-gray-300 rounded-lg shadow-md top-8"},Ot={class:"p-3 border-gray-300"},Dt={class:"mt-1 text-sm text-gray-600"},ie="__gmapsReady__",Vt={__name:"index_v5",setup(It){var pe;j.locale("th"),j.extend(De);const{$api:V}=Le(),{toast:R}=Oe(),y=$("pending"),A=$(null),Y=$(!1),Q=$(null),h=$([]),x=$([]);let C=null,I=null,H=null,z=null,X=null,Z=null;const ee=$(!1);let U=[];const Ce=[{status:"pending",label:"รอดำเนินการ"},{status:"confirmed",label:"ยืนยันแล้ว"},{status:"rejected",label:"ปฏิเสธ"},{status:"cancelled",label:"ยกเลิก"},{status:"all",label:"ทั้งหมด"},{status:"myRoutes",label:"เส้นทางของฉัน"}];function B(a){return(a||"").replace(/,?\s*(Thailand|ไทย|ประเทศ)\s*$/i,"").replace(/\s{2,}/g," ").trim()}const $e={CHANGE_OF_PLAN:"เปลี่ยนแผน/มีธุระกะทันหัน",FOUND_ALTERNATIVE:"พบวิธีเดินทางอื่นแล้ว",DRIVER_DELAY:"คนขับล่าช้าหรือเลื่อนเวลา",PRICE_ISSUE:"ราคาหรือค่าใช้จ่ายไม่เหมาะสม",WRONG_LOCATION:"เลือกจุดรับ–ส่งผิด",DUPLICATE_OR_WRONG_DATE:"จองซ้ำหรือจองผิดวัน",SAFETY_CONCERN:"กังวลด้านความปลอดภัย",WEATHER_OR_FORCE_MAJEURE:"สภาพอากาศ/เหตุสุดวิสัย",COMMUNICATION_ISSUE:"สื่อสารไม่สะดวก/ติดต่อไม่ได้"};function Me(a){return $e[a]||a}const T=we(()=>y.value==="all"?h.value:h.value.filter(a=>a.status===y.value)),le=we(()=>{if(y.value==="myRoutes"){const t=x.value.find(e=>e.id===A.value);return t?`${t.origin} → ${t.destination}`:null}const a=h.value.find(t=>t.id===A.value);return a?`${a.origin} → ${a.destination}`:null});async function se(){var a,t,e,o,c,b,g,p,k,S;Y.value=!0;try{const F=await V("/routes/me"),ve=[],ye=[];for(const n of F){const N=[];n.vehicle?(N.push(`${n.vehicle.vehicleModel} (${n.vehicle.vehicleType})`),Array.isArray(n.vehicle.amenities)&&n.vehicle.amenities.length>0&&N.push(...n.vehicle.amenities)):N.push("ไม่มีข้อมูลรถ");const u=n.startLocation,m=n.endLocation,W=[[u.lat,u.lng],[m.lat,m.lng]],w=n.waypoints||{},ne=Array.isArray(w.used)&&w.used.length?w.used:Array.isArray(w.requested)?w.requested:[],he=Array.isArray(w.optimizedOrder)&&w.optimizedOrder.length===ne.length?w.optimizedOrder.map(d=>ne[d]):ne,xe=he.map(d=>{const q=(d==null?void 0:d.name)||"",O=B((d==null?void 0:d.address)||""),K=(d==null?void 0:d.lat)!=null&&(d==null?void 0:d.lng)!=null?`(${d.lat.toFixed(6)}, ${d.lng.toFixed(6)})`:"",D=q||K;return O?`${D} — ${O}`:D}).filter(Boolean),_e=he.map(d=>d&&typeof d.lat=="number"&&typeof d.lng=="number"?{lat:d.lat,lng:d.lng,name:d.name||"",address:d.address||""}:null).filter(Boolean);for(const d of n.bookings||[])ve.push({id:d.id,status:(d.status||"").toLowerCase(),origin:(u==null?void 0:u.name)||`(${Number(u.lat).toFixed(2)}, ${Number(u.lng).toFixed(2)})`,destination:(m==null?void 0:m.name)||`(${Number(m.lat).toFixed(2)}, ${Number(m.lng).toFixed(2)})`,originHasName:!!(u!=null&&u.name),destinationHasName:!!(m!=null&&m.name),pickupPoint:((a=d.pickupLocation)==null?void 0:a.name)||"-",date:j(n.departureTime).format("D MMMM BBBB"),time:j(n.departureTime).format("HH:mm น."),price:(n.pricePerSeat||0)*(d.numberOfSeats||0),seats:d.numberOfSeats||0,passenger:{name:`${((t=d.passenger)==null?void 0:t.firstName)||""} ${((e=d.passenger)==null?void 0:e.lastName)||""}`.trim()||"ผู้โดยสาร",image:((o=d.passenger)==null?void 0:o.profilePicture)||`https://ui-avatars.com/api/?name=${encodeURIComponent(((c=d.passenger)==null?void 0:c.firstName)||"P")}&background=random&size=64`,email:((b=d.passenger)==null?void 0:b.email)||"",isVerified:!!((g=d.passenger)!=null&&g.isVerified),rating:4.5,reviews:Math.floor(Math.random()*50)+5},coords:W,polyline:n.routePolyline||null,stops:xe,stopsCoords:_e,cancelReason:d.cancelReason||null,carDetails:N,conditions:n.conditions,photos:((p=n.vehicle)==null?void 0:p.photos)||[],originAddress:u!=null&&u.address?B(u.address):null,destinationAddress:m!=null&&m.address?B(m.address):null,durationText:(typeof n.duration=="string"?ge(n.duration):n.duration)||(n.durationSeconds?`${Math.round(n.durationSeconds/60)} นาที`:"-"),distanceText:(typeof n.distance=="string"?me(n.distance):n.distance)||(n.distanceMeters?`${(n.distanceMeters/1e3).toFixed(1)} กม.`:"-")});ye.push({id:n.id,status:(n.status||"").toLowerCase(),origin:(u==null?void 0:u.name)||`(${Number(u.lat).toFixed(2)}, ${Number(u.lng).toFixed(2)})`,destination:(m==null?void 0:m.name)||`(${Number(m.lat).toFixed(2)}, ${Number(m.lng).toFixed(2)})`,originAddress:u!=null&&u.address?B(u.address):null,destinationAddress:m!=null&&m.address?B(m.address):null,date:j(n.departureTime).format("D MMMM BBBB"),time:j(n.departureTime).format("HH:mm น."),pricePerSeat:n.pricePerSeat||0,availableSeats:n.availableSeats??0,coords:[[u.lat,u.lng],[m.lat,m.lng]],polyline:n.routePolyline||null,stops:xe,stopsCoords:_e,carDetails:n.vehicle?[`${n.vehicle.vehicleModel} (${n.vehicle.vehicleType})`,...n.vehicle.amenities||[]]:["ไม่มีข้อมูลรถ"],photos:((k=n.vehicle)==null?void 0:k.photos)||[],conditions:n.conditions||"",passengers:(n.bookings||[]).map(d=>{var q,O,K,D,be,ke;return{id:d.id,seats:d.numberOfSeats||0,status:(d.status||"").toLowerCase(),name:`${((q=d.passenger)==null?void 0:q.firstName)||""} ${((O=d.passenger)==null?void 0:O.lastName)||""}`.trim()||"ผู้โดยสาร",image:((K=d.passenger)==null?void 0:K.profilePicture)||`https://ui-avatars.com/api/?name=${encodeURIComponent(((D=d.passenger)==null?void 0:D.firstName)||"P")}&background=random&size=64`,email:((be=d.passenger)==null?void 0:be.email)||"",isVerified:!!((ke=d.passenger)!=null&&ke.isVerified),rating:4.5,reviews:Math.floor(Math.random()*50)+5}}),durationText:(typeof n.duration=="string"?ge(n.duration):n.duration)||(n.durationSeconds?`${Math.round(n.durationSeconds/60)} นาที`:"-"),distanceText:(typeof n.distance=="string"?me(n.distance):n.distance)||(n.distanceMeters?`${(n.distanceMeters/1e3).toFixed(1)} กม.`:"-")})}h.value=ve,x.value=ye,await de();const Ee=h.value.map(async(n,N)=>{const[u,m]=await Promise.all([ce(n.coords[0][0],n.coords[0][1]),ce(n.coords[1][0],n.coords[1][1])]),W=await ue(u),w=await ue(m);!h.value[N].originHasName&&W.name&&(h.value[N].origin=W.name),!h.value[N].destinationHasName&&w.name&&(h.value[N].destination=w.name)});await Promise.allSettled(Ee)}catch(F){console.error("Failed to fetch routes:",F),h.value=[],x.value=[],R.error("เกิดข้อผิดพลาด",((S=F==null?void 0:F.data)==null?void 0:S.message)||"ไม่สามารถโหลดข้อมูลได้")}finally{Y.value=!1}}const Ae=a=>a==="all"?h.value.length:a==="myRoutes"?x.value.length:h.value.filter(t=>t.status===a).length,re=a=>{const t=y.value==="myRoutes"?x.value.find(e=>e.id===a):h.value.find(e=>e.id===a);t&&P(t),A.value=A.value===a?null:a};function de(){return new Promise(a=>{if(ee.value)return a(!0);const t=Ie(()=>{ee.value&&(clearInterval(t),a(!0))},50)})}function ce(a,t){return new Promise(e=>{if(!X)return e(null);X.geocode({location:{lat:a,lng:t}},(o,c)=>{if(c!=="OK"||!(o!=null&&o.length))return e(null);e(o[0])})})}async function ue(a){var b,g;if(!a)return{name:null,area:null};const t=a.address_components||[],e=a.types||[],o=e.includes("point_of_interest")||e.includes("establishment")||e.includes("premise");let c=null;if(o&&a.place_id){const p=await Ne(a.place_id);p&&(c=p)}if(!c){const p=(b=t.find(S=>S.types.includes("street_number")))==null?void 0:b.long_name,k=(g=t.find(S=>S.types.includes("route")))==null?void 0:g.long_name;c=p&&k?`${p} ${k}`:k||a.formatted_address||null}return c&&(c=c.replace(/,?\s*(Thailand|ไทย)\s*$/i,"")),{name:c}}function Ne(a){return new Promise(t=>{if(!Z||!a)return t(null);Z.getDetails({placeId:a,fields:["name"]},(e,o)=>{o===google.maps.places.PlacesServiceStatus.OK&&(e!=null&&e.name)?t(e.name):t(null)})})}async function P(a){var o,c,b;if(!a||(await de(),!C))return;I&&(I.setMap(null),I=null),H&&(H.setMap(null),H=null),z&&(z.setMap(null),z=null),U.length&&(U.forEach(g=>g.setMap(null)),U=[]);const t={lat:Number(a.coords[0][0]),lng:Number(a.coords[0][1])},e={lat:Number(a.coords[1][0]),lng:Number(a.coords[1][1])};if(H=new google.maps.Marker({position:t,map:C,label:"A"}),z=new google.maps.Marker({position:e,map:C,label:"B"}),Array.isArray(a.stopsCoords)&&a.stopsCoords.length&&(U=a.stopsCoords.map((g,p)=>new google.maps.Marker({position:{lat:g.lat,lng:g.lng},map:C,icon:"http://maps.google.com/mapfiles/ms/icons/green-dot.png",title:g.name||g.address||`จุดแวะ ${p+1}`}))),a.polyline&&((o=google.maps.geometry)!=null&&o.encoding)){const g=google.maps.geometry.encoding.decodePath(a.polyline);I=new google.maps.Polyline({path:g,map:C,strokeColor:"#2563eb",strokeOpacity:.9,strokeWeight:5});const p=new google.maps.LatLngBounds;g.forEach(k=>p.extend(k)),(c=a.stopsCoords)!=null&&c.length&&a.stopsCoords.forEach(k=>p.extend(new google.maps.LatLng(k.lat,k.lng))),C.fitBounds(p)}else{const g=new google.maps.LatLngBounds;g.extend(t),g.extend(e),(b=a.stopsCoords)!=null&&b.length&&a.stopsCoords.forEach(p=>g.extend(new google.maps.LatLng(p.lat,p.lng))),C.fitBounds(g)}}const te=$(!1),G=$(null),E=$({title:"",message:"",confirmText:"",action:null,variant:"danger"}),ae=(a,t)=>{G.value=a,t==="confirm"?E.value={title:"ยืนยันคำขอจอง",message:`ยืนยันคำขอของผู้โดยสาร "${a.passenger.name}" ใช่หรือไม่?`,confirmText:"ยืนยันคำขอ",action:"confirm",variant:"primary"}:t==="reject"?E.value={title:"ปฏิเสธคำขอจอง",message:`ต้องการปฏิเสธคำขอของ "${a.passenger.name}" ใช่หรือไม่?`,confirmText:"ปฏิเสธ",action:"reject",variant:"danger"}:t==="delete"&&(E.value={title:"ยืนยันการลบรายการ",message:"ต้องการลบคำขอนี้ออกจากรายการใช่หรือไม่?",confirmText:"ลบรายการ",action:"delete",variant:"danger"}),te.value=!0},oe=()=>{te.value=!1,G.value=null},Te=async()=>{var e;if(!G.value)return;const a=E.value.action,t=G.value.id;try{a==="confirm"?(await V(`/bookings/${t}/status`,{method:"PATCH",body:{status:"CONFIRMED"}}),R.success("สำเร็จ","ยืนยันคำขอแล้ว")):a==="reject"?(await V(`/bookings/${t}/status`,{method:"PATCH",body:{status:"REJECTED"}}),R.success("สำเร็จ","ปฏิเสธคำขอแล้ว")):a==="delete"&&(await V(`/bookings/${t}`,{method:"DELETE"}),R.success("ลบรายการสำเร็จ","ลบคำขอออกจากรายการแล้ว")),oe(),await se()}catch(o){console.error(`Failed to ${a} booking:`,o),R.error("เกิดข้อผิดพลาด",((e=o==null?void 0:o.data)==null?void 0:e.message)||"ไม่สามารถดำเนินการได้"),oe()}},Pe=async a=>{try{await navigator.clipboard.writeText(a),R.success("คัดลอกแล้ว",a)}catch{R.error("คัดลอกไม่สำเร็จ","ลองใหม่อีกครั้ง")}};function me(a){if(typeof a!="string")return a;const t=a.split("+");if(t.length<=1)return a;let e=0;for(const o of t){const c=parseFloat(o.replace(/[^\d.]/g,""));Number.isNaN(c)||(/กม/.test(o)?e+=c*1e3:(/เมตร|ม\./.test(o),e+=c))}if(e>=1e3){const o=Math.round(e/1e3*10)/10;return`${o%1===0?o.toFixed(0):o} กม.`}return`${Math.round(e)} ม.`}function ge(a){if(typeof a!="string")return a;const t=a.split("+");if(t.length<=1)return a;let e=0;for(const b of t){const g=parseFloat(b.replace(/[^\d.]/g,""));Number.isNaN(g)||(/ชม/.test(b)?e+=g*60:e+=g)}const o=Math.floor(e/60),c=Math.round(e%60);return o?c?`${o} ชม. ${c} นาที`:`${o} ชม.`:`${c} นาที`}He({script:(pe=window.google)!=null&&pe.maps?[]:[{key:"gmaps",src:`https://maps.googleapis.com/maps/api/js?key=${Se().public.googleMapsApiKey}&libraries=places,geometry&callback=${ie}`,async:!0,defer:!0}]}),Fe(()=>{var a;if((a=window.google)!=null&&a.maps){fe(),se().then(()=>{y.value==="myRoutes"?x.value.length&&P(x.value[0]):T.value.length&&P(T.value[0])});return}window[ie]=()=>{try{delete window[ie]}catch{}fe(),se().then(()=>{y.value==="myRoutes"?x.value.length&&P(x.value[0]):T.value.length&&P(T.value[0])})}});function fe(){!Q.value||C||(C=new google.maps.Map(Q.value,{center:{lat:13.7563,lng:100.5018},zoom:6,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!0}),X=new google.maps.Geocoder,Z=new google.maps.places.PlacesService(C),ee.value=!0)}return je(y,()=>{A.value=null,y.value==="myRoutes"?x.value.length>0&&P(x.value[0]):T.value.length>0&&P(T.value[0])}),(a,t)=>(l(),i("div",null,[s("div",ze,[t[32]||(t[32]=s("div",{class:"mb-8"},[s("h2",{class:"text-2xl font-bold text-gray-900"},"คำขอจองเส้นทางของฉัน"),s("p",{class:"mt-2 text-gray-600"},"ดูและจัดการคำขอจองจากผู้โดยสารในเส้นทางที่คุณสร้าง")],-1)),s("div",Ue,[s("div",Ge,[(l(),i(_,null,M(Ce,e=>s("button",{key:e.status,onClick:o=>y.value=e.status,class:J(["tab-button px-4 py-2 rounded-md font-medium",{active:y.value===e.status}])},r(e.label)+" ("+r(Ae(e.status))+") ",11,We)),64))])]),s("div",qe,[s("div",Ke,[s("div",Je,[s("div",Ye,[s("h3",Qe,r(y.value==="myRoutes"?"เส้นทางของฉัน":"รายการคำขอจอง"),1)]),Y.value?(l(),i("div",Xe,t[2]||(t[2]=[s("p",null,"กำลังโหลดข้อมูล...",-1)]))):y.value==="myRoutes"?(l(),i("div",Ze,[x.value.length===0?(l(),i("div",es,t[3]||(t[3]=[s("p",null,"ยังไม่มีเส้นทางที่คุณสร้าง",-1)]))):f("",!0),(l(!0),i(_,null,M(x.value,e=>(l(),i("div",{key:e.id,class:"p-6 transition-colors duration-200 cursor-pointer trip-card hover:bg-gray-50",onClick:o=>re(e.id)},[s("div",ts,[s("div",as,[s("div",os,[s("h4",ns,r(e.origin)+" → "+r(e.destination),1),s("span",{class:J(["status-badge",{"status-confirmed":e.status==="available","status-pending":e.status==="full"}])},r(e.status==="available"?"เปิดรับผู้โดยสาร":"เต็ม"),3)]),s("p",is,[v(" วันที่: "+r(e.date)+" ",1),t[4]||(t[4]=s("span",{class:"mx-2 text-gray-300"},"|",-1)),v(" เวลา: "+r(e.time)+" ",1),t[5]||(t[5]=s("span",{class:"mx-2 text-gray-300"},"|",-1)),v(" ระยะเวลา: "+r(e.durationText)+" ",1),t[6]||(t[6]=s("span",{class:"mx-2 text-gray-300"},"|",-1)),v(" ระยะทาง: "+r(e.distanceText),1)]),s("div",ls,[t[7]||(t[7]=s("span",{class:"font-medium"},"ที่นั่งว่าง:",-1)),s("span",rs,r(e.availableSeats),1),t[8]||(t[8]=s("span",{class:"mx-2 text-gray-300"},"|",-1)),t[9]||(t[9]=s("span",{class:"font-medium"},"ราคาต่อที่นั่ง:",-1)),s("span",ds,r(e.pricePerSeat)+" บาท",1)])])]),A.value===e.id?(l(),i("div",cs,[s("div",us,[s("div",null,[t[12]||(t[12]=s("h5",{class:"mb-2 font-medium text-gray-900"},"รายละเอียดเส้นทาง",-1)),s("ul",ms,[s("li",null,[t[10]||(t[10]=v(" • จุดเริ่มต้น: ")),s("span",gs,r(e.origin),1),e.originAddress?(l(),i("span",fs," — "+r(e.originAddress),1)):f("",!0)]),e.stops&&e.stops.length?(l(),i(_,{key:0},[s("li",ps,"• จุดแวะระหว่างทาง ("+r(e.stops.length)+" จุด):",1),(l(!0),i(_,null,M(e.stops,(o,c)=>(l(),i("li",{key:c},"  - จุดแวะ "+r(c+1)+": "+r(o),1))),128))],64)):f("",!0),s("li",vs,[t[11]||(t[11]=v(" • จุดปลายทาง: ")),s("span",ys,r(e.destination),1),e.destinationAddress?(l(),i("span",hs," — "+r(e.destinationAddress),1)):f("",!0)])])]),s("div",null,[t[13]||(t[13]=s("h5",{class:"mb-2 font-medium text-gray-900"},"รายละเอียดรถ",-1)),s("ul",xs,[(l(!0),i(_,null,M(e.carDetails,o=>(l(),i("li",{key:o},"• "+r(o),1))),128))])])]),s("div",_s,[e.conditions?(l(),i("div",bs,[t[14]||(t[14]=s("h5",{class:"mb-2 font-medium text-gray-900"},"เงื่อนไขการเดินทาง",-1)),s("p",ks,r(e.conditions),1)])):f("",!0),e.photos&&e.photos.length>0?(l(),i("div",ws,[t[15]||(t[15]=s("h5",{class:"mb-2 font-medium text-gray-900"},"รูปภาพรถยนต์",-1)),s("div",Cs,[(l(!0),i(_,null,M(e.photos.slice(0,3),(o,c)=>(l(),i("div",{key:c},[s("img",{src:o,alt:"Vehicle photo",class:"object-cover w-full transition-opacity rounded-lg shadow-sm cursor-pointer aspect-video hover:opacity-90"},null,8,$s)]))),128))])])):f("",!0),e.passengers&&e.passengers.length?(l(),i("div",Ms,[s("h5",As,"ผู้โดยสาร ("+r(e.passengers.length)+" คน)",1),s("div",Ns,[(l(!0),i(_,null,M(e.passengers,o=>(l(),i("div",{key:o.id,class:"flex items-center space-x-3"},[s("img",{src:o.image,alt:o.name,class:"object-cover w-12 h-12 rounded-full"},null,8,Ts),s("div",Ps,[s("div",Es,[s("span",Rs,r(o.name),1),o.isVerified?(l(),i("div",Ls,t[16]||(t[16]=[s("svg",{class:"w-4 h-4 text-blue-600",viewBox:"0 0 24 24",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M8.603 3.799A4.49 4.49 0 0112 2.25c1.357 0 2.573.6 3.397 1.549a4.49 4.49 0 013.498 1.307 4.491 4.491 0 011.307 3.497A4.49 4.49 0 0121.75 12c0 1.357-.6 2.573-1.549 3.397a4.49 4.49 0 01-1.307 3.498 4.491 4.491 0 01-3.497 1.307A4.49 4.49 0 0112 21.75a4.49 4.49 0 01-3.397-1.549 4.49 4.49 0 01-3.498-1.306 4.491 4.491 0 01-1.307-3.498A4.49 4.49 0 012.25 12c0-1.357.6-2.573 1.549-3.397a4.49 4.49 0 011.307-3.497 4.49 4.49 0 013.497-1.307zm7.007 6.387a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.07-.01l3.5-4.875z","clip-rule":"evenodd"})],-1)]))):f("",!0)]),s("div",Ss,[v(" ที่นั่ง: "+r(o.seats)+" ",1),o.email?(l(),i("span",Fs,"|")):f("",!0),o.email?(l(),i("a",{key:1,href:`mailto:${o.email}`,class:"text-blue-600 hover:underline",onClick:t[0]||(t[0]=L(()=>{},["stop"]))},r(o.email),9,js)):f("",!0)])])]))),128))])])):f("",!0)])])):f("",!0),s("div",{class:J(["flex justify-end",{"mt-4":A.value!==e.id}])},[s("button",{class:"px-4 py-2 text-sm text-white transition duration-200 bg-blue-600 rounded-md hover:bg-blue-700",onClick:L(o=>P(e),["stop"])}," ดูเส้นทางบนแผนที่ ",8,Bs)],2)],8,ss))),128))])):(l(),i("div",Os,[T.value.length===0?(l(),i("div",Ds,t[17]||(t[17]=[s("p",null,"ไม่พบรายการในหมวดหมู่นี้",-1)]))):f("",!0),(l(!0),i(_,null,M(T.value,e=>(l(),i("div",{key:e.id,class:"p-6 transition-colors duration-200 cursor-pointer trip-card hover:bg-gray-50",onClick:o=>re(e.id)},[s("div",Is,[s("div",Hs,[s("div",zs,[s("h4",Us,r(e.origin)+" → "+r(e.destination),1),e.status==="pending"?(l(),i("span",Gs,"รอดำเนินการ")):e.status==="confirmed"?(l(),i("span",Ws,"ยืนยันแล้ว")):e.status==="rejected"?(l(),i("span",qs,"ปฏิเสธ")):e.status==="cancelled"?(l(),i("span",Ks,"ยกเลิก")):f("",!0)]),s("p",Js,"จุดนัดพบ: "+r(e.pickupPoint),1),s("p",Ys,[v(" วันที่: "+r(e.date)+" ",1),t[18]||(t[18]=s("span",{class:"mx-2 text-gray-300"},"|",-1)),v(" เวลา: "+r(e.time)+" ",1),t[19]||(t[19]=s("span",{class:"mx-2 text-gray-300"},"|",-1)),v(" ระยะเวลา: "+r(e.durationText)+" ",1),t[20]||(t[20]=s("span",{class:"mx-2 text-gray-300"},"|",-1)),v(" ระยะทาง: "+r(e.distanceText),1)]),y.value==="cancelled"&&e.status==="cancelled"&&e.cancelReason?(l(),i("div",Qs,[s("span",Xs,[t[21]||(t[21]=v(" เหตุผลการยกเลิกของผู้โดยสาร: ")),s("span",Zs,r(Me(e.cancelReason)),1)])])):f("",!0)])]),s("div",et,[s("img",{src:e.passenger.image,alt:e.passenger.name,class:"object-cover rounded-full w-15 h-15"},null,8,st),s("div",tt,[s("div",at,[s("h5",ot,r(e.passenger.name),1),e.passenger.isVerified?(l(),i("div",nt,t[22]||(t[22]=[s("svg",{class:"w-5 h-5 text-blue-600",viewBox:"0 0 24 24",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M8.603 3.799A4.49 4.49 0 0112 2.25c1.357 0 2.573.6 3.397 1.549a4.49 4.49 0 013.498 1.307 4.491 4.491 0 011.307 3.497A4.49 4.49 0 0121.75 12c0 1.357-.6 2.573-1.549 3.397a4.49 4.49 0 01-1.307 3.498 4.491 4.491 0 01-3.497 1.307A4.49 4.49 0 0112 21.75a4.49 4.49 0 01-3.397-1.549 4.49 4.49 0 01-3.498-1.306 4.491 4.491 0 01-1.307-3.498A4.49 4.49 0 012.25 12c0-1.357.6-2.573 1.549-3.397a4.49 4.49 0 011.307-3.497 4.49 4.49 0 013.497-1.307zm7.007 6.387a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.07-.01l3.5-4.875z","clip-rule":"evenodd"})],-1),s("span",{class:"absolute px-2 py-1 mb-2 text-xs text-white transition-opacity -translate-x-1/2 bg-gray-800 rounded-md opacity-0 pointer-events-none bottom-full left-1/2 w-max group-hover:opacity-100"}," ผู้โดยสารยืนยันตัวตนแล้ว ",-1)]))):f("",!0)]),s("div",it,[e.passenger.email?(l(),i("p",lt,[t[23]||(t[23]=v(" อีเมล: ")),s("a",{href:`mailto:${e.passenger.email}`,class:"text-blue-600 hover:underline",onClick:t[1]||(t[1]=L(()=>{},["stop"]))},r(e.passenger.email),9,rt)])):f("",!0),e.passenger.email?(l(),i("button",{key:1,class:"inline-flex items-center ml-1 text-gray-500 rounded hover:text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",title:"คัดลอกอีเมล","aria-label":"คัดลอกอีเมล",onClick:L(o=>Pe(e.passenger.email),["stop"])},t[24]||(t[24]=[s("svg",{class:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7h8a2 2 0 012 2v8a2 2 0 01-2 2H8a2 2 0 01-2-2V9a2 2 0 012-2z"}),s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7V5a2 2 0 00-2-2H8a2 2 0 00-2 2v2"})],-1)]),8,dt)):f("",!0)]),s("div",ct,[s("div",ut,[s("span",null,r("★".repeat(Math.round(e.passenger.rating)))+r("☆".repeat(5-Math.round(e.passenger.rating))),1)]),s("span",mt,r(e.passenger.rating)+" ("+r(e.passenger.reviews)+" รีวิว) ",1)])]),s("div",gt,[s("div",ft,r(e.price)+" บาท",1),s("div",pt,"จำนวน "+r(e.seats)+" ที่นั่ง",1)])]),A.value===e.id?(l(),i("div",vt,[s("div",yt,[s("div",null,[t[27]||(t[27]=s("h5",{class:"mb-2 font-medium text-gray-900"},"รายละเอียดเส้นทาง",-1)),s("ul",ht,[s("li",null,[t[25]||(t[25]=v(" • จุดเริ่มต้น: ")),s("span",xt,r(e.origin),1),e.originAddress?(l(),i("span",_t," — "+r(e.originAddress),1)):f("",!0)]),e.stops&&e.stops.length?(l(),i(_,{key:0},[s("li",bt,"• จุดแวะระหว่างทาง ("+r(e.stops.length)+" จุด):",1),(l(!0),i(_,null,M(e.stops,(o,c)=>(l(),i("li",{key:c},"  - จุดแวะ "+r(c+1)+": "+r(o),1))),128))],64)):f("",!0),s("li",kt,[t[26]||(t[26]=v(" • จุดปลายทาง: ")),s("span",wt,r(e.destination),1),e.destinationAddress?(l(),i("span",Ct," — "+r(e.destinationAddress),1)):f("",!0)])])]),s("div",null,[t[28]||(t[28]=s("h5",{class:"mb-2 font-medium text-gray-900"},"รายละเอียดรถ",-1)),s("ul",$t,[(l(!0),i(_,null,M(e.carDetails,o=>(l(),i("li",{key:o},"• "+r(o),1))),128))])])]),s("div",Mt,[e.conditions?(l(),i("div",At,[t[29]||(t[29]=s("h5",{class:"mb-2 font-medium text-gray-900"},"เงื่อนไขการเดินทาง",-1)),s("p",Nt,r(e.conditions),1)])):f("",!0),e.photos&&e.photos.length>0?(l(),i("div",Tt,[t[30]||(t[30]=s("h5",{class:"mb-2 font-medium text-gray-900"},"รูปภาพรถยนต์",-1)),s("div",Pt,[(l(!0),i(_,null,M(e.photos.slice(0,3),(o,c)=>(l(),i("div",{key:c},[s("img",{src:o,alt:"Vehicle photo",class:"object-cover w-full transition-opacity rounded-lg shadow-sm cursor-pointer aspect-video hover:opacity-90"},null,8,Et)]))),128))])])):f("",!0)])])):f("",!0),s("div",{class:J(["flex justify-end space-x-3",{"mt-4":A.value!==e.id}])},[e.status==="pending"?(l(),i(_,{key:0},[s("button",{onClick:L(o=>ae(e,"confirm"),["stop"]),class:"px-4 py-2 text-sm text-white transition duration-200 bg-blue-600 rounded-md hover:bg-blue-700"}," ยืนยันคำขอ ",8,Rt),s("button",{onClick:L(o=>ae(e,"reject"),["stop"]),class:"px-4 py-2 text-sm text-red-600 transition duration-200 border border-red-300 rounded-md hover:bg-red-50"}," ปฏิเสธ ",8,Lt)],64)):e.status==="confirmed"?(l(),i("button",St," แชทกับผู้โดยสาร ")):["rejected","cancelled"].includes(e.status)?(l(),i("button",{key:2,onClick:L(o=>ae(e,"delete"),["stop"]),class:"px-4 py-2 text-sm text-gray-600 transition duration-200 border border-gray-300 rounded-md hover:bg-gray-50"}," ลบรายการ ",8,Ft)):f("",!0)],2)],8,Vs))),128))]))])]),s("div",jt,[s("div",Bt,[s("div",Ot,[t[31]||(t[31]=s("h3",{class:"text-lg font-semibold text-gray-900"},"แผนที่เส้นทาง",-1)),s("p",Dt,r(le.value?le.value:"คลิกที่รายการเพื่อดูเส้นทาง"),1)]),s("div",{ref_key:"mapContainer",ref:Q,id:"map"},null,512)])])])]),Be(Ve,{show:te.value,title:E.value.title,message:E.value.message,confirmText:E.value.confirmText,variant:E.value.variant,onConfirm:Te,onCancel:oe},null,8,["show","title","message","confirmText","variant"])]))}},Jt=Re(Vt,[["__scopeId","data-v-a87013ba"]]);export{Jt as default};
