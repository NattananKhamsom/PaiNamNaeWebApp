import{_ as U}from"./Lcixqshc.js";import{K as D,a5 as V,r as _,i as Y,H as j,y as B,J as z,c,o as m,b as o,a as t,w as d,n as O,d as l,t as r,g as k,l as f,P as E,s as G}from"./DPSIKoxe.js";import{u as J}from"./BaxiziUg.js";import{A as q,_ as F}from"./CaCOxDSn.js";import{d as R}from"./B5yDJBm8.js";import"./DOK8vhV6.js";import"./Cpj98o6Y.js";const K={id:"main-content",class:"main-content mt-16 ml-0 lg:ml-[280px] p-6"},W={class:"mb-8"},Q={class:"mx-auto max-w-8xl"},X={class:"mb-6 bg-white border border-gray-300 rounded-lg shadow-sm"},Z={class:"flex flex-wrap items-center gap-3 px-4 py-4 sm:px-6"},ee={class:"flex gap-2 ml-auto"},te=["disabled"],se={key:0,class:"mr-1 fa-solid fa-spinner fa-spin"},ae=["disabled"],le={key:0,class:"mr-1 fa-solid fa-spinner fa-spin"},oe=["disabled"],ne={key:0,class:"mr-1 fa-solid fa-spinner fa-spin"},ie={class:"bg-white border border-gray-300 rounded-lg shadow-sm"},re={key:0,class:"p-8 text-center text-gray-500"},de={key:1,class:"p-8 text-center text-red-600"},ue={key:2,class:"grid grid-cols-1 gap-6 p-4 sm:p-6 text-[15px]"},ce={class:"w-full max-w-[80rem] mx-auto space-y-6"},me={class:"grid grid-cols-1 gap-4 sm:grid-cols-3"},fe={class:"grid grid-cols-1 gap-4 sm:grid-cols-3"},ve={class:"grid grid-cols-1 gap-6 sm:grid-cols-2"},pe={key:0,class:"photo-box"},be=["href"],ge=["src"],_e={key:1,class:"photo-box empty"},xe={key:0,class:"photo-box"},ye=["href"],he=["src"],we={key:1,class:"photo-box empty"},ke={class:"grid grid-cols-1 gap-4 sm:grid-cols-3"},Ee={key:3,class:"p-8 text-center text-gray-500"},ze=D({__name:"index",setup(Re){R.locale("th"),J({});const u=D({name:"InfoBox",props:{label:{type:String,required:!0}},setup(a,{slots:e}){return()=>E("div",{},[E("div",{class:"block mb-1 text-xs font-medium text-gray-600"},a.label),E("div",{class:"w-full px-3 py-2.5 border border-gray-300 rounded-md bg-gray-50 text-gray-900"},e.default?e.default():"")])}}),{toast:P}=G(),A=V().params.id,h=_(!0),x=_(""),s=_(null),v=_(!1),g=_("");Y(async()=>{$(),typeof window.__adminResizeHandler__=="function"&&window.__adminResizeHandler__(),await H()}),j(()=>M());async function H(){var a;h.value=!0,x.value="";try{const e=B(),n=z("token").value||localStorage.getItem("token"),p=await $fetch(`/driver-verifications/admin/${A}`,{baseURL:e.public.apiBase,headers:{Accept:"application/json",...n?{Authorization:`Bearer ${n}`}:{}}});s.value=p.data??null}catch(e){console.error(e),x.value=((a=e==null?void 0:e.data)==null?void 0:a.message)||"ไม่สามารถโหลดข้อมูลได้"}finally{h.value=!1}}function y(a,e=!1){return a?e?R(a).format("D MMM YYYY HH:mm"):R(a).format("D MMM YYYY"):"-"}function C(a){return a?a.toLowerCase():"-"}function T(a){return a?{PRIVATE_CAR_TEMPORARY:"รถยนต์ส่วนบุคคลชั่วคราว (2 ปี)",PRIVATE_CAR:"รถยนต์ส่วนบุคคล (5 ปี)",PUBLIC_CAR:"รถยนต์สาธารณะ",LIFETIME:"ตลอดชีพ"}[a]||a:"-"}async function w(a){var e;if(s.value){v.value=!0,g.value=a;try{const n=B(),p=z("token").value||localStorage.getItem("token"),b=await $fetch(`/driver-verifications/${A}/status`,{baseURL:n.public.apiBase,method:"PATCH",headers:{Accept:"application/json","Content-Type":"application/json",...p?{Authorization:`Bearer ${p}`}:{}},body:{status:a}});b.data&&s.value?s.value={...s.value,status:b.data.status,updatedAt:b.data.updatedAt??s.value.updatedAt}:s.value&&(s.value.status=a),P.success("อัปเดตสถานะสำเร็จ",`สถานะใหม่: ${C(a)}`)}catch(n){console.error(n),P.error("เกิดข้อผิดพลาด",((e=n==null?void 0:n.data)==null?void 0:e.message)||"อัปเดตสถานะไม่สำเร็จ")}finally{v.value=!1,g.value=""}}}function S(){const a=document.getElementById("sidebar"),e=document.getElementById("overlay");!a||!e||(a.classList.remove("mobile-open"),e.classList.add("hidden"))}function $(){window.__adminResizeHandler__=function(){const a=document.getElementById("sidebar"),e=document.getElementById("main-content"),n=document.getElementById("overlay");!a||!e||!n||(window.innerWidth>=1024?(a.classList.remove("mobile-open"),n.classList.add("hidden"),e.style.marginLeft=a.classList.contains("collapsed")?"80px":"280px"):e.style.marginLeft="0")},window.addEventListener("resize",window.__adminResizeHandler__)}function M(){window.removeEventListener("resize",window.__adminResizeHandler__||(()=>{})),delete window.__adminResizeHandler__}return(a,e)=>{var p,b,L,I;const n=U;return m(),c("div",null,[o(q),o(F),t("main",K,[t("div",W,[o(n,{to:"/admin/driver-verifications",class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md hover:bg-gray-50"},{default:d(()=>e[3]||(e[3]=[t("i",{class:"fa-solid fa-arrow-left"},null,-1),t("span",null,"ย้อนกลับ",-1)])),_:1,__:[3]})]),t("div",Q,[e[15]||(e[15]=t("div",{class:"flex flex-col gap-3 mb-6 sm:flex-row sm:items-center sm:justify-between"},[t("div",{class:"flex items-center gap-3"},[t("h1",{class:"text-2xl font-semibold text-gray-800"},"รายละเอียดการยืนยันตัวตนผู้ขับขี่"),t("span",{class:"text-sm text-gray-500"},"ดูข้อมูลคำขอและเปลี่ยนสถานะได้จากหน้านี้")])],-1)),t("div",X,[t("div",Z,[e[8]||(e[8]=t("div",{class:"text-sm text-gray-700"},"สถานะปัจจุบัน:",-1)),t("span",{class:O(["inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full",{"bg-amber-100 text-amber-700":((p=s.value)==null?void 0:p.status)==="PENDING","bg-green-100 text-green-700":((b=s.value)==null?void 0:b.status)==="APPROVED","bg-red-100 text-red-700":((L=s.value)==null?void 0:L.status)==="REJECTED"}])},[e[4]||(e[4]=t("i",{class:"fa-solid fa-circle mr-1 text-[8px]"},null,-1)),l(r(C((I=s.value)==null?void 0:I.status)),1)],2),t("div",ee,[t("button",{class:"px-3 py-2 border rounded-md hover:bg-gray-50 disabled:opacity-50",disabled:v.value||!s.value,onClick:e[0]||(e[0]=i=>w("PENDING"))},[v.value&&g.value==="PENDING"?(m(),c("i",se)):k("",!0),e[5]||(e[5]=l(" pending "))],8,te),t("button",{class:"px-3 py-2 text-green-700 border border-green-300 rounded-md hover:bg-gray-50 disabled:opacity-50",disabled:v.value||!s.value,onClick:e[1]||(e[1]=i=>w("APPROVED"))},[v.value&&g.value==="APPROVED"?(m(),c("i",le)):k("",!0),e[6]||(e[6]=l(" approve "))],8,ae),t("button",{class:"px-3 py-2 text-red-700 border border-red-300 rounded-md hover:bg-gray-50 disabled:opacity-50",disabled:v.value||!s.value,onClick:e[2]||(e[2]=i=>w("REJECTED"))},[v.value&&g.value==="REJECTED"?(m(),c("i",ne)):k("",!0),e[7]||(e[7]=l(" reject "))],8,oe)])])]),t("div",ie,[h.value?(m(),c("div",re,"กำลังโหลดข้อมูล...")):x.value?(m(),c("div",de,r(x.value),1)):s.value?(m(),c("div",ue,[t("div",ce,[t("section",null,[e[9]||(e[9]=t("h3",{class:"mb-3 text-sm font-semibold text-gray-700"},"ข้อมูลผู้ใช้",-1)),t("div",me,[o(f(u),{label:"ชื่อ-นามสกุล"},{default:d(()=>{var i,N;return[l(r((((i=s.value.user)==null?void 0:i.firstName)||"-")+" "+(((N=s.value.user)==null?void 0:N.lastName)||"")),1)]}),_:1}),o(f(u),{label:"อีเมล"},{default:d(()=>{var i;return[l(r(((i=s.value.user)==null?void 0:i.email)||"-"),1)]}),_:1}),o(f(u),{label:"ชื่อผู้ใช้ (username)"},{default:d(()=>{var i;return[l(r(((i=s.value.user)==null?void 0:i.username)||"-"),1)]}),_:1}),o(f(u),{label:"เบอร์โทรศัพท์"},{default:d(()=>{var i;return[l(r(((i=s.value.user)==null?void 0:i.phoneNumber)||"-"),1)]}),_:1})])]),t("section",null,[e[10]||(e[10]=t("h3",{class:"mb-3 text-sm font-semibold text-gray-700"},"ข้อมูลบนใบขับขี่",-1)),t("div",fe,[o(f(u),{label:"เลขที่ใบขับขี่"},{default:d(()=>[l(r(s.value.licenseNumber||"-"),1)]),_:1}),o(f(u),{label:"ชื่อ (บนใบขับขี่)"},{default:d(()=>[l(r(s.value.firstNameOnLicense||"-"),1)]),_:1}),o(f(u),{label:"นามสกุล (บนใบขับขี่)"},{default:d(()=>[l(r(s.value.lastNameOnLicense||"-"),1)]),_:1}),o(f(u),{label:"ประเภทบนใบขับขี่"},{default:d(()=>[l(r(T(s.value.typeOnLicense)),1)]),_:1}),o(f(u),{label:"วันออกบัตร"},{default:d(()=>[l(r(y(s.value.licenseIssueDate)),1)]),_:1}),o(f(u),{label:"วันหมดอายุ"},{default:d(()=>[l(r(y(s.value.licenseExpiryDate)),1)]),_:1})])]),t("section",null,[e[13]||(e[13]=t("h3",{class:"mb-3 text-sm font-semibold text-gray-700"},"รูปถ่ายประกอบ",-1)),t("div",ve,[t("div",null,[e[11]||(e[11]=t("label",{class:"block mb-1 text-xs font-medium text-gray-600"},"รูปบัตรขับขี่ (ด้านหน้า)",-1)),s.value.licensePhotoUrl?(m(),c("div",pe,[t("a",{href:s.value.licensePhotoUrl,target:"_blank",class:"block w-full h-full"},[t("img",{src:s.value.licensePhotoUrl,alt:"license",class:"object-contain w-full h-full"},null,8,ge)],8,be)])):(m(),c("div",_e,"ไม่มีรูป"))]),t("div",null,[e[12]||(e[12]=t("label",{class:"block mb-1 text-xs font-medium text-gray-600"},"รูปถ่ายพร้อมใบขับขี่ (Selfie)",-1)),s.value.selfiePhotoUrl?(m(),c("div",xe,[t("a",{href:s.value.selfiePhotoUrl,target:"_blank",class:"block w-full h-full"},[t("img",{src:s.value.selfiePhotoUrl,alt:"selfie",class:"object-contain w-full h-full"},null,8,he)],8,ye)])):(m(),c("div",we,"ไม่มีรูป"))])])]),t("section",null,[e[14]||(e[14]=t("h3",{class:"mb-3 text-sm font-semibold text-gray-700"},"ระบบ",-1)),t("div",ke,[o(f(u),{label:"สร้างเมื่อ"},{default:d(()=>[l(r(y(s.value.createdAt,!0)),1)]),_:1}),o(f(u),{label:"อัปเดตล่าสุด"},{default:d(()=>[l(r(y(s.value.updatedAt,!0)),1)]),_:1})])])])])):(m(),c("div",Ee,"ไม่พบข้อมูล"))])])]),t("div",{id:"overlay",class:"fixed inset-0 z-40 hidden bg-black bg-opacity-50 lg:hidden",onClick:S})])}}});export{ze as default};
