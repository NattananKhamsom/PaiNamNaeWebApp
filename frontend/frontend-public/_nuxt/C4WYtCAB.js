import{_ as V,m as T,r as g,A as h,i as k,c as u,a as t,f as I,b as C,h as o,d,v as a,z as F,F as U,q,t as v,s as D,o as m,C as w}from"./DPSIKoxe.js";import{V as M}from"./CGg3eoUs.js";const N={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},$={class:"bg-white rounded-lg shadow-md p-8"},B={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},L={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},A={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-6 items-center"},E=["value"],O={class:"self-end"},j={key:1,class:"bg-white rounded-xl shadow-xl p-8 border border-gray-300"},z={class:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 bg-[#F2F2F2] p-4 md:px-6 md:py-6 rounded-[8px]"},R={class:"pt-6 flex justify-end gap-4"},G=["disabled"],H={__name:"index_v1",setup(J){const{$api:f}=T(),{toast:i}=D(),b=g(!1),n=g(!1),x=g([]),l=h({vehicleId:"",startPoint:"",endPoint:"",date:"",time:"",availableSeats:null,pricePerSeat:null,conditions:""}),c=async()=>{try{const s=await f("/vehicles");if(x.value=s,s.length>0){const e=s.find(r=>r.isDefault)||s[0];l.vehicleId=e.id}}catch(s){console.error("Failed to fetch vehicles:",s),showErrorToast&&i.error("เกิดข้อผิดพลาด","ไม่สามารถโหลดข้อมูลรถยนต์ได้")}},P=async()=>{b.value=!1,await c()},S=async()=>{var r,y;if(n.value)return;if(!l.vehicleId||!l.date||!l.time||!l.availableSeats||!l.pricePerSeat){i.error("ข้อมูลไม่ครบถ้วน","กรุณากรอกข้อมูลที่มีเครื่องหมาย * ให้ครบถ้วน");return}n.value=!0;const s=new Date(`${l.date}T${l.time}`).toISOString(),e={vehicleId:l.vehicleId,startLocation:{lat:16.3888,lng:102.8285},endLocation:{lat:13.7563,lng:100.5018},departureTime:s,availableSeats:Number(l.availableSeats),pricePerSeat:Number(l.pricePerSeat),conditions:l.conditions};try{await f("/routes",{method:"POST",body:e}),i.success("สำเร็จ","สร้างเส้นทางการเดินทางเรียบร้อยแล้ว!"),setTimeout(()=>{w("/findTrip")},1500)}catch(p){console.error("Failed to create route:",p),p.statusCode===403&&((r=p.data)!=null&&r.message.includes("ยืนยันตัวตนผู้ขับ"))?(i.error("จำเป็นต้องยืนยันตัวตน","คุณต้องยืนยันตัวตนผู้ขับก่อนจึงจะสร้างเส้นทางได้"),setTimeout(()=>{w("/profile/driver-verification")},2e3)):i.error("เกิดข้อผิดพลาด",((y=p.data)==null?void 0:y.message)||"ไม่สามารถสร้างเส้นทางได้")}finally{n.value=!1}};return k(()=>{c()}),(s,e)=>(m(),u("div",null,[t("div",N,[e[25]||(e[25]=t("div",{class:"mb-8"},[t("h2",{class:"text-3xl font-bold text-gray-900 mb-2"}," สร้างการเดินทางของคุณ "),t("p",{class:"text-gray-600"}," กำหนดจุดเริ่มต้น ปลายทาง และรายละเอียดต่างๆ เพื่อให้ผู้โดยสารมาร่วมทาง ")],-1)),t("div",$,[t("form",{onSubmit:I(S,["prevent"]),id:"postRouteForm",novalidate:"",class:"space-y-8"},[t("div",null,[e[12]||(e[12]=t("h3",{class:"text-xl font-semibold text-gray-900 mb-6 pb-2 border-b border-gray-200"}," ข้อมูลเส้นทาง ",-1)),t("div",B,[t("div",null,[e[10]||(e[10]=t("label",{for:"startPoint",class:"block text-sm font-medium text-gray-700 mb-2"},[d(" จุดเริ่มต้น "),t("span",{class:"text-red-500"},"*")],-1)),o(t("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>l.startPoint=r),id:"startPoint",name:"startPoint",type:"text",placeholder:"เช่น กรุงเทพมหานคร, ถนนสุขุมวิท",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-blue-500"},null,512),[[a,l.startPoint]])]),t("div",null,[e[11]||(e[11]=t("label",{for:"endPoint",class:"block text-sm font-medium text-gray-700 mb-2"},[d(" จุดปลายทาง "),t("span",{class:"text-red-500"},"*")],-1)),o(t("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>l.endPoint=r),id:"endPoint",name:"endPoint",type:"text",placeholder:"เช่น เชียงใหม่, ถนนนิมมานเหมินท์",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-blue-500"},null,512),[[a,l.endPoint]])])])]),t("div",null,[e[18]||(e[18]=t("h3",{class:"text-xl font-semibold text-gray-900 mb-6 pb-2 border-b border-gray-200"}," รายละเอียดการเดินทาง ",-1)),t("div",L,[t("div",null,[e[13]||(e[13]=t("label",{for:"travelDate",class:"block text-sm font-medium text-gray-700 mb-2"},[d(" วันที่เดินทาง "),t("span",{class:"text-red-500"},"*")],-1)),o(t("input",{"onUpdate:modelValue":e[2]||(e[2]=r=>l.date=r),id:"travelDate",name:"travelDate",type:"date",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-blue-500"},null,512),[[a,l.date]])]),t("div",null,[e[14]||(e[14]=t("label",{for:"travelTime",class:"block text-sm font-medium text-gray-700 mb-2"},[d(" เวลาออกเดินทาง "),t("span",{class:"text-red-500"},"*")],-1)),o(t("input",{"onUpdate:modelValue":e[3]||(e[3]=r=>l.time=r),id:"travelTime",name:"travelTime",type:"time",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-blue-500"},null,512),[[a,l.time]])]),t("div",null,[e[15]||(e[15]=t("label",{for:"seatCount",class:"block text-sm font-medium text-gray-700 mb-2"},[d(" จำนวนที่นั่งที่รับได้ "),t("span",{class:"text-red-500"},"*")],-1)),o(t("input",{"onUpdate:modelValue":e[4]||(e[4]=r=>l.availableSeats=r),id:"seatCount",name:"seatCount",type:"number",min:"1",placeholder:"กรอกจำนวนที่นั่ง (เช่น 4)",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-blue-500"},null,512),[[a,l.availableSeats,void 0,{number:!0}]]),e[16]||(e[16]=t("p",{class:"text-xs text-gray-500 mt-1"}," รถยนต์ส่วนบุคคลทั่วไปมี 4–5 ที่นั่ง หากใช้รถตู้/รถบัส ให้ระบุจำนวนได้ตามจริง ",-1))]),t("div",null,[e[17]||(e[17]=t("label",{for:"pricePerSeat",class:"block text-sm font-medium text-gray-700 mb-2"},[d(" ราคาต่อที่นั่ง (บาท) "),t("span",{class:"text-red-500"},"*")],-1)),o(t("input",{"onUpdate:modelValue":e[5]||(e[5]=r=>l.pricePerSeat=r),id:"pricePerSeat",name:"pricePerSeat",type:"number",min:"0",placeholder:"เช่น 250",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-blue-500"},null,512),[[a,l.pricePerSeat,void 0,{number:!0}]])])])]),t("div",null,[e[22]||(e[22]=t("h3",{class:"text-xl font-semibold text-gray-900 mb-6 pb-2 border-b border-gray-200"}," ข้อมูลรถยนต์ ",-1)),x.value.length>0?(m(),u("div",A,[t("div",null,[e[20]||(e[20]=t("label",{for:"vehicle",class:"block text-sm font-medium text-gray-700 mb-2"},[d(" เลือกรถยนต์ที่จะใช้ "),t("span",{class:"text-red-500"},"*")],-1)),o(t("select",{"onUpdate:modelValue":e[6]||(e[6]=r=>l.vehicleId=r),id:"vehicle",name:"vehicle",class:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-blue-500"},[e[19]||(e[19]=t("option",{disabled:"",value:""},"กรุณาเลือกรถยนต์",-1)),(m(!0),u(U,null,q(x.value,r=>(m(),u("option",{key:r.id,value:r.id},v(r.vehicleModel)+" ("+v(r.licensePlate)+") ",9,E))),128))],512),[[F,l.vehicleId]])]),t("div",O,[t("button",{type:"button",onClick:e[7]||(e[7]=r=>b.value=!0),class:"w-full md:w-auto bg-gray-100 hover:bg-gray-200 text-gray-800 text-sm px-4 py-3 rounded-md transition-colors"}," เพิ่ม / จัดการข้อมูลรถยนต์ ")])])):(m(),u("div",j,[t("div",z,[e[21]||(e[21]=t("p",{class:"text-gray-800 text-base md:text-[18px] text-center sm:text-left"}," คุณยังไม่มีข้อมูลรถยนต์ ",-1)),t("button",{type:"button",onClick:e[8]||(e[8]=r=>b.value=!0),class:"bg-[#2563EB] hover:bg-blue-600 text-white text-sm md:text-[16px] px-4 py-2 rounded-lg transition-colors whitespace-nowrap"}," เพิ่ม / จัดการข้อมูล ")])]))]),C(M,{show:b.value,onClose:P},null,8,["show"]),t("div",null,[e[23]||(e[23]=t("h3",{class:"text-xl font-semibold text-gray-900 mb-6 pb-2 border-b border-gray-200"}," เงื่อนไขและข้อตกลง ",-1)),o(t("textarea",{"onUpdate:modelValue":e[9]||(e[9]=r=>l.conditions=r),id:"terms",name:"terms",rows:"4",placeholder:"ระบุเงื่อนไข เช่น ไม่สูบบุหรี่, ไม่นำสัตว์เลี้ยง, ชำระเงินล่วงหน้า 50%",class:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-blue-500 resize-none"},null,512),[[a,l.conditions]])]),t("div",R,[e[24]||(e[24]=t("button",{type:"button",class:"px-6 py-3 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500"}," ยกเลิก ",-1)),t("button",{type:"submit",disabled:n.value,class:"px-6 py-3 bg-blue-600 text-white rounded-md font-medium hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-400 disabled:cursor-not-allowed"},v(n.value?"กำลังสร้าง...":"สร้างการเดินทาง"),9,G)])],32)])])]))}},W=V(H,[["__scopeId","data-v-061069d5"]]);export{W as default};
