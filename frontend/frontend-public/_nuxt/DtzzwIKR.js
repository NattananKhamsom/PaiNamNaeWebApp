import{_ as Oe}from"./Lcixqshc.js";import{_ as Fe,a5 as He,J as Ye,A as he,r as b,x as _e,p as ke,i as qe,y as Ke,c as g,b as Y,a as n,w as Ce,l as Ge,f as Te,h as u,g as M,v as c,F as Z,q as ee,z as We,d as $e,t as v,T as Je,B as Se,s as Qe,C as Ve,o as f}from"./DPSIKoxe.js";import{u as Xe}from"./BaxiziUg.js";import{A as Ze,_ as et}from"./CaCOxDSn.js";import{d as te}from"./B5yDJBm8.js";import{b as tt}from"./C5FTVxxA.js";import"./DOK8vhV6.js";import"./Cpj98o6Y.js";const nt={id:"main-content",class:"main-content mt-16 ml-0 lg:ml-[280px] p-6 min-h-screen"},ot={class:"mx-auto max-w-7xl"},at={class:"mb-8"},lt={class:"flex w-full overflow-hidden bg-white border border-gray-300 rounded-lg shadow-lg"},st={class:"flex-1 p-6 sm:p-8"},rt={class:"space-y-4"},dt={class:"relative"},it=["disabled","readonly"],ut={key:0,class:"absolute z-20 w-full mt-1 overflow-auto bg-white border rounded-md shadow max-h-60"},ct=["onClick"],mt={class:"text-sm font-medium text-gray-800"},pt={key:0,class:"text-xs text-gray-500"},gt={class:"text-xs text-gray-500"},ft={key:0,class:"px-3 py-2 text-sm text-gray-500"},bt=["disabled"],yt=["value"],vt={key:0,class:"mt-2 text-sm text-gray-500"},xt={class:"space-y-6"},wt={class:"overflow-hidden border border-gray-300 rounded-lg"},Lt={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},ht={class:"space-y-2"},_t={class:"grid grid-cols-2 gap-2"},kt={class:"space-y-2"},Ct={class:"grid grid-cols-2 gap-2"},Tt={class:"space-y-4"},$t={class:"grid grid-cols-1 gap-2 sm:grid-cols-2"},St=["onUpdate:modelValue"],Vt=["onUpdate:modelValue"],Ut=["onUpdate:modelValue"],Mt=["onUpdate:modelValue"],At={class:"flex gap-2 mt-2"},It=["onClick"],Pt=["onClick"],Bt={class:"grid grid-cols-1 gap-4 sm:grid-cols-3"},Nt={class:"sm:col-span-1"},Rt={class:"flex justify-end gap-4 pt-4"},zt=["disabled"],Et=["disabled"],Dt={key:0,class:"w-5 h-5 mr-3 -ml-1 text-white animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},jt={class:"bg-white rounded-xl w-[95%] max-w-3xl overflow-hidden shadow-xl"},Ot={class:"p-4 border-b"},Ft={class:"font-semibold text-gray-800"},Ht={class:"p-0"},Yt={class:"flex items-center justify-between p-4 border-t"},qt={class:"text-sm text-gray-700 truncate"},Kt={class:"truncate"},Gt=["disabled"],ne="__gmapsReadyAdminRouteEdit__",Wt={__name:"edit",setup(Jt){var fe;te.locale("th"),te.extend(tt),Xe({});const{toast:O}=Qe(),A=He(),I=Ke(),L=((fe=Ye("token"))==null?void 0:fe.value)||localStorage.getItem("token"),t=he({driverId:"",vehicleId:"",startLocation:{lat:null,lng:null,name:"",address:""},endLocation:{lat:null,lng:null,name:"",address:""},waypoints:[],availableSeats:0,pricePerSeat:0,conditions:"",departureTimeISO:""}),P=b(""),oe=_e(()=>{const o=t.startLocation,e=t.endLocation;return t.driverId&&t.vehicleId&&o.lat!=null&&o.lng!=null&&e.lat!=null&&e.lng!=null&&P.value}),$=b(!0),S=b(""),ae=b(""),T=b([]),F=b(!1),Ue=_e(()=>!$.value&&S.value&&(F.value||T.value.length>0));let le=null;async function Me(){if($.value)return;clearTimeout(le);const o=S.value.trim();if(!o){T.value=[];return}le=setTimeout(async()=>{try{F.value=!0;const e=await $fetch("/users/admin",{baseURL:I.public.apiBase,headers:{Accept:"application/json",...L?{Authorization:`Bearer ${L}`}:{}},query:{q:o,page:1,limit:10}});T.value=(e==null?void 0:e.data)||[]}catch(e){console.error("search drivers error:",e),T.value=[]}finally{F.value=!1}},300)}function Ae(o){if($.value)return;t.driverId=o.id;const e=`${o.firstName||""} ${o.lastName||""} (${o.email})`;S.value=e,ae.value=e,T.value=[],se(o.id)}const V=b([]);async function se(o){try{if(V.value=[],!o)return;const e=await $fetch(`/vehicles/admin/user/${o}`,{baseURL:I.public.apiBase,headers:{Accept:"application/json",...L?{Authorization:`Bearer ${L}`}:{}}});V.value=(e==null?void 0:e.data)||[]}catch(e){console.error("vehicles error:",e),V.value=[]}}const q=b(null),K=b(null),G=b(null);let h=null,re=!1,B=null,N=null,R=null,W=null,J=null,m=!1;function Q(){var o,e,l,a;!q.value||h||(h=new google.maps.Map(q.value,{center:{lat:13.7563,lng:100.5018},zoom:6,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!0}),R=new google.maps.Geocoder,(e=(o=window.google)==null?void 0:o.maps)!=null&&e.places&&K.value&&(W=new google.maps.places.Autocomplete(K.value,{fields:["name","formatted_address","geometry"]}),W.addListener("place_changed",()=>{var d;const r=W.getPlace();r&&(d=r.geometry)!=null&&d.location&&(m=!0,t.startLocation.lat=r.geometry.location.lat(),t.startLocation.lng=r.geometry.location.lng(),t.startLocation.name=r.name||r.formatted_address||"",t.startLocation.address=r.formatted_address||"",m=!1,x())})),(a=(l=window.google)==null?void 0:l.maps)!=null&&a.places&&G.value&&(J=new google.maps.places.Autocomplete(G.value,{fields:["name","formatted_address","geometry"]}),J.addListener("place_changed",()=>{var d;const r=J.getPlace();r&&(d=r.geometry)!=null&&d.location&&(m=!0,t.endLocation.lat=r.geometry.location.lat(),t.endLocation.lng=r.geometry.location.lng(),t.endLocation.name=r.name||r.formatted_address||"",t.endLocation.address=r.formatted_address||"",m=!1,x())})),re=!0,setTimeout(()=>google.maps.event.trigger(h,"resize"),0))}function Ie(){B&&(B.setMap(null),B=null),N&&(N.setMap(null),N=null)}function x(){if(!re)return;Ie();const o=new google.maps.LatLngBounds;y(t.startLocation.lat)&&y(t.startLocation.lng)&&(B=new google.maps.Marker({map:h,position:{lat:+t.startLocation.lat,lng:+t.startLocation.lng},label:"A"}),o.extend(B.getPosition())),y(t.endLocation.lat)&&y(t.endLocation.lng)&&(N=new google.maps.Marker({map:h,position:{lat:+t.endLocation.lat,lng:+t.endLocation.lng},label:"B"}),o.extend(N.getPosition())),o.isEmpty()||(h.fitBounds(o),setTimeout(()=>{google.maps.event.trigger(h,"resize"),h.fitBounds(o)},0))}function y(o){return typeof o=="number"&&!Number.isNaN(o)}function z(o,e){return new Promise(l=>{if(!R||o==null||e==null)return l({name:"",address:""});R.geocode({location:{lat:+o,lng:+e}},(a,r)=>{var d,_;if(r==="OK"&&(a!=null&&a.length)){const p=a[0];l({name:((_=(d=p==null?void 0:p.address_components)==null?void 0:d[0])==null?void 0:_.long_name)||(p==null?void 0:p.formatted_address)||"",address:(p==null?void 0:p.formatted_address)||""})}else l({name:"",address:""})})})}function de(o){return new Promise(e=>{if(!R||!o)return e(null);R.geocode({address:o},(l,a)=>{var r,d,_,p,D,j;if(a==="OK"&&(l!=null&&l.length)){const k=l[0];e({name:((d=(r=k.address_components)==null?void 0:r[0])==null?void 0:d.long_name)||k.formatted_address||o,address:k.formatted_address||o,lat:(p=(_=k.geometry)==null?void 0:_.location)==null?void 0:p.lat(),lng:(j=(D=k.geometry)==null?void 0:D.location)==null?void 0:j.lng()})}else e(null)})})}async function ie(o){const e=o==="start"?t.startLocation.name:t.endLocation.name,l=await de(e);l&&(m=!0,o==="start"?(t.startLocation.name=l.name,t.startLocation.address=l.address,l.lat!=null&&l.lng!=null&&(t.startLocation.lat=l.lat,t.startLocation.lng=l.lng)):(t.endLocation.name=l.name,t.endLocation.address=l.address,l.lat!=null&&l.lng!=null&&(t.endLocation.lat=l.lat,t.endLocation.lng=l.lng)),m=!1,x())}async function ue(o){const e=o==="start"?t.startLocation.address:t.endLocation.address,l=await de(e);l&&(m=!0,o==="start"?(t.startLocation.name=l.name,t.startLocation.address=l.address,l.lat!=null&&l.lng!=null&&(t.startLocation.lat=l.lat,t.startLocation.lng=l.lng)):(t.endLocation.name=l.name,t.endLocation.address=l.address,l.lat!=null&&l.lng!=null&&(t.endLocation.lat=l.lat,t.endLocation.lng=l.lng)),m=!1,x())}let ce=null,me=null;ke(()=>[t.startLocation.lat,t.startLocation.lng],async([o,e])=>{m||(clearTimeout(ce),ce=setTimeout(async()=>{if(y(o)&&y(e)){const l=await z(o,e);l.address&&(m=!0,t.startLocation.name=l.name,t.startLocation.address=l.address,m=!1),x()}},350))}),ke(()=>[t.endLocation.lat,t.endLocation.lng],async([o,e])=>{m||(clearTimeout(me),me=setTimeout(async()=>{if(y(o)&&y(e)){const l=await z(o,e);l.address&&(m=!0,t.endLocation.name=l.name,t.endLocation.address=l.address,m=!1),x()}},350))});const s=he({show:!1,mode:null,index:null,lat:null,lng:null}),pe=b(null);let H=null,E=null;function X(o,e=null){s.show=!0,s.mode=o,s.index=e,s.lat=null,s.lng=null,Se(()=>{const l={lat:13.7563,lng:100.5018},a=o==="start"?t.startLocation:o==="end"?t.endLocation:t.waypoints[e]||{},r=y(a.lat)&&y(a.lng)?{lat:+a.lat,lng:+a.lng}:l;H=new google.maps.Map(pe.value,{center:r,zoom:y(a.lat)?15:6,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1}),H.addListener("click",d=>{Pe(d.latLng),s.lat=d.latLng.lat(),s.lng=d.latLng.lng()})})}function Pe(o){if(E)return E.setPosition(o);E=new google.maps.Marker({map:H,position:o,draggable:!0}),E.addListener("dragend",e=>{s.lat=e.latLng.lat(),s.lng=e.latLng.lng()})}function ge(){s.show=!1,s.mode=null,s.index=null,E=null,H=null}async function Be(){if(!(s.lat==null||s.lng==null)){if(m=!0,s.mode==="start"){t.startLocation.lat=s.lat,t.startLocation.lng=s.lng;const o=await z(s.lat,s.lng);t.startLocation.name=o.name,t.startLocation.address=o.address}else if(s.mode==="end"){t.endLocation.lat=s.lat,t.endLocation.lng=s.lng;const o=await z(s.lat,s.lng);t.endLocation.name=o.name,t.endLocation.address=o.address}else if(s.mode==="waypoint"&&s.index!=null){const o=t.waypoints[s.index];if(o){o.lat=s.lat,o.lng=s.lng;const e=await z(s.lat,s.lng);o.name=e.name,o.address=e.address}}m=!1,ge(),x()}}function Ne(){t.waypoints.push({lat:null,lng:null,name:"",address:""})}function Re(o){t.waypoints.splice(o,1),x()}async function ze(){var o,e,l,a,r,d,_,p,D,j,k,be,ye,ve,xe,we;try{const C=await $fetch(`/routes/admin/${A.params.id}`,{baseURL:I.public.apiBase,headers:{Accept:"application/json",...L?{Authorization:`Bearer ${L}`}:{}}}),i=C==null?void 0:C.data;if(!i)throw new Error("Invalid response");t.driverId=((o=i.driver)==null?void 0:o.id)||"",t.vehicleId=((e=i.vehicle)==null?void 0:e.id)||"",t.startLocation={lat:((l=i.startLocation)==null?void 0:l.lat)??null,lng:((a=i.startLocation)==null?void 0:a.lng)??null,name:((r=i.startLocation)==null?void 0:r.name)||"",address:((d=i.startLocation)==null?void 0:d.address)||""},t.endLocation={lat:((_=i.endLocation)==null?void 0:_.lat)??null,lng:((p=i.endLocation)==null?void 0:p.lng)??null,name:((D=i.endLocation)==null?void 0:D.name)||"",address:((j=i.endLocation)==null?void 0:j.address)||""},t.waypoints=Array.isArray((k=i.waypoints)==null?void 0:k.used)?i.waypoints.used.map(w=>({lat:w.lat??null,lng:w.lng??null,name:w.name||"",address:w.address||""})):Array.isArray(i.waypoints)?i.waypoints.map(w=>({lat:w.lat??null,lng:w.lng??null,name:w.name||"",address:w.address||""})):[],t.availableSeats=i.availableSeats??0,t.pricePerSeat=i.pricePerSeat??0,t.conditions=i.conditions||"",t.departureTimeISO=i.departureTime||"",P.value=i.departureTime?te(i.departureTime).format("YYYY-MM-DDTHH:mm"):"";const Le=`${((be=i.driver)==null?void 0:be.firstName)||""} ${((ye=i.driver)==null?void 0:ye.lastName)||""} (${((ve=i.driver)==null?void 0:ve.email)||""})`.trim();S.value=Le,ae.value=Le,t.driverId&&await se(t.driverId),(xe=window.google)!=null&&xe.maps&&(Q(),Se(x))}catch(C){console.error("fetch route error:",C),O.error("เกิดข้อผิดพลาด",((we=C==null?void 0:C.data)==null?void 0:we.message)||"โหลดข้อมูลเส้นทางไม่สำเร็จ")}}const U=b(!1);async function Ee(){var o;if(!oe.value){O.warning("ข้อมูลไม่ครบ","กรุณากรอกข้อมูลให้ครบถ้วน");return}U.value=!0;try{const e={driverId:t.driverId,vehicleId:t.vehicleId,startLocation:{...t.startLocation},endLocation:{...t.endLocation},waypoints:t.waypoints.map(l=>({lat:+l.lat,lng:+l.lng,name:l.name||"",address:l.address||""})),departureTime:new Date(P.value).toISOString(),availableSeats:+t.availableSeats,pricePerSeat:+t.pricePerSeat,conditions:t.conditions||""};await $fetch(`/routes/admin/${A.params.id}`,{baseURL:I.public.apiBase,method:"PUT",headers:{"Content-Type":"application/json",...L?{Authorization:`Bearer ${L}`}:{}},body:e}),O.success("บันทึกสำเร็จ","อัปเดตข้อมูลเส้นทางแล้ว"),Ve(`/admin/routes/${A.params.id}`).catch(()=>{})}catch(e){console.error("update route error:",e),O.error("เกิดข้อผิดพลาด",((o=e==null?void 0:e.data)==null?void 0:o.message)||"ไม่สามารถบันทึกการแก้ไขได้")}finally{U.value=!1}}function De(){Ve(`/admin/routes/${A.params.id}`)}function je(){const o=document.getElementById("sidebar"),e=document.getElementById("overlay");!o||!e||(o.classList.remove("mobile-open"),e.classList.add("hidden"))}return qe(async()=>{var o;if((o=window.google)!=null&&o.maps)Q();else{const e=document.createElement("script");e.src=`https://maps.googleapis.com/maps/api/js?key=${I.public.googleMapsApiKey}&libraries=places,geometry&callback=${ne}`,e.async=!0,e.defer=!0,window[ne]=()=>{try{delete window[ne]}catch{}Q(),x()},document.head.appendChild(e)}await ze()}),(o,e)=>{const l=Oe;return f(),g("div",null,[Y(Ze),Y(et),n("main",nt,[n("div",ot,[n("div",at,[Y(l,{to:`/admin/routes/${Ge(A).params.id}`,class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md hover:bg-gray-50"},{default:Ce(()=>e[20]||(e[20]=[n("i",{class:"fa-solid fa-arrow-left"},null,-1),n("span",null,"ย้อนกลับ",-1)])),_:1,__:[20]},8,["to"])]),e[36]||(e[36]=n("div",{class:"flex flex-col gap-3 mb-6 sm:flex-row sm:items-center sm:justify-between"},[n("div",{class:"flex items-center gap-3"},[n("h1",{class:"text-2xl font-semibold text-gray-800"},"แก้ไขเส้นทาง (แอดมิน)"),n("span",{class:"text-sm text-gray-500"},"อัปเดตข้อมูลเส้นทางสำหรับผู้ขับและรถที่เลือก")])],-1)),n("div",lt,[n("main",st,[n("form",{onSubmit:Te(Ee,["prevent"]),class:"space-y-10"},[n("section",rt,[e[25]||(e[25]=n("h2",{class:"text-lg font-semibold text-gray-800"},"ผู้ขับขี่และรถยนต์",-1)),n("div",dt,[e[21]||(e[21]=n("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"ค้นหาผู้ขับ (อีเมล / ชื่อ / Username)",-1)),u(n("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>S.value=a),onInput:Me,type:"text",placeholder:"เลือกจากรายการ",disabled:$.value,readonly:$.value,class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100"},null,40,it),[[c,S.value,void 0,{trim:!0}]]),!$.value&&Ue.value?(f(),g("div",ut,[(f(!0),g(Z,null,ee(T.value,a=>(f(),g("button",{key:a.id,type:"button",onClick:r=>Ae(a),class:"w-full px-3 py-2 text-left hover:bg-blue-50"},[n("div",mt,[$e(v(a.firstName)+" "+v(a.lastName)+" ",1),a.username?(f(),g("span",pt,"(@"+v(a.username)+")",1)):M("",!0)]),n("div",gt,v(a.email),1)],8,ct))),128)),!F.value&&T.value.length===0?(f(),g("div",ft," ไม่พบผู้ใช้ที่ตรงกับคำค้น ")):M("",!0)])):M("",!0),e[22]||(e[22]=n("p",{class:"mt-2 text-sm text-amber-600"},"* โหมดแก้ไข: ไม่สามารถเปลี่ยนผู้ขับได้",-1))]),n("div",null,[e[24]||(e[24]=n("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"เลือกรถของผู้ขับ",-1)),u(n("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>t.vehicleId=a),disabled:!t.driverId||V.value.length===0,class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100"},[e[23]||(e[23]=n("option",{disabled:"",value:""},"— กรุณาเลือก —",-1)),(f(!0),g(Z,null,ee(V.value,a=>(f(),g("option",{key:a.id,value:a.id},v(a.vehicleModel)+" ("+v(a.vehicleType)+") • "+v(a.licensePlate||"—"),9,yt))),128))],8,bt),[[We,t.vehicleId]]),t.driverId&&V.value.length===0?(f(),g("p",vt," * ผู้ขับรายนี้ยังไม่มีรถในระบบ ")):M("",!0)])]),n("section",xt,[e[34]||(e[34]=n("h2",{class:"text-lg font-semibold text-gray-800"},"ข้อมูลเส้นทาง",-1)),n("div",null,[e[26]||(e[26]=n("h3",{class:"mb-2 text-sm font-semibold text-gray-700"},"แผนที่เส้นทาง",-1)),n("div",wt,[n("div",{ref_key:"mapEl",ref:q,class:"w-full",style:{height:"360px"}},null,512)])]),n("div",Lt,[n("div",null,[e[27]||(e[27]=n("label",{class:"block mb-1 text-xs font-medium text-gray-600"},"จุดเริ่มต้น",-1)),n("div",ht,[u(n("input",{ref_key:"startNameRef",ref:K,"onUpdate:modelValue":e[2]||(e[2]=a=>t.startLocation.name=a),onChange:e[3]||(e[3]=a=>ie("start")),type:"text",placeholder:"ชื่อสถานที่",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,544),[[c,t.startLocation.name]]),u(n("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>t.startLocation.address=a),onChange:e[5]||(e[5]=a=>ue("start")),type:"text",placeholder:"ที่อยู่",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,544),[[c,t.startLocation.address]]),n("div",_t,[u(n("input",{"onUpdate:modelValue":e[6]||(e[6]=a=>t.startLocation.lat=a),type:"number",step:"any",placeholder:"lat",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[c,t.startLocation.lat,void 0,{number:!0}]]),u(n("input",{"onUpdate:modelValue":e[7]||(e[7]=a=>t.startLocation.lng=a),type:"number",step:"any",placeholder:"lng",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[c,t.startLocation.lng,void 0,{number:!0}]])]),n("button",{type:"button",onClick:e[8]||(e[8]=a=>X("start")),class:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50"}," เลือกจากแผนที่ ")])]),n("div",null,[e[28]||(e[28]=n("label",{class:"block mb-1 text-xs font-medium text-gray-600"},"จุดปลายทาง",-1)),n("div",kt,[u(n("input",{ref_key:"endNameRef",ref:G,"onUpdate:modelValue":e[9]||(e[9]=a=>t.endLocation.name=a),onChange:e[10]||(e[10]=a=>ie("end")),type:"text",placeholder:"ชื่อสถานที่",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,544),[[c,t.endLocation.name]]),u(n("input",{"onUpdate:modelValue":e[11]||(e[11]=a=>t.endLocation.address=a),onChange:e[12]||(e[12]=a=>ue("end")),type:"text",placeholder:"ที่อยู่",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,544),[[c,t.endLocation.address]]),n("div",Ct,[u(n("input",{"onUpdate:modelValue":e[13]||(e[13]=a=>t.endLocation.lat=a),type:"number",step:"any",placeholder:"lat",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[c,t.endLocation.lat,void 0,{number:!0}]]),u(n("input",{"onUpdate:modelValue":e[14]||(e[14]=a=>t.endLocation.lng=a),type:"number",step:"any",placeholder:"lng",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[c,t.endLocation.lng,void 0,{number:!0}]])]),n("button",{type:"button",onClick:e[15]||(e[15]=a=>X("end")),class:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50"}," เลือกจากแผนที่ ")])])]),n("div",null,[e[29]||(e[29]=n("h3",{class:"mb-2 text-sm font-semibold text-gray-700"},"จุดแวะระหว่างทาง",-1)),n("div",Tt,[(f(!0),g(Z,null,ee(t.waypoints,(a,r)=>(f(),g("div",{key:r,class:"p-3 border border-gray-300 rounded-md"},[n("div",$t,[u(n("input",{"onUpdate:modelValue":d=>a.name=d,type:"text",placeholder:"ชื่อจุดแวะ",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,8,St),[[c,a.name]]),u(n("input",{"onUpdate:modelValue":d=>a.address=d,type:"text",placeholder:"ที่อยู่",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,8,Vt),[[c,a.address]]),u(n("input",{"onUpdate:modelValue":d=>a.lat=d,type:"number",step:"any",placeholder:"lat",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,8,Ut),[[c,a.lat,void 0,{number:!0}]]),u(n("input",{"onUpdate:modelValue":d=>a.lng=d,type:"number",step:"any",placeholder:"lng",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,8,Mt),[[c,a.lng,void 0,{number:!0}]])]),n("div",At,[n("button",{type:"button",onClick:d=>X("waypoint",r),class:"px-3 py-1.5 text-sm border border-gray-300 rounded-md hover:bg-gray-50"}," เลือกจากแผนที่ ",8,It),n("button",{type:"button",onClick:d=>Re(r),class:"px-3 py-1.5 text-sm border border-red-300 text-red-700 rounded-md hover:bg-red-50"}," ลบจุดแวะ ",8,Pt)])]))),128)),n("button",{type:"button",onClick:Ne,class:"px-4 py-2 text-sm bg-gray-100 border rounded-md hover:bg-gray-200"}," + เพิ่มจุดแวะ ")])]),n("div",Bt,[n("div",Nt,[e[30]||(e[30]=n("label",{class:"block mb-1 text-xs font-medium text-gray-600"},"วัน-เวลาออกเดินทาง",-1)),u(n("input",{"onUpdate:modelValue":e[16]||(e[16]=a=>P.value=a),type:"datetime-local",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[c,P.value]])]),n("div",null,[e[31]||(e[31]=n("label",{class:"block mb-1 text-xs font-medium text-gray-600"},"ราคา/ที่นั่ง (บาท)",-1)),u(n("input",{"onUpdate:modelValue":e[17]||(e[17]=a=>t.pricePerSeat=a),type:"number",min:"0",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[c,t.pricePerSeat,void 0,{number:!0}]])]),n("div",null,[e[32]||(e[32]=n("label",{class:"block mb-1 text-xs font-medium text-gray-600"},"ที่นั่งคงเหลือ",-1)),u(n("input",{"onUpdate:modelValue":e[18]||(e[18]=a=>t.availableSeats=a),type:"number",min:"0",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[c,t.availableSeats,void 0,{number:!0}]])])]),n("div",null,[e[33]||(e[33]=n("label",{class:"block mb-1 text-xs font-medium text-gray-600"},"เงื่อนไขการเดินทาง",-1)),u(n("textarea",{"onUpdate:modelValue":e[19]||(e[19]=a=>t.conditions=a),rows:"4",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"ระบุเงื่อนไขเพิ่มเติม เช่น ไม่เปิดเพลงเสียงดัง ฯลฯ"},null,512),[[c,t.conditions]])])]),n("div",Rt,[n("button",{type:"button",disabled:U.value,onClick:De,class:"px-6 py-3 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-400 disabled:opacity-50"}," ยกเลิก ",8,zt),n("button",{type:"submit",disabled:!oe.value||U.value,class:"flex items-center px-6 py-3 font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-blue-400 disabled:cursor-not-allowed"},[U.value?(f(),g("svg",Dt,e[35]||(e[35]=[n("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),n("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):M("",!0),$e(" "+v(U.value?"กำลังบันทึก...":"บันทึกการแก้ไข"),1)],8,Et)])],32)])])])]),n("div",{id:"overlay",class:"fixed inset-0 z-40 hidden bg-black bg-opacity-50 lg:hidden",onClick:je}),Y(Je,{name:"modal-fade"},{default:Ce(()=>{var a,r;return[s.show?(f(),g("div",{key:0,class:"fixed inset-0 z-[1000] bg-black/60 flex items-center justify-center",onClick:Te(ge,["self"])},[n("div",jt,[n("div",Ot,[n("div",Ft," เลือกตำแหน่ง"+v(s.mode==="start"?"จุดเริ่มต้น":s.mode==="end"?"จุดปลายทาง":"จุดแวะ"),1)]),n("div",Ht,[n("div",{ref_key:"pickerMapEl",ref:pe,class:"w-full",style:{height:"70vh"}},null,512),n("div",Yt,[n("div",qt,[e[37]||(e[37]=n("span",{class:"font-medium"},"ตำแหน่ง:",-1)),n("span",Kt,"lat: "+v(((a=s.lat)==null?void 0:a.toFixed(6))||"-")+", lng: "+v(((r=s.lng)==null?void 0:r.toFixed(6))||"-"),1)]),n("button",{class:"px-4 py-2 text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed",disabled:s.lat==null||s.lng==null,onClick:Be}," ใช้ตำแหน่งนี้ ",8,Gt)])])])])):M("",!0)]}),_:1})])}}},ln=Fe(Wt,[["__scopeId","data-v-b28acfc4"]]);export{ln as default};
