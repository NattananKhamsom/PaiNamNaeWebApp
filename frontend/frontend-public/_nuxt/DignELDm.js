import{_ as A}from"./Lcixqshc.js";import{u as D}from"./DOK8vhV6.js";import{m as V,r as u,p as C,i as O,c as o,a as e,g as p,b as v,w as f,l as d,t as n,F as h,q as E,s as L,o as r,d as c,n as w}from"./DPSIKoxe.js";const T={class:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8"},B={class:"max-w-4xl mx-auto"},P={class:"mb-8"},U={key:0,class:"text-center py-12"},H={key:1,class:"p-4 bg-red-50 border border-red-200 rounded-lg"},M={class:"text-red-800"},F={key:2,class:"bg-white rounded-lg shadow-md p-8 text-center"},G={key:3,class:"space-y-4"},$={class:"p-6"},j={class:"flex justify-between items-start mb-4"},W={class:"text-xl font-bold text-gray-900"},Y={class:"text-sm text-gray-600 mt-1"},q={class:"font-medium"},z={class:"text-gray-700 mb-4"},J={key:0,class:"mb-4 p-3 bg-gray-50 rounded"},K={class:"text-sm text-gray-600"},Q={key:1,class:"mb-4 p-3 bg-blue-50 border-l-4 border-blue-400 rounded"},X={class:"text-sm text-gray-800 mt-1"},Z={class:"grid grid-cols-3 gap-4 text-sm text-gray-600 pt-4 border-t"},tt={class:"font-medium"},et={key:0},st={class:"font-medium"},ot={key:1},rt={class:"font-medium"},at={key:4,class:"mt-8 flex justify-center gap-2"},nt=["onClick"],gt={__name:"my-incidents",setup(dt){const{$api:R}=V();D();const k=L(),y=u([]),x=u(!0),i=u(""),g=u(1),m=u(null),b=async()=>{var a,t;try{x.value=!0,i.value="";const l=await R.get(`/incidents/me?page=${g.value}&limit=10`);y.value=l.data,m.value=l.pagination}catch(l){i.value=((t=(a=l.response)==null?void 0:a.data)==null?void 0:t.message)||"Failed to load incidents",k.addToast(i.value,"error")}finally{x.value=!1}},S=a=>({DRIVER_BEHAVIOR:"Driver Behavior",PASSENGER_BEHAVIOR:"Passenger Behavior",SAFETY_ISSUE:"Safety Issue",VEHICLE_ISSUE:"Vehicle Issue",HARASSMENT:"Harassment",OTHER:"Other"})[a]||a,I=a=>({PENDING:"Pending Review",REVIEWED:"Under Review",RESOLVED:"Resolved",CLOSED:"Closed"})[a]||a,N=a=>({PENDING:"bg-yellow-100 text-yellow-800",REVIEWED:"bg-blue-100 text-blue-800",RESOLVED:"bg-green-100 text-green-800",CLOSED:"bg-gray-100 text-gray-800"})[a]||"bg-gray-100 text-gray-800",_=a=>new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return C(g,()=>{b()}),O(()=>{b()}),(a,t)=>{const l=A;return r(),o("div",T,[e("div",B,[e("div",P,[t[1]||(t[1]=e("h1",{class:"text-3xl font-bold text-gray-900 mb-2"},"My Reported Incidents",-1)),t[2]||(t[2]=e("p",{class:"text-gray-600 mb-4"},"Track the status of incidents you've reported",-1)),v(l,{to:"/report-incident",class:"inline-block bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg transition"},{default:f(()=>t[0]||(t[0]=[c(" Report New Incident ")])),_:1,__:[0]})]),d(x)?(r(),o("div",U,t[3]||(t[3]=[e("p",{class:"text-gray-600"},"Loading incidents...",-1)]))):d(i)?(r(),o("div",H,[e("p",M,n(d(i)),1)])):d(y).length===0?(r(),o("div",F,[t[5]||(t[5]=e("p",{class:"text-gray-600 mb-4"},"You haven't reported any incidents yet.",-1)),v(l,{to:"/report-incident",class:"inline-block bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg transition"},{default:f(()=>t[4]||(t[4]=[c(" Report an Incident ")])),_:1,__:[4]})])):(r(),o("div",G,[(r(!0),o(h,null,E(d(y),s=>(r(),o("div",{key:s.id,class:"bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition"},[e("div",$,[e("div",j,[e("div",null,[e("h3",W,n(s.title),1),e("p",Y,[t[6]||(t[6]=c(" Incident Type: ")),e("span",q,n(S(s.type)),1)])]),e("span",{class:w([N(s.status),"px-3 py-1 rounded-full text-sm font-medium"])},n(I(s.status)),3)]),e("p",z,n(s.description),1),s.reportedUser?(r(),o("div",J,[e("p",K,[t[7]||(t[7]=e("strong",null,"Report Against:",-1)),c(" "+n(s.reportedUser.firstName)+" "+n(s.reportedUser.lastName)+" ("+n(s.reportedUser.username)+") ",1)])])):p("",!0),s.adminNotes?(r(),o("div",Q,[t[8]||(t[8]=e("p",{class:"text-sm text-gray-600"},[e("strong",null,"Admin Notes:")],-1)),e("p",X,n(s.adminNotes),1)])):p("",!0),e("div",Z,[e("div",null,[t[9]||(t[9]=e("p",{class:"text-gray-500"},"Reported On",-1)),e("p",tt,n(_(s.createdAt)),1)]),s.resolvedAt?(r(),o("div",et,[t[10]||(t[10]=e("p",{class:"text-gray-500"},"Resolved On",-1)),e("p",st,n(_(s.resolvedAt)),1)])):p("",!0),s.closedAt?(r(),o("div",ot,[t[11]||(t[11]=e("p",{class:"text-gray-500"},"Closed On",-1)),e("p",rt,n(_(s.closedAt)),1)])):p("",!0)])])]))),128))])),d(m)&&d(m).totalPages>1?(r(),o("div",at,[(r(!0),o(h,null,E(d(m).totalPages,s=>(r(),o("button",{key:s,onClick:lt=>g.value=s,class:w([d(g)===s?"bg-blue-600 text-white":"bg-white text-gray-900 border border-gray-300","px-4 py-2 rounded-lg font-medium transition"])},n(s),11,nt))),128))])):p("",!0)])])}}};export{gt as default};
