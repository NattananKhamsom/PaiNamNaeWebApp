import{_ as Ye,m as Re,r as v,y as et,x as tt,i as lt,c,a as e,b as Ie,f as X,h as V,v as K,z as Se,t as u,g as h,F as M,q as S,w as $e,T as Ne,B as ge,o as g,d as Ve,n as at,C as je,s as st}from"./DPSIKoxe.js";import{d as Y}from"./B5yDJBm8.js";import{b as nt}from"./C5FTVxxA.js";import{u as ot}from"./DOK8vhV6.js";import{u as it}from"./BaxiziUg.js";import{s as rt}from"./x_rD_Ya3.js";import"./Cpj98o6Y.js";const dt={class:"px-4 py-8 mx-auto max-w-7xl sm:px-6 lg:px-8"},ut={class:"p-6 mb-8 bg-white border border-gray-300 rounded-lg shadow-md"},ct={class:"relative"},gt={class:"relative"},mt={class:"grid grid-cols-1 gap-6 lg:grid-cols-3"},pt={class:"lg:col-span-2"},vt={class:"bg-white border border-gray-300 rounded-lg shadow-md"},ft={class:"p-6 border-b border-gray-300"},bt={class:"text-lg font-semibold text-gray-900"},yt={key:0,class:"p-6 text-center text-gray-500"},xt={key:1,class:"divide-y divide-gray-200"},_t={key:0,class:"p-6 text-center text-gray-500"},ht=["onClick"],wt={class:"mb-6 font-semibold text-center text-gray-900"},kt={class:"flex items-start space-x-4"},Mt=["src","alt"],Pt={class:"flex-1"},Ct={class:"flex items-start justify-between"},Lt={class:"flex items-center"},Tt={class:"font-semibold text-gray-900"},At={key:0,class:"relative group ml-1.5 flex items-center"},Bt={class:"flex items-center mt-1"},It={class:"flex text-yellow-400"},St={class:"ml-2 text-sm text-gray-600"},$t={class:"text-right"},Nt={class:"text-lg font-bold text-blue-600"},Vt={class:"mt-3"},jt={class:"flex flex-wrap items-center text-sm text-gray-600"},zt={class:"font-medium"},Et={class:"ml-1"},Ft={class:"ml-1"},Dt={class:"ml-1"},Ot={class:"flex items-center mt-2 text-sm text-gray-600"},Ut={key:0,class:"pt-4 mt-4 duration-300 border-t border-gray-300 animate-in slide-in-from-top"},Kt={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},Gt={class:"space-y-1 text-sm text-gray-600"},Ht={key:0},Zt={key:1},qt={class:"space-y-1 text-sm text-gray-600"},Wt={class:"space-y-1 text-sm text-gray-600"},Jt={class:"mt-4 space-y-4"},Qt={key:0},Xt={class:"p-3 text-sm text-gray-700 border border-gray-300 rounded-md bg-gray-50"},Yt={key:1},Rt={class:"grid grid-cols-3 gap-2 mt-2"},el=["src"],tl={class:"flex justify-end mt-4"},ll=["onClick","disabled"],al={class:"lg:col-span-1"},sl={class:"sticky overflow-hidden bg-white border border-gray-300 rounded-lg shadow-md top-8"},nl={class:"modal-content"},ol={key:0,class:"flex items-center justify-between p-6 border-b border-gray-300"},il={class:"flex items-center justify-between p-4 border-b border-gray-300"},rl={class:"text-lg font-semibold text-gray-900"},dl={class:"p-0"},ul={class:"flex items-center justify-between p-4 border-t border-gray-200"},cl={class:"text-sm text-gray-700 truncate"},gl={class:"truncate"},ml=["disabled"],pl={class:"p-6"},vl={class:"mb-6"},fl={class:"flex items-center p-3 space-x-3 rounded-lg bg-gray-50"},bl=["src","alt"],yl={class:"flex items-center"},xl={class:"font-medium text-gray-900"},_l={key:0,class:"relative group ml-1.5 flex items-center"},hl={class:"flex items-center"},wl={class:"flex text-sm text-yellow-400"},kl={class:"ml-2 text-sm text-gray-600"},Ml={class:"grid grid-cols-1 gap-6 mb-6 md:grid-cols-2"},Pl={class:"p-3 text-gray-900 rounded-lg bg-gray-50"},Cl={class:"p-3 text-gray-900 rounded-lg bg-gray-50"},Ll={class:"mb-6"},Tl={class:"flex items-center p-3 space-x-4 rounded-lg bg-gray-50"},Al={class:"flex-1"},Bl={class:"font-medium text-gray-900"},Il={class:"flex-1 text-right"},Sl={class:"font-medium text-gray-900"},$l={class:"mb-6 space-y-4"},Nl=["value"],Vl={class:"relative"},jl={class:"relative"},zl={class:"p-4 mb-6 rounded-lg bg-blue-50"},El={class:"flex items-center justify-between mb-2"},Fl={class:"font-medium text-gray-900"},Dl={class:"flex items-center justify-between mb-2"},Ol={class:"font-medium text-gray-900"},Ul={class:"pt-2 mt-2 border-t border-gray-300"},Kl={class:"flex items-center justify-between"},Gl={class:"text-lg font-bold text-blue-600"},Hl={class:"modal-content"},Zl={class:"flex items-center justify-between p-4 border-b border-gray-300"},ql={class:"text-lg font-semibold text-gray-900"},Wl={class:"p-4 space-y-3"},Jl={class:"text-sm text-gray-700"},Ql={class:"truncate"},Xl={key:0,class:"text-gray-500"},Yl={class:"flex gap-3 pt-2"},Rl=["disabled"],me="__gmapsReady__",ea={__name:"index_v6",setup(ta){var Ae;Y.locale("th"),Y.extend(nt);const{$api:pe}=Re(),{toast:R}=st(),{token:ze}=ot(),Ee=et(),ee=v(null),te=v(null);let P=null,C=null;const L=v({lat:null,lng:null,placeId:null,address:null,name:null}),T=v({lat:null,lng:null,placeId:null,address:null,name:null}),$=v(null),ve=v(null);let G=null,D=null;const w=v({name:"",lat:null,lng:null,placeId:null,address:null}),le=v(null),ae=v(null);let se=null,ne=null;const oe=v(!1),j=v(null),fe=v(null);let H=null,O=null;const x=v({name:"",lat:null,lng:null}),Fe=[];(Ae=window.google)!=null&&Ae.maps||Fe.push({key:"gmaps",src:`https://maps.googleapis.com/maps/api/js?key=${Ee.public.googleMapsApiKey}&libraries=places,geometry&callback=${me}`,async:!0,defer:!0}),it({});const f=v({origin:"",destination:"",date:"",seats:"1"}),_=v([]),N=v(null),ie=v(!1),re=v(null);let k=null,Z=null,q=null,W=null,z=null,E=null;const de=v(!1),ue=v(!1),b=v(null),F=v(1),A=v(""),B=v(""),De=tt(()=>b.value?F.value*b.value.price:0);async function ce(){ie.value=!0,N.value=null;try{const s=await pe("/routes"),t=((s==null?void 0:s.data)||s||[]).filter(a=>a.status==="AVAILABLE");_.value=t.map(a=>{var n,o,d,r,i,m;return{id:a.id,availableSeats:a.availableSeats,price:a.pricePerSeat,departureTime:Y(a.departureTime).format("HH:mm น."),date:Y(a.departureTime).format("D MMMM BBBB"),start:a.startLocation,end:a.endLocation,originName:`(${a.startLocation.lat.toFixed(2)}, ${a.startLocation.lng.toFixed(2)})`,destinationName:`(${a.endLocation.lat.toFixed(2)}, ${a.endLocation.lng.toFixed(2)})`,driver:{name:`${((n=a.driver)==null?void 0:n.firstName)||""} ${((o=a.driver)==null?void 0:o.lastName)||""}`.trim()||"ไม่ระบุชื่อ",image:((d=a.driver)==null?void 0:d.profilePicture)||`https://ui-avatars.com/api/?name=${encodeURIComponent(((r=a.driver)==null?void 0:r.firstName)||"U")}&background=random&size=64`,rating:4.5,reviews:Math.floor(Math.random()*50)+5,isVerified:!!((i=a.driver)!=null&&i.isVerified)},carDetails:a.vehicle?[`${a.vehicle.vehicleModel} (${a.vehicle.vehicleType})`,...a.vehicle.amenities||[]]:["ไม่มีข้อมูลรถ"],conditions:a.conditions,photos:((m=a.vehicle)==null?void 0:m.photos)||[],durationText:a.duration||"-",distanceText:a.distance||"-",polyline:a.routePolyline||null}}),await ye();const l=_.value.map(async(a,n)=>{const[o,d]=await Promise.all([be(a.start.lat,a.start.lng),be(a.end.lat,a.end.lng)]),r=await U(o),i=await U(d);_.value[n].originName=r.name||_.value[n].originName,_.value[n].destinationName=i.name||_.value[n].destinationName,_.value[n].originArea=r.area||null,_.value[n].destinationArea=i.area||null});await Promise.allSettled(l)}catch(s){console.error("Failed to fetch routes:",s),_.value=[]}finally{ie.value=!1}}function be(s,t){return new Promise(l=>{if(!z)return l(null);z.geocode({location:{lat:s,lng:t}},(a,n)=>{if(n!=="OK"||!(a!=null&&a.length))return l(null);l(a[0])})})}async function U(s){if(!s)return{name:null,area:null};const t=s.address_components||[],l=p=>{var y;return(y=t.find(I=>I.types.includes(p)))==null?void 0:y.long_name},a=p=>{var y;return(y=t.find(I=>I.types.includes(p)))==null?void 0:y.short_name},n=s.types||[],o=n.includes("point_of_interest")||n.includes("establishment")||n.includes("premise");let d=null;if(o&&s.place_id){const p=await Ke(s.place_id);p&&(d=p)}if(!d){const p=l("street_number"),y=l("route");d=p&&y?`${p} ${y}`:y||s.formatted_address||null}const r=l("sublocality")||l("neighborhood")||l("locality")||l("administrative_area_level_2"),i=l("administrative_area_level_1")||a("administrative_area_level_1");let m=null;return r&&i?m=`${r}, ${i}`:i&&(m=i),d&&(d=d.replace(/,?\s*(Thailand|ไทย)\s*$/i,"")),{name:d,area:m}}const Oe=s=>{N.value&&N.value.id===s.id?(N.value=null,xe()):(N.value=s,Ue(s))};function ye(){return new Promise(s=>{if(de.value)return s(!0);const t=rt(()=>{de.value&&(clearInterval(t),s(!0))},50)})}function xe(){Z&&(Z.setMap(null),Z=null),q&&(q.setMap(null),q=null),W&&(W.setMap(null),W=null)}async function Ue(s){var t;if(s&&(await ye(),!(!k||!(k instanceof google.maps.Map))))if(xe(),q=new google.maps.Marker({position:{lat:s.start.lat,lng:s.start.lng},map:k,label:"A"}),W=new google.maps.Marker({position:{lat:s.end.lat,lng:s.end.lng},map:k,label:"B"}),s.polyline&&((t=google.maps.geometry)!=null&&t.encoding)){const l=google.maps.geometry.encoding.decodePath(s.polyline);Z=new google.maps.Polyline({path:l,map:k,strokeColor:"#2563eb",strokeOpacity:.9,strokeWeight:5});const a=new google.maps.LatLngBounds;l.forEach(n=>a.extend(n)),k.fitBounds(a)}else{const l=new google.maps.LatLng(Math.min(s.start.lat,s.end.lat),Math.min(s.start.lng,s.end.lng)),a=new google.maps.LatLng(Math.max(s.start.lat,s.end.lat),Math.max(s.start.lng,s.end.lng)),n=new google.maps.LatLngBounds(l,a);k.fitBounds(n)}}function Ke(s){return new Promise(t=>{if(!E||!s)return t(null);E.getDetails({placeId:s,fields:["name"]},(l,a)=>{a===google.maps.places.PlacesServiceStatus.OK&&(l!=null&&l.name)?t(l.name):t(null)})})}function Ge(s){if(!ze.value)return je("/login");s&&s.availableSeats>0&&(b.value=s,F.value=1,A.value="",B.value="",L.value={lat:null,lng:null,placeId:null,address:null,name:null},T.value={lat:null,lng:null,placeId:null,address:null,name:null},$.value=null,ue.value=!0,ge(()=>Je()))}function J(){ue.value=!1,setTimeout(()=>{b.value=null},300)}async function He(){var t;if(!b.value)return;if(A.value&&!L.value.lat){const l=await Te(A.value);l&&(L.value=l)}if(B.value&&!T.value.lat){const l=await Te(B.value);l&&(T.value=l)}if(!L.value.lat||!T.value.lat){R.warning("ข้อมูลไม่ครบถ้วน","กรุณาเลือกจุดขึ้นรถและจุดลงรถจากรายการหรือปักหมุดบนแผนที่");return}const s={routeId:b.value.id,numberOfSeats:F.value,pickupLocation:L.value,dropoffLocation:T.value};try{await pe("/bookings",{method:"POST",body:s}),J(),R.success("ส่งคำขอจองสำเร็จ!","คำขอของคุณถูกส่งไปให้ผู้ขับแล้ว โปรดรอการยืนยัน"),setTimeout(()=>je("/myTrip"),1500)}catch(l){console.error("Failed to create booking:",l),R.error("เกิดข้อผิดพลาดในการจอง",((t=l.data)==null?void 0:t.message)||"โปรดลองใหม่อีกครั้งในภายหลัง")}}const _e=()=>{!re.value||k||(k=new google.maps.Map(re.value,{center:{lat:13.7563,lng:100.5018},zoom:6,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!0}),z=new google.maps.Geocoder,E=new google.maps.places.PlacesService(k),de.value=!0)};function he(){var t,l;if(!le.value||!ae.value||!((l=(t=window.google)==null?void 0:t.maps)!=null&&l.places))return;const s={fields:["place_id","name","formatted_address","geometry"]};se=new google.maps.places.Autocomplete(le.value,{...s,types:["geocode","establishment"]}),se.addListener("place_changed",()=>{var n,o,d,r,i,m;const a=se.getPlace();a&&(f.value.origin=a.name||a.formatted_address||f.value.origin,f.value._originMeta={placeId:a.place_id||null,fullAddress:a.formatted_address||null,lat:((d=(o=(n=a.geometry)==null?void 0:n.location)==null?void 0:o.lat)==null?void 0:d.call(o))??null,lng:((m=(i=(r=a.geometry)==null?void 0:r.location)==null?void 0:i.lng)==null?void 0:m.call(i))??null})}),ne=new google.maps.places.Autocomplete(ae.value,{...s,types:["geocode","establishment"]}),ne.addListener("place_changed",()=>{var n,o,d,r,i,m;const a=ne.getPlace();a&&(f.value.destination=a.name||a.formatted_address||f.value.destination,f.value._destinationMeta={placeId:a.place_id||null,fullAddress:a.formatted_address||null,lat:((d=(o=(n=a.geometry)==null?void 0:n.location)==null?void 0:o.lat)==null?void 0:d.call(o))??null,lng:((m=(i=(r=a.geometry)==null?void 0:r.location)==null?void 0:i.lng)==null?void 0:m.call(i))??null})})}function we(s){j.value=s,x.value={name:"",lat:null,lng:null},oe.value=!0,ge(()=>{const t={lat:13.7563,lng:100.5018},l=s==="origin"?f.value._originMeta:f.value._destinationMeta,a=l!=null&&l.lat&&(l!=null&&l.lng)?{lat:l.lat,lng:l.lng}:t;H=new google.maps.Map(fe.value,{center:a,zoom:l!=null&&l.lat?14:6,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1}),H.addListener("click",n=>{const o=n.latLng;Ze(o),ke(o)})})}function Ze(s){if(O){O.setPosition(s);return}O=new google.maps.Marker({position:s,map:H,draggable:!0}),O.addListener("dragend",t=>{ke(t.latLng)})}async function ke(s){const t=s.lat(),l=s.lng(),a=await new Promise(o=>{z.geocode({location:{lat:t,lng:l}},(d,r)=>{r==="OK"&&(d!=null&&d.length)?o(d[0]):o(null)})});let n="";if(a&&(n=(await U(a)).name||""),!n||We(n)){const o=await Me(t,l,120);o!=null&&o.name?n=o.name:a!=null&&a.formatted_address&&(n=a.formatted_address.replace(/,?\s*(Thailand|ไทย)\s*$/i,""))}x.value={name:n,lat:t,lng:l}}function qe(){!j.value||!x.value.name||(j.value==="origin"?(f.value.origin=x.value.name,f.value._originMeta={placeId:null,fullAddress:null,lat:x.value.lat,lng:x.value.lng}):j.value==="destination"&&(f.value.destination=x.value.name,f.value._destinationMeta={placeId:null,fullAddress:null,lat:x.value.lat,lng:x.value.lng}),Q())}function Q(){oe.value=!1,j.value=null,O=null,H=null}function We(s){return s?/^[A-Z0-9]{4,}\+[A-Z0-9]{2,}/i.test(s.trim()):!1}function Me(s,t,l=100){return new Promise(a=>{if(!E)return a(null);E.nearbySearch({location:{lat:s,lng:t},radius:l},(n,o)=>{o===google.maps.places.PlacesServiceStatus.OK&&(n!=null&&n.length)?a(n[0]):a(null)})})}function Je(){var t,l,a,n;if(!((l=(t=window.google)==null?void 0:t.maps)!=null&&l.places))return;const s={fields:["place_id","name","formatted_address","geometry"],types:["geocode","establishment"]};ee.value&&((a=P==null?void 0:P.unbindAll)==null||a.call(P),P=new google.maps.places.Autocomplete(ee.value,s),P.addListener("place_changed",()=>{var d,r,i,m,p,y;const o=P.getPlace();o&&(A.value=o.name||o.formatted_address||A.value,L.value={lat:((i=(r=(d=o.geometry)==null?void 0:d.location)==null?void 0:r.lat)==null?void 0:i.call(r))??null,lng:((y=(p=(m=o.geometry)==null?void 0:m.location)==null?void 0:p.lng)==null?void 0:y.call(p))??null,placeId:o.place_id||null,address:o.formatted_address||null,name:o.name||null})})),te.value&&((n=C==null?void 0:C.unbindAll)==null||n.call(C),C=new google.maps.places.Autocomplete(te.value,s),C.addListener("place_changed",()=>{var d,r,i,m,p,y;const o=C.getPlace();o&&(B.value=o.name||o.formatted_address||B.value,T.value={lat:((i=(r=(d=o.geometry)==null?void 0:d.location)==null?void 0:r.lat)==null?void 0:i.call(r))??null,lng:((y=(p=(m=o.geometry)==null?void 0:m.location)==null?void 0:p.lng)==null?void 0:y.call(p))??null,placeId:o.place_id||null,address:o.formatted_address||null,name:o.name||null})}))}function Pe(s){$.value=s,w.value={name:"",lat:null,lng:null,placeId:null,address:null},ge(()=>{const t={lat:13.7563,lng:100.5018},l=s==="pickup"?L.value:T.value,a=l.lat&&l.lng?{lat:l.lat,lng:l.lng}:t;G=new google.maps.Map(ve.value,{center:a,zoom:l.lat?15:6,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1}),G.addListener("click",async n=>{const o=n.latLng;Qe(o),await Le(o)})})}function Ce(){$.value=null,G=null,D=null}function Qe(s){if(D)return D.setPosition(s);D=new google.maps.Marker({position:s,map:G,draggable:!0}),D.addListener("dragend",t=>Le(t.latLng))}async function Le(s){const t=s.lat(),l=s.lng(),a=await new Promise(r=>{z.geocode({location:{lat:t,lng:l}},(i,m)=>{m==="OK"&&(i!=null&&i.length)?r(i[0]):r(null)})});let n="",o=(a==null?void 0:a.place_id)||null,d=(a==null?void 0:a.formatted_address)||null;if(a&&(n=(await U(a)).name||""),!n){const r=await Me(t,l,120);if(r!=null&&r.place_id){o=r.place_id;const i=await new Promise(m=>{E.getDetails({placeId:r.place_id,fields:["name","formatted_address"]},(p,y)=>m(y===google.maps.places.PlacesServiceStatus.OK?p:null))});n=(i==null?void 0:i.name)||r.name||n,d=(i==null?void 0:i.formatted_address)||d}}d&&(d=d.replace(/,?\s*(Thailand|ไทย)\s*$/i,"")),w.value={name:n,lat:t,lng:l,placeId:o,address:d}}function Xe(){if(!$.value||!w.value.name)return;const s={lat:w.value.lat,lng:w.value.lng,placeId:w.value.placeId,address:w.value.address,name:w.value.name};$.value==="pickup"?(A.value=s.name||s.address||"",L.value=s):(B.value=s.name||s.address||"",T.value=s),Ce()}function Te(s){return new Promise(t=>{if(!s)return t(null);z.geocode({address:s},async(l,a)=>{var i,m,p,y,I,Be;if(a!=="OK"||!(l!=null&&l.length))return t(null);const n=l[0],o=(p=(m=(i=n.geometry)==null?void 0:i.location)==null?void 0:m.lat)==null?void 0:p.call(m),d=(Be=(I=(y=n.geometry)==null?void 0:y.location)==null?void 0:I.lng)==null?void 0:Be.call(I),r=await U(n);t({lat:o,lng:d,placeId:n.place_id||null,address:(n.formatted_address||"").replace(/,?\s*(Thailand|ไทย)\s*$/i,""),name:r.name||null})})})}return lt(()=>{var s;if((s=window.google)!=null&&s.maps){_e(),he(),ce();return}window[me]=()=>{try{delete window[me]}catch{}_e(),he(),ce()}}),(s,t)=>(g(),c("div",null,[e("div",dt,[e("div",ut,[t[19]||(t[19]=e("h2",{class:"mb-6 text-xl font-semibold text-gray-900"},"ค้นหาการเดินทาง",-1)),e("form",{onSubmit:X(ce,["prevent"]),class:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-5"},[e("div",null,[t[12]||(t[12]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"จุดเริ่มต้น",-1)),e("div",ct,[V(e("input",{ref_key:"originInputEl",ref:le,"onUpdate:modelValue":t[0]||(t[0]=l=>f.value.origin=l),type:"text",placeholder:"เช่น กรุงเทพฯ",class:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[K,f.value.origin]]),e("button",{type:"button",onClick:t[1]||(t[1]=l=>we("origin")),class:"absolute inset-y-0 my-auto text-gray-500 right-2 hover:text-blue-600",title:"เลือกจากแผนที่"},t[11]||(t[11]=[e("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[e("path",{d:"M12 2a7 7 0 00-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 00-7-7zm0 9.5a2.5 2.5 0 110-5 2.5 2.5 0 010 5z"})],-1)]))])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"จุดปลายทาง",-1)),e("div",gt,[V(e("input",{ref_key:"destinationInputEl",ref:ae,"onUpdate:modelValue":t[2]||(t[2]=l=>f.value.destination=l),type:"text",placeholder:"เช่น เชียงใหม่",class:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[K,f.value.destination]]),e("button",{type:"button",onClick:t[3]||(t[3]=l=>we("destination")),class:"absolute inset-y-0 my-auto text-gray-500 right-2 hover:text-blue-600",title:"เลือกจากแผนที่"},t[13]||(t[13]=[e("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[e("path",{d:"M12 2a7 7 0 00-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 00-7-7zm0 9.5a2.5 2.5 0 110-5 2.5 2.5 0 010 5z"})],-1)]))])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"วันที่",-1)),V(e("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>f.value.date=l),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[K,f.value.date]])]),e("div",null,[t[17]||(t[17]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"จำนวนที่นั่ง",-1)),V(e("select",{"onUpdate:modelValue":t[5]||(t[5]=l=>f.value.seats=l),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},t[16]||(t[16]=[e("option",{value:"1"},"1 ที่นั่ง",-1),e("option",{value:"2"},"2 ที่นั่ง",-1),e("option",{value:"3"},"3 ที่นั่ง",-1),e("option",{value:"4"},"4 ที่นั่ง",-1)]),512),[[Se,f.value.seats]])]),t[18]||(t[18]=e("div",{class:"flex items-end"},[e("button",{type:"submit",class:"w-full px-4 py-2 text-white transition duration-200 bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"}," ค้นหา ")],-1))],32)]),e("div",mt,[e("div",pt,[e("div",vt,[e("div",ft,[e("h3",bt,"ผลการค้นหา ("+u(_.value.length)+" รายการ)",1)]),ie.value?(g(),c("div",yt," กำลังค้นหาเส้นทาง... ")):(g(),c("div",xt,[_.value.length===0?(g(),c("div",_t," ไม่พบเส้นทางที่ค้นหา ")):h("",!0),(g(!0),c(M,null,S(_.value,l=>(g(),c("div",{key:l.id,class:"p-6 transition-all duration-300 cursor-pointer route-card hover:shadow-lg",onClick:a=>Oe(l)},[e("h1",wt,[Ve(u(l.originName)+" ",1),t[20]||(t[20]=e("span",{class:"mx-1 font-semibold text-gray-900"},"→",-1)),Ve(" "+u(l.destinationName),1)]),e("div",kt,[e("img",{src:l.driver.image,alt:l.driver.name,class:"object-cover w-12 h-12 rounded-full"},null,8,Mt),e("div",Pt,[e("div",Ct,[e("div",null,[e("div",Lt,[e("h4",Tt,u(l.driver.name),1),l.driver.isVerified?(g(),c("div",At,t[21]||(t[21]=[e("svg",{class:"w-5 h-5 text-blue-600",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8.603 3.799A4.49 4.49 0 0112 2.25c1.357 0 2.573.6 3.397 1.549a4.49 4.49 0 013.498 1.307 4.491 4.491 0 011.307 3.497A4.49 4.49 0 0121.75 12c0 1.357-.6 2.573-1.549 3.397a4.49 4.49 0 01-1.307 3.498 4.491 4.491 0 01-3.497 1.307A4.49 4.49 0 0112 21.75a4.49 4.49 0 01-3.397-1.549 4.49 4.49 0 01-3.498-1.306 4.491 4.491 0 01-1.307-3.498A4.49 4.49 0 012.25 12c0-1.357.6-2.573 1.549-3.397a4.49 4.49 0 011.307-3.497 4.49 4.49 0 013.497-1.307zm7.007 6.387a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.07-.01l3.5-4.875z","clip-rule":"evenodd"})],-1),e("span",{class:"absolute px-2 py-1 mb-2 text-xs text-white transition-opacity -translate-x-1/2 bg-gray-800 rounded-md opacity-0 pointer-events-none bottom-full left-1/2 w-max group-hover:opacity-100"}," ผู้ขับขี่ยืนยันตัวตนแล้ว ",-1)]))):h("",!0)]),e("div",Bt,[e("div",It,[(g(),c(M,null,S(5,a=>e("span",{key:a},u(a<=l.driver.rating?"★":"☆"),1)),64))]),e("span",St,u(l.driver.rating)+" ("+u(l.driver.reviews)+" รีวิว) ",1)])]),e("div",$t,[e("div",Nt,u(l.price)+" บาท",1),t[22]||(t[22]=e("div",{class:"text-sm text-gray-600"},"ต่อที่นั่ง",-1))])]),e("div",Vt,[e("div",jt,[e("span",zt,u(l.date),1),t[23]||(t[23]=e("span",{class:"mx-2 text-gray-300"},"|",-1)),t[24]||(t[24]=e("span",{class:"font-medium"},"เวลาออก:",-1)),e("span",Et,u(l.departureTime),1),t[25]||(t[25]=e("span",{class:"mx-2 text-gray-300"},"|",-1)),t[26]||(t[26]=e("span",{class:"font-medium"},"ระยะเวลา:",-1)),e("span",Ft,u(l.durationText),1),t[27]||(t[27]=e("span",{class:"mx-2 text-gray-300"},"|",-1)),t[28]||(t[28]=e("span",{class:"font-medium"},"ระยะทาง:",-1)),e("span",Dt,u(l.distanceText),1)]),e("div",Ot,[e("span",{class:at(["px-2 py-1 rounded-full text-xs font-medium",l.availableSeats>2?"bg-green-100 text-green-800":l.availableSeats>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"])},u(l.availableSeats>0?`เหลือ ${l.availableSeats}
                                                    ที่นั่ง`:"เต็มแล้ว"),3)])])])]),N.value&&N.value.id===l.id?(g(),c("div",Ut,[e("div",Kt,[e("div",null,[t[29]||(t[29]=e("h5",{class:"mb-2 font-medium text-gray-900"},"รายละเอียดเส้นทาง",-1)),e("ul",Gt,[l.originArea?(g(),c("li",Ht,"• จุดเริ่มต้น (พื้นที่): "+u(l.originArea),1)):h("",!0),l.destinationArea?(g(),c("li",Zt,"• จุดปลายทาง (พื้นที่): "+u(l.destinationArea),1)):h("",!0),(g(!0),c(M,null,S(l.stops,a=>(g(),c("li",{key:a},"• "+u(a),1))),128))]),e("ul",qt,[(g(!0),c(M,null,S(l.stops,a=>(g(),c("li",{key:a},"• "+u(a),1))),128))])]),e("div",null,[t[30]||(t[30]=e("h5",{class:"mb-2 font-medium text-gray-900"},"รายละเอียดรถ",-1)),e("ul",Wt,[(g(!0),c(M,null,S(l.carDetails,a=>(g(),c("li",{key:a},"• "+u(a),1))),128))])])]),e("div",Jt,[l.conditions?(g(),c("div",Qt,[t[31]||(t[31]=e("h5",{class:"mb-2 font-medium text-gray-900"},"เงื่อนไขการเดินทาง",-1)),e("p",Xt,u(l.conditions),1)])):h("",!0),l.photos&&l.photos.length>0?(g(),c("div",Yt,[t[32]||(t[32]=e("h5",{class:"mb-2 font-medium text-gray-900"},"รูปภาพรถยนต์",-1)),e("div",Rt,[(g(!0),c(M,null,S(l.photos.slice(0,3),(a,n)=>(g(),c("div",{key:n,class:""},[e("img",{src:a,alt:"Vehicle photo",class:"object-cover w-full transition-opacity border border-gray-300 rounded-lg shadow-sm cursor-pointer aspect-video hover:opacity-90"},null,8,el)]))),128))])])):h("",!0)]),e("div",tl,[e("button",{onClick:X(a=>Ge(l),["stop"]),disabled:l.availableSeats===0,class:"px-6 py-2 text-white transition duration-200 bg-blue-600 rounded-md hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed"}," จองที่นั่ง ",8,ll)])])):h("",!0)],8,ht))),128))]))])]),e("div",al,[e("div",sl,[t[33]||(t[33]=e("div",{class:"p-6 border-b border-gray-300"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"แผนที่เส้นทาง")],-1)),e("div",{ref_key:"mapContainer",ref:re,class:"h-96"},null,512)])])])]),Ie(Ne,{name:"modal-fade"},{default:$e(()=>[ue.value&&b.value?(g(),c("div",{key:0,class:"modal-overlay",onClick:X(J,["self"])},[e("div",nl,[$.value?(g(),c(M,{key:1},[e("div",il,[e("h3",rl," เลือก"+u($.value==="pickup"?"จุดขึ้นรถ":"จุดลงรถ"),1),e("button",{onClick:Ce,class:"text-gray-400 hover:text-gray-600"},t[36]||(t[36]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",dl,[e("div",{ref_key:"bookingPickerMapEl",ref:ve,class:"w-full",style:{height:"72vh"}},null,512),e("div",ul,[e("div",cl,[t[37]||(t[37]=e("span",{class:"font-medium"},"ตำแหน่ง:",-1)),e("span",gl,u(w.value.name||"— ยังไม่เลือก —"),1)]),e("button",{class:"px-4 py-2 text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed",disabled:!w.value.name,onClick:Xe}," ใช้ตำแหน่งนี้ ",8,ml)])])],64)):(g(),c("div",ol,[t[35]||(t[35]=e("h3",{class:"text-xl font-semibold text-gray-900"},"ยืนยันการจอง",-1)),e("button",{onClick:J,class:"text-gray-400 hover:text-gray-600"},t[34]||(t[34]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))])),e("div",pl,[e("div",vl,[t[39]||(t[39]=e("h4",{class:"mb-3 font-semibold text-gray-900"},"เดินทางกับ",-1)),e("div",fl,[e("img",{src:b.value.driver.image,alt:b.value.driver.name,class:"object-cover w-12 h-12 rounded-full"},null,8,bl),e("div",null,[e("div",yl,[e("div",xl,u(b.value.driver.name),1),b.value.driver.isVerified?(g(),c("div",_l,t[38]||(t[38]=[e("svg",{class:"w-5 h-5 text-blue-600",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8.603 3.799A4.49 4.49 0 0112 2.25c1.357 0 2.573.6 3.397 1.549a4.49 4.49 0 013.498 1.307 4.491 4.491 0 011.307 3.497A4.49 4.49 0 0121.75 12c0 1.357-.6 2.573-1.549 3.397a4.49 4.49 0 01-1.307 3.498 4.491 4.491 0 01-3.497 1.307A4.49 4.49 0 0112 21.75a4.49 4.49 0 01-3.397-1.549 4.49 4.49 0 01-3.498-1.306 4.491 4.491 0 01-1.307-3.498A4.49 4.49 0 012.25 12c0-1.357.6-2.573 1.549-3.397a4.49 4.49 0 011.307-3.497 4.49 4.49 0 013.497-1.307zm7.007 6.387a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.07-.01l3.5-4.875z","clip-rule":"evenodd"})],-1),e("span",{class:"absolute px-2 py-1 mb-2 text-xs text-white transition-opacity -translate-x-1/2 bg-gray-800 rounded-md opacity-0 pointer-events-none bottom-full left-1/2 w-max group-hover:opacity-100"}," ผู้ขับขี่ยืนยันตัวตนแล้ว ",-1)]))):h("",!0)]),e("div",hl,[e("div",wl,[(g(),c(M,null,S(5,l=>e("span",{key:l},u(l<=b.value.driver.rating?"★":"☆"),1)),64))]),e("span",kl,u(b.value.driver.rating)+" ("+u(b.value.driver.reviews)+" รีวิว)",1)])])])]),e("div",Ml,[e("div",null,[t[40]||(t[40]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"วันที่เดินทาง",-1)),e("div",Pl,u(b.value.date),1)]),e("div",null,[t[41]||(t[41]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"เวลาออก",-1)),e("div",Cl,u(b.value.departureTime),1)])]),e("div",Ll,[t[45]||(t[45]=e("h4",{class:"mb-3 font-semibold text-gray-900"},"เส้นทางการเดินทาง",-1)),e("div",Tl,[e("div",Al,[e("div",Bl,u(b.value.originName),1),t[42]||(t[42]=e("div",{class:"text-sm text-gray-600"},"จุดเริ่มต้น",-1))]),t[44]||(t[44]=e("div",{class:"text-blue-600"},[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})])],-1)),e("div",Il,[e("div",Sl,u(b.value.destinationName),1),t[43]||(t[43]=e("div",{class:"text-sm text-gray-600"},"จุดปลายทาง",-1))])])]),e("div",$l,[e("div",null,[t[46]||(t[46]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"จำนวนที่นั่งที่ต้องการจอง",-1)),V(e("select",{"onUpdate:modelValue":t[6]||(t[6]=l=>F.value=l),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},[(g(!0),c(M,null,S(b.value.availableSeats,l=>(g(),c("option",{key:l,value:l},u(l)+" ที่นั่ง ",9,Nl))),128))],512),[[Se,F.value]])]),e("div",null,[t[48]||(t[48]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"เลือกจุดขึ้นรถ",-1)),e("div",Vl,[V(e("input",{ref_key:"pickupInputEl",ref:ee,"onUpdate:modelValue":t[7]||(t[7]=l=>A.value=l),type:"text",placeholder:"พิมพ์ชื่อสถานที่...",class:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[K,A.value]]),e("button",{type:"button",onClick:t[8]||(t[8]=l=>Pe("pickup")),class:"absolute inset-y-0 my-auto text-gray-500 right-2 hover:text-blue-600",title:"เลือกจากแผนที่"},t[47]||(t[47]=[e("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M12 2a7 7 0 00-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 00-7-7zm0 9.5a2.5 2.5 0 110-5 2.5 2.5 0 010 5z"})],-1)]))])]),e("div",null,[t[50]||(t[50]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"เลือกจุดลงรถ",-1)),e("div",jl,[V(e("input",{ref_key:"dropoffInputEl",ref:te,"onUpdate:modelValue":t[9]||(t[9]=l=>B.value=l),type:"text",placeholder:"พิมพ์ชื่อสถานที่...",class:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[K,B.value]]),e("button",{type:"button",onClick:t[10]||(t[10]=l=>Pe("dropoff")),class:"absolute inset-y-0 my-auto text-gray-500 right-2 hover:text-blue-600",title:"เลือกจากแผนที่"},t[49]||(t[49]=[e("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M12 2a7 7 0 00-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 00-7-7zm0 9.5a2.5 2.5 0 110-5 2.5 2.5 0 010 5z"})],-1)]))])])]),e("div",zl,[e("div",El,[t[51]||(t[51]=e("span",{class:"text-gray-700"},"ราคาต่อที่นั่ง",-1)),e("span",Fl,u(b.value.price)+" บาท",1)]),e("div",Dl,[t[52]||(t[52]=e("span",{class:"text-gray-700"},"จำนวนที่นั่ง",-1)),e("span",Ol,u(F.value)+" ที่นั่ง",1)]),e("div",Ul,[e("div",Kl,[t[53]||(t[53]=e("span",{class:"font-semibold text-gray-900"},"ยอดรวม",-1)),e("span",Gl,u(De.value)+" บาท",1)])])]),e("div",{class:"flex space-x-4"},[e("button",{onClick:J,class:"flex-1 px-4 py-3 font-semibold text-gray-800 transition duration-200 bg-gray-200 rounded-md hover:bg-gray-300"}," ยกเลิก "),e("button",{onClick:He,class:"flex-1 px-4 py-3 font-semibold text-white transition duration-200 bg-blue-600 rounded-md hover:bg-blue-700"}," ยืนยันการจอง ")])])])])):h("",!0)]),_:1}),Ie(Ne,{name:"modal-fade"},{default:$e(()=>[oe.value?(g(),c("div",{key:0,class:"modal-overlay",onClick:X(Q,["self"])},[e("div",Hl,[e("div",Zl,[e("h3",ql,"เลือก"+u(j.value==="origin"?"จุดเริ่มต้น":"จุดปลายทาง"),1),e("button",{onClick:Q,class:"text-gray-400 hover:text-gray-600"},t[54]||(t[54]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",Wl,[e("div",{ref_key:"placePickerMapEl",ref:fe,class:"w-full border border-gray-200 rounded-md h-80"},null,512),e("div",Jl,[t[55]||(t[55]=e("div",{class:"font-medium"},"ตำแหน่งที่เลือก:",-1)),e("div",Ql,u(x.value.name||"— ยังไม่เลือก —"),1),x.value.lat&&x.value.lng?(g(),c("div",Xl," lat: "+u(x.value.lat.toFixed(6))+", lng: "+u(x.value.lng.toFixed(6)),1)):h("",!0)]),e("div",Yl,[e("button",{onClick:Q,class:"flex-1 px-4 py-2 font-semibold text-gray-800 bg-gray-200 rounded-md hover:bg-gray-300"}," ยกเลิก "),e("button",{disabled:!x.value.name,onClick:qe,class:"flex-1 px-4 py-2 font-semibold text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed"}," ใช้ตำแหน่งนี้ ",8,Rl)])])])])):h("",!0)]),_:1})]))}},da=Ye(ea,[["__scopeId","data-v-311b9a2b"]]);export{da as default};
