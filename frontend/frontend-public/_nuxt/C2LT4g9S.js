import{_ as Xe,m as Ye,r as b,A as et,a5 as tt,y as ne,i as lt,c as M,a as t,b as Be,f as Ne,d as V,h as $,v as B,F as Ee,q as Ue,z as at,t as D,w as nt,T as st,B as ze,o as T,g as De,s as ot,C as rt}from"./DPSIKoxe.js";import{u as it}from"./BaxiziUg.js";import{V as dt}from"./CGg3eoUs.js";const ut={class:"max-w-4xl px-4 py-8 mx-auto sm:px-6 lg:px-8"},ct={class:"p-8 bg-white border border-gray-300 rounded-lg shadow-md"},pt={class:"grid grid-cols-1 gap-6 md:grid-cols-2"},mt={class:"relative"},gt={class:"relative"},vt={class:"mt-6"},ft={class:"space-y-4"},bt=["onUpdate:modelValue","placeholder"],yt={class:"absolute inset-y-0 flex items-center gap-2 my-auto right-2"},xt=["onClick"],ht=["onClick"],Pt={class:"grid grid-cols-1 gap-6 md:grid-cols-2"},kt={key:0,class:"grid items-center grid-cols-1 gap-6 md:grid-cols-2"},wt=["value"],St={class:"self-end"},It={key:1,class:"p-8 bg-white border border-gray-300 shadow-xl rounded-xl"},Ct={class:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 bg-[#F2F2F2] p-4 md:px-6 md:py-6 rounded-[8px]"},_t={class:"flex justify-end gap-4 pt-6"},At=["disabled"],Lt={class:"modal-content"},Mt={class:"flex items-center justify-between p-4 border-b border-gray-300"},$t={class:"text-lg font-semibold text-gray-900"},Tt={class:"p-4 space-y-3"},Vt={class:"text-sm text-gray-700"},Bt={class:"truncate"},Nt={key:0,class:"text-gray-500"},Et={class:"flex gap-3 pt-2"},Ut=["disabled"],se="__gmapsReadyEditTrip__",zt={__name:"edit",setup(Dt){var me;const{$api:Fe}=Ye(),{toast:J}=ot(),R=b(!1),j=b(!1),Q=b([]),v=b([]),N=b([]),X=b([]);let Y=[];const o=et({vehicleId:"",startPoint:"",endPoint:"",date:"",time:"",availableSeats:null,pricePerSeat:null,conditions:""}),ee=b(null),te=b(null);let E=null,U=null;const I=b({lat:null,lng:null,name:null,address:null,placeId:null}),C=b({lat:null,lng:null,name:null,address:null,placeId:null}),le=b(!1),A=b(null),oe=b(null);let Z=null,q=null;const p=b({name:"",lat:null,lng:null});let re=null,O=null;const ie=tt().params.id,je=ne(),qe=[];(me=window.google)!=null&&me.maps||qe.push({key:"gmaps",src:`https://maps.googleapis.com/maps/api/js?key=${je.public.googleMapsApiKey}&libraries=places&callback=${se}`,async:!0,defer:!0}),it({});const u=b(null);async function Oe(){const a=(ne().public.apiBase||"http://localhost:3000/api").replace(/\/$/,""),e=await fetch(`${a}/routes/${ie}`,{method:"GET",headers:{Accept:"application/json"},credentials:"include"}),l=await e.json();if(!e.ok)throw new Error((l==null?void 0:l.message)||"Failed to load route");const r=(l==null?void 0:l.data)||l;if(u.value=r,o.vehicleId=r.vehicleId||"",o.conditions=r.conditions||"",o.availableSeats=r.availableSeats??null,o.pricePerSeat=r.pricePerSeat??null,r.departureTime){const s=new Date(r.departureTime);o.date=s.toISOString().slice(0,10),o.time=s.toTimeString().slice(0,5)}const n=r.startLocation||{},i=r.endLocation||{};o.startPoint=n.name||n.address||"",o.endPoint=i.name||i.address||"",I.value={lat:n.lat??null,lng:n.lng??null,name:n.name||null,address:n.address||null,placeId:n.placeId||null},C.value={lat:i.lat??null,lng:i.lng??null,name:i.name||null,address:i.address||null,placeId:i.placeId||null};const d=ce(r.waypoints);v.value=d.map(s=>({text:(s==null?void 0:s.name)||(s==null?void 0:s.address)||""})),N.value=d.map(s=>({lat:(s==null?void 0:s.lat)??null,lng:(s==null?void 0:s.lng)??null,name:(s==null?void 0:s.name)||null,address:(s==null?void 0:s.address)||null,placeId:(s==null?void 0:s.placeId)||null}))}const de=async()=>{try{const a=await Fe("/vehicles");if(Q.value=a,a.length>0){const e=a.find(l=>l.isDefault)||a[0];o.vehicleId||(o.vehicleId=e.id)}}catch(a){console.error("Failed to fetch vehicles:",a)}},We=async()=>{R.value=!1,await de()};function Ke(){v.value.push({text:""}),N.value.push({lat:null,lng:null,name:null,address:null,placeId:null}),ze(()=>G(v.value.length-1))}function Re(a){v.value.splice(a,1),N.value.splice(a,1);const e=Y[a];e!=null&&e.unbindAll&&e.unbindAll(),Y.splice(a,1),X.value.splice(a,1)}function G(a){var n,i;if(!((i=(n=window.google)==null?void 0:n.maps)!=null&&i.places))return;const e=X.value[a];if(!e)return;const l={fields:["place_id","name","formatted_address","geometry"],types:["geocode","establishment"]},r=new google.maps.places.Autocomplete(e,l);Y[a]=r,r.addListener("place_changed",()=>{var w,x,f,S,z,W;const d=r.getPlace();if(!d)return;const s=((f=(x=(w=d.geometry)==null?void 0:w.location)==null?void 0:x.lat)==null?void 0:f.call(x))??null,c=((W=(z=(S=d.geometry)==null?void 0:S.location)==null?void 0:z.lng)==null?void 0:W.call(z))??null,y=d.name||F(L(d.formatted_address||""))||v.value[a].text,m=L(d.formatted_address||y||"");v.value[a].text=y,N.value[a]={lat:s,lng:c,name:y,address:m,placeId:d.place_id||null}})}function ue(){var l,r;if(!((r=(l=window.google)==null?void 0:l.maps)!=null&&r.places))return;re=new google.maps.Geocoder;const a=document.createElement("div");O=new google.maps.places.PlacesService(a);const e={fields:["place_id","name","formatted_address","geometry"],types:["geocode","establishment"]};ee.value&&(E!=null&&E.unbindAll&&E.unbindAll(),E=new google.maps.places.Autocomplete(ee.value,e),E.addListener("place_changed",()=>{var y,m,w,x,f,S;const n=E.getPlace();if(!n)return;const i=((w=(m=(y=n.geometry)==null?void 0:y.location)==null?void 0:m.lat)==null?void 0:w.call(m))??null,d=((S=(f=(x=n.geometry)==null?void 0:x.location)==null?void 0:f.lng)==null?void 0:S.call(f))??null,s=n.name||F(L(n.formatted_address||""))||o.startPoint,c=L(n.formatted_address||s||"");o.startPoint=s,I.value={lat:i,lng:d,name:s,address:c,placeId:n.place_id||null}})),te.value&&(U!=null&&U.unbindAll&&U.unbindAll(),U=new google.maps.places.Autocomplete(te.value,e),U.addListener("place_changed",()=>{var y,m,w,x,f,S;const n=U.getPlace();if(!n)return;const i=((w=(m=(y=n.geometry)==null?void 0:y.location)==null?void 0:m.lat)==null?void 0:w.call(m))??null,d=((S=(f=(x=n.geometry)==null?void 0:x.location)==null?void 0:f.lng)==null?void 0:S.call(f))??null,s=n.name||F(L(n.formatted_address||""))||o.endPoint,c=L(n.formatted_address||s||"");o.endPoint=s,C.value={lat:i,lng:d,name:s,address:c,placeId:n.place_id||null}}));for(let n=0;n<v.value.length;n++)G(n)}function ae(a){A.value=a,p.value={name:"",lat:null,lng:null},le.value=!0,ze(()=>{let e;if(a==="start")e=I.value;else if(a==="end")e=C.value;else if(String(a).startsWith("wp-")){const n=Number(String(a).split("-")[1]||-1);e=N.value[n]||{}}const l=e&&e.lat!=null&&e.lng!=null,r=l?{lat:e.lat,lng:e.lng}:{lat:13.7563,lng:100.5018};Z=new google.maps.Map(oe.value,{center:r,zoom:l?14:6,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1}),Z.addListener("click",n=>{const i=n.latLng;Ze(i),pe(i)})})}function ce(a){return Array.isArray(a)?a:a&&Array.isArray(a.used)?a.used:a&&Array.isArray(a.requested)?a.requested:[]}function Ze(a){if(q){q.setPosition(a);return}q=new google.maps.Marker({position:a,map:Z,draggable:!0}),q.addListener("dragend",e=>pe(e.latLng))}async function pe(a){const e=a.lat(),l=a.lng(),r=await new Promise(d=>{re.geocode({location:{lat:e,lng:l}},(s,c)=>{c==="OK"&&(s!=null&&s.length)?d(s[0]):d(null)})});let n="",i="";if(r!=null&&r.formatted_address&&(i=L(r.formatted_address),n=F(i)),r!=null&&r.place_id&&await new Promise(d=>{O.getDetails({placeId:r.place_id,fields:["name"]},(s,c)=>{c===google.maps.places.PlacesServiceStatus.OK&&(s!=null&&s.name)&&(n=s.name),d()})}),!n||He(n)){const d=await Je(e,l,150);d!=null&&d.place_id?await new Promise(s=>{O.getDetails({placeId:d.place_id,fields:["name","formatted_address"]},(c,y)=>{if(y===google.maps.places.PlacesServiceStatus.OK){const m=L((c==null?void 0:c.formatted_address)||n);n=(c==null?void 0:c.name)||F(m),i=m||i}s()})}):r!=null&&r.formatted_address&&(i=L(r.formatted_address),n=F(i))}p.value={name:n,address:i||n,lat:e,lng:l}}function Ge(){if(!A.value||!p.value.name)return;const a={lat:p.value.lat,lng:p.value.lng,name:p.value.name,address:p.value.address||p.value.name,placeId:null};if(A.value==="start")o.startPoint=p.value.name,I.value=a;else if(A.value==="end")o.endPoint=p.value.name,C.value=a;else if(String(A.value).startsWith("wp-")){const e=Number(String(A.value).split("-")[1]||-1);e>-1&&(v.value[e].text=p.value.name,N.value[e]=a)}H()}function H(){le.value=!1,A.value=null,q=null,Z=null}function He(a){return!!(a&&/^[A-Z0-9]{4,}\+[A-Z0-9]{2,}/i.test(a.trim()))}function L(a){return(a||"").replace(/,?\s*(Thailand|ไทย)\s*$/i,"")}function F(a){return(a||"").replace(/^[A-Z0-9]{4,}\+[A-Z0-9]{2,}\s*,?\s*/i,"")}function Je(a,e,l=120){return new Promise(r=>{if(!O)return r(null);O.nearbySearch({location:{lat:a,lng:e},radius:l},(n,i)=>{i===google.maps.places.PlacesServiceStatus.OK&&(n!=null&&n.length)?r(n[0]):r(null)})})}const Qe=async()=>{var n,i,d,s,c,y,m,w,x,f,S,z,W,ge,ve,fe,be,ye,xe,he,Pe,ke,we,Se,Ie,Ce,_e,Ae,Le,Me;if(j.value)return;if(!u.value){J.error("เกิดข้อผิดพลาด","ยังโหลดข้อมูลเดิมไม่เสร็จ ลองอีกครั้ง");return}j.value=!0;const a=o.date&&o.time?new Date(`${o.date}T${o.time}`).toISOString():((n=u.value)==null?void 0:n.departureTime)||new Date().toISOString(),e=ce((i=u.value)==null?void 0:i.waypoints),l=N.value.map((g,h)=>{var Te,Ve;const P=((Ve=(Te=u.value)==null?void 0:Te.waypoints)==null?void 0:Ve[h])||{},k=g&&g.name||v.value[h]&&v.value[h].text||P.name||P.address||null,_=g&&g.address||v.value[h]&&v.value[h].text||P.address||k||null,K=g&&g.lat!=null?Number(g.lat):P.lat??null,$e=g&&g.lng!=null?Number(g.lng):P.lng??null;return!k&&K==null&&$e==null?null:{lat:K,lng:$e,name:k,address:_}}).filter(Boolean),r={vehicleId:o.vehicleId||((d=u.value)==null?void 0:d.vehicleId),startLocation:{lat:I.value.lat!=null?Number(I.value.lat):((c=(s=u.value)==null?void 0:s.startLocation)==null?void 0:c.lat)??null,lng:I.value.lng!=null?Number(I.value.lng):((m=(y=u.value)==null?void 0:y.startLocation)==null?void 0:m.lng)??null,name:I.value.name||o.startPoint||((x=(w=u.value)==null?void 0:w.startLocation)==null?void 0:x.name)||((S=(f=u.value)==null?void 0:f.startLocation)==null?void 0:S.address)||null,address:I.value.address||o.startPoint||((W=(z=u.value)==null?void 0:z.startLocation)==null?void 0:W.address)||((ve=(ge=u.value)==null?void 0:ge.startLocation)==null?void 0:ve.name)||null},endLocation:{lat:C.value.lat!=null?Number(C.value.lat):((be=(fe=u.value)==null?void 0:fe.endLocation)==null?void 0:be.lat)??null,lng:C.value.lng!=null?Number(C.value.lng):((xe=(ye=u.value)==null?void 0:ye.endLocation)==null?void 0:xe.lng)??null,name:C.value.name||o.endPoint||((Pe=(he=u.value)==null?void 0:he.endLocation)==null?void 0:Pe.name)||((we=(ke=u.value)==null?void 0:ke.endLocation)==null?void 0:we.address)||null,address:C.value.address||o.endPoint||((Ie=(Se=u.value)==null?void 0:Se.endLocation)==null?void 0:Ie.address)||((_e=(Ce=u.value)==null?void 0:Ce.endLocation)==null?void 0:_e.name)||null},waypoints:l.length?l:e,optimizeWaypoints:!0,departureTime:a,availableSeats:o.availableSeats!=null?Number(o.availableSeats):((Ae=u.value)==null?void 0:Ae.availableSeats)??null,pricePerSeat:o.pricePerSeat!=null?Number(o.pricePerSeat):((Le=u.value)==null?void 0:Le.pricePerSeat)??null,conditions:o.conditions||((Me=u.value)==null?void 0:Me.conditions)||""};try{const g=(ne().public.apiBase||"http://localhost:3000/api").replace(/\/$/,"");let h="";try{const _=document.cookie.match(/(?:^|;\s*)token=([^;]+)/);_&&(h=decodeURIComponent(_[1]))}catch{}if(!h)try{h=localStorage.getItem("token")||""}catch{}const P=await fetch(`${g}/routes/${ie}`,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",...h?{Authorization:`Bearer ${h}`}:{}},body:JSON.stringify(r),credentials:"include"});let k;try{k=await P.json()}catch{const _=await P.text(),K=new Error(_||"Unexpected response from server");throw K.status=P.status,K}if(!P.ok){const _=new Error((k==null?void 0:k.message)||`Request failed with status ${P.status}`);throw _.status=P.status,_.payload=k,_}J.success("อัปเดตสำเร็จ",(k==null?void 0:k.message)||"แก้ไขเส้นทางเรียบร้อยแล้ว!"),setTimeout(()=>{rt("/myRoute")},1200)}catch(g){console.error("Failed to update route:",g);const h=String((g==null?void 0:g.message)||"");J.error("เกิดข้อผิดพลาด",h||"ไม่สามารถอัปเดตเส้นทางได้")}finally{j.value=!1}};return lt(()=>{var a,e;if(de(),Oe().catch(l=>console.error(l)),(e=(a=window.google)==null?void 0:a.maps)!=null&&e.places){ue();for(let l=0;l<v.value.length;l++)G(l)}else window[se]=()=>{try{delete window[se]}catch{}ue();for(let l=0;l<v.value.length;l++)G(l)}}),(a,e)=>(T(),M("div",null,[t("div",ut,[e[35]||(e[35]=t("div",{class:"mb-8"},[t("h2",{class:"mb-2 text-3xl font-bold text-gray-900"}," แก้ไขการเดินทางของคุณ "),t("p",{class:"text-gray-600"}," ปรับจุดเริ่มต้น ปลายทาง และรายละเอียดต่างๆ ของการเดินทางนี้ ")],-1)),t("div",ct,[t("form",{onSubmit:Ne(Qe,["prevent"]),id:"editRouteForm",novalidate:"",class:"space-y-8"},[t("div",null,[e[21]||(e[21]=t("h3",{class:"pb-2 mb-6 text-xl font-semibold text-gray-900 border-b border-gray-300"}," ข้อมูลเส้นทาง ",-1)),t("div",pt,[t("div",null,[e[14]||(e[14]=t("label",{for:"startPoint",class:"block mb-2 text-sm font-medium text-gray-700"},[V(" จุดเริ่มต้น "),t("span",{class:"text-red-500"},"*")],-1)),t("div",mt,[$(t("input",{ref_key:"startInputEl",ref:ee,"onUpdate:modelValue":e[0]||(e[0]=l=>o.startPoint=l),id:"startPoint",name:"startPoint",type:"text",placeholder:"เช่น กรุงเทพมหานคร, ถนนสุขุมวิท",required:"",class:"w-full px-4 py-3 pr-10 border border-gray-300 rounded-md focus:ring-blue-500"},null,512),[[B,o.startPoint]]),t("button",{type:"button",onClick:e[1]||(e[1]=l=>ae("start")),class:"absolute inset-y-0 my-auto text-gray-500 right-2 hover:text-blue-600",title:"เลือกจากแผนที่"},e[13]||(e[13]=[t("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[t("path",{d:"M12 2a7 7 0 00-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 00-7-7zm0 9.5a2.5 2.5 0 110-5 2.5 2.5 0 010 5z"})],-1)]))])]),t("div",null,[e[16]||(e[16]=t("label",{for:"endPoint",class:"block mb-2 text-sm font-medium text-gray-700"},[V(" จุดปลายทาง "),t("span",{class:"text-red-500"},"*")],-1)),t("div",gt,[$(t("input",{ref_key:"endInputEl",ref:te,"onUpdate:modelValue":e[2]||(e[2]=l=>o.endPoint=l),id:"endPoint",name:"endPoint",type:"text",placeholder:"เช่น เชียงใหม่, ถนนนิมมานเหมินท์",required:"",class:"w-full px-4 py-3 pr-10 border border-gray-300 rounded-md focus:ring-blue-500"},null,512),[[B,o.endPoint]]),t("button",{type:"button",onClick:e[3]||(e[3]=l=>ae("end")),class:"absolute inset-y-0 my-auto text-gray-500 right-2 hover:text-blue-600",title:"เลือกจากแผนที่"},e[15]||(e[15]=[t("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[t("path",{d:"M12 2a7 7 0 00-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 00-7-7zm0 9.5a2.5 2.5 0 110-5 2.5 2.5 0 010 5z"})],-1)]))])])]),t("div",vt,[e[20]||(e[20]=t("label",{class:"block mb-2 text-sm font-medium text-gray-700"}," จุดแวะ (เพิ่มได้หลายจุด) ",-1)),t("div",ft,[(T(!0),M(Ee,null,Ue(v.value,(l,r)=>(T(),M("div",{key:r,class:"relative"},[$(t("input",{ref_for:!0,ref:n=>X.value[r]=n,"onUpdate:modelValue":n=>l.text=n,type:"text",placeholder:`เช่น จุดรับ-ส่ง ระหว่างทาง (#${r+1})`,class:"w-full px-4 py-3 pr-20 border border-gray-300 rounded-md focus:ring-blue-500"},null,8,bt),[[B,l.text]]),t("div",yt,[t("button",{type:"button",class:"text-gray-500 hover:text-blue-600",onClick:n=>ae(`wp-${r}`),title:"เลือกจากแผนที่"},e[17]||(e[17]=[t("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M12 2a7 7 0 00-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 00-7-7zm0 9.5a2.5 2.5 0 110-5 2.5 2.5 0 010 5z"})],-1)]),8,xt),t("button",{type:"button",class:"text-gray-500 hover:text-red-600",onClick:n=>Re(r),title:"ลบจุดแวะนี้"},e[18]||(e[18]=[t("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M6 18L18 6M6 6l12 12"})],-1)]),8,ht)])]))),128)),t("button",{type:"button",onClick:Ke,class:"inline-flex items-center gap-2 px-3 py-2 text-sm text-white bg-blue-600 rounded-md cursor-pointer hover:bg-blue-700"},e[19]||(e[19]=[t("i",{class:"fa-solid fa-plus"},null,-1),V(" เพิ่มจุดแวะ ")]))])])]),t("div",null,[e[27]||(e[27]=t("h3",{class:"pb-2 mb-6 text-xl font-semibold text-gray-900 border-b border-gray-300"}," รายละเอียดการเดินทาง ",-1)),t("div",Pt,[t("div",null,[e[22]||(e[22]=t("label",{for:"travelDate",class:"block mb-2 text-sm font-medium text-gray-700"},[V(" วันที่เดินทาง "),t("span",{class:"text-red-500"},"*")],-1)),$(t("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>o.date=l),id:"travelDate",name:"travelDate",type:"date",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-blue-500"},null,512),[[B,o.date]])]),t("div",null,[e[23]||(e[23]=t("label",{for:"travelTime",class:"block mb-2 text-sm font-medium text-gray-700"},[V(" เวลาออกเดินทาง "),t("span",{class:"text-red-500"},"*")],-1)),$(t("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>o.time=l),id:"travelTime",name:"travelTime",type:"time",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-blue-500"},null,512),[[B,o.time]])]),t("div",null,[e[24]||(e[24]=t("label",{for:"seatCount",class:"block mb-2 text-sm font-medium text-gray-700"},[V(" จำนวนที่นั่งที่รับได้ "),t("span",{class:"text-red-500"},"*")],-1)),$(t("input",{"onUpdate:modelValue":e[6]||(e[6]=l=>o.availableSeats=l),id:"seatCount",name:"seatCount",type:"number",min:"1",placeholder:"กรอกจำนวนที่นั่ง (เช่น 4)",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-blue-500"},null,512),[[B,o.availableSeats,void 0,{number:!0}]]),e[25]||(e[25]=t("p",{class:"mt-1 text-xs text-gray-500"}," รถยนต์ส่วนบุคคลทั่วไปมี 4–5 ที่นั่ง หากใช้รถตู้/รถบัส ให้ระบุจำนวนได้ตามจริง ",-1))]),t("div",null,[e[26]||(e[26]=t("label",{for:"pricePerSeat",class:"block mb-2 text-sm font-medium text-gray-700"},[V(" ราคาต่อที่นั่ง (บาท) "),t("span",{class:"text-red-500"},"*")],-1)),$(t("input",{"onUpdate:modelValue":e[7]||(e[7]=l=>o.pricePerSeat=l),id:"pricePerSeat",name:"pricePerSeat",type:"number",min:"0",placeholder:"เช่น 250",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-blue-500"},null,512),[[B,o.pricePerSeat,void 0,{number:!0}]])])])]),t("div",null,[e[31]||(e[31]=t("h3",{class:"pb-2 mb-6 text-xl font-semibold text-gray-900 border-b border-gray-300"}," ข้อมูลรถยนต์ ",-1)),Q.value.length>0?(T(),M("div",kt,[t("div",null,[e[29]||(e[29]=t("label",{for:"vehicle",class:"block mb-2 text-sm font-medium text-gray-700"},[V(" เลือกรถยนต์ที่จะใช้ "),t("span",{class:"text-red-500"},"*")],-1)),$(t("select",{"onUpdate:modelValue":e[8]||(e[8]=l=>o.vehicleId=l),id:"vehicle",name:"vehicle",class:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-blue-500"},[e[28]||(e[28]=t("option",{disabled:"",value:""},"กรุณาเลือกรถยนต์",-1)),(T(!0),M(Ee,null,Ue(Q.value,l=>(T(),M("option",{key:l.id,value:l.id},D(l.vehicleModel)+" ("+D(l.licensePlate)+") ",9,wt))),128))],512),[[at,o.vehicleId]])]),t("div",St,[t("button",{type:"button",onClick:e[9]||(e[9]=l=>R.value=!0),class:"w-full px-4 py-3 text-sm text-gray-800 transition-colors bg-gray-100 rounded-md cursor-pointer md:w-auto hover:bg-gray-200"}," เพิ่ม / จัดการข้อมูลรถยนต์ ")])])):(T(),M("div",It,[t("div",Ct,[e[30]||(e[30]=t("p",{class:"text-gray-800 text-base md:text-[18px] text-center sm:text-left"}," คุณยังไม่มีข้อมูลรถยนต์ ",-1)),t("button",{type:"button",onClick:e[10]||(e[10]=l=>R.value=!0),class:"bg-[#2563EB] hover:bg-blue-600 text-white text-sm md:text-[16px] px-4 py-2 rounded-lg transition-colors whitespace-nowrap"}," เพิ่ม / จัดการข้อมูล ")])]))]),Be(dt,{show:R.value,onClose:We},null,8,["show"]),t("div",null,[e[32]||(e[32]=t("h3",{class:"pb-2 mb-6 text-xl font-semibold text-gray-900 border-b border-gray-300"}," เงื่อนไขและข้อตกลง ",-1)),$(t("textarea",{"onUpdate:modelValue":e[11]||(e[11]=l=>o.conditions=l),id:"terms",name:"terms",rows:"4",placeholder:"ระบุเงื่อนไข เช่น ไม่สูบบุหรี่, ไม่นำสัตว์เลี้ยง, ชำระเงินล่วงหน้า 50%",class:"w-full px-4 py-3 border border-gray-300 rounded-md resize-none focus:ring-blue-500"},null,512),[[B,o.conditions]])]),t("div",_t,[t("button",{type:"button",class:"px-6 py-3 text-gray-700 border border-gray-300 rounded-md cursor-pointer hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:e[12]||(e[12]=l=>a.$router.back())}," ยกเลิก "),t("button",{type:"submit",disabled:j.value,class:"px-6 py-3 font-medium text-white bg-blue-600 rounded-md cursor-pointer hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-400 disabled:cursor-not-allowed"},D(j.value?"กำลังอัปเดต...":"อัปเดตการเดินทาง"),9,At)])],32)]),Be(st,{name:"modal-fade"},{default:nt(()=>[le.value?(T(),M("div",{key:0,class:"modal-overlay",onClick:Ne(H,["self"])},[t("div",Lt,[t("div",Mt,[t("h3",$t," เลือก "+D(A.value==="start"?"จุดเริ่มต้น":A.value==="end"?"จุดปลายทาง":"จุดแวะ"),1),t("button",{onClick:H,class:"text-gray-400 hover:text-gray-600"},e[33]||(e[33]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),t("div",Tt,[t("div",{ref_key:"placePickerMapEl",ref:oe,class:"w-full border border-gray-200 rounded-md h-80"},null,512),t("div",Vt,[e[34]||(e[34]=t("div",{class:"font-medium"},"ตำแหน่งที่เลือก:",-1)),t("div",Bt,D(p.value.name||"— ยังไม่เลือก —"),1),p.value.lat&&p.value.lng?(T(),M("div",Nt," lat: "+D(p.value.lat.toFixed(6))+", lng: "+D(p.value.lng.toFixed(6)),1)):De("",!0)]),t("div",Et,[t("button",{onClick:H,class:"flex-1 px-4 py-2 font-semibold text-gray-800 bg-gray-200 rounded-md hover:bg-gray-300"}," ยกเลิก "),t("button",{disabled:!p.value.name,onClick:Ge,class:"flex-1 px-4 py-2 font-semibold text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed"}," ใช้ตำแหน่งนี้ ",8,Ut)])])])])):De("",!0)]),_:1})])]))}},Wt=Xe(zt,[["__scopeId","data-v-6f61815a"]]);export{Wt as default};
