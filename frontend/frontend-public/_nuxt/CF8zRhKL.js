import{_ as Ve}from"./Lcixqshc.js";import{_ as De,y as ye,a5 as Ke,J as qe,r as c,A as Ye,x as J,i as Ge,B as xe,H as Fe,c as p,b as W,a as l,w as _e,h as O,g as z,d as H,v as j,F as we,q as he,t as v,T as Qe,s as Je,C as ke,o as f,f as We}from"./DPSIKoxe.js";import{u as Xe}from"./BaxiziUg.js";import{A as Ze,_ as et}from"./CaCOxDSn.js";import{d as Ie}from"./B5yDJBm8.js";import{s as tt}from"./x_rD_Ya3.js";import"./DOK8vhV6.js";import"./Cpj98o6Y.js";const at={id:"main-content",class:"main-content mt-16 ml-0 lg:ml-[280px] p-6 min-h-screen"},lt={class:"mx-auto max-w-7xl"},st={class:"mb-8"},nt={class:"flex w-full overflow-hidden bg-white border border-gray-300 rounded-lg shadow-lg"},ot={class:"flex-1 p-8 space-y-8"},it={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},ut={class:"relative"},rt={key:0,class:"absolute z-20 w-full mt-1 overflow-auto bg-white border rounded-md shadow max-h-60"},dt=["onClick"],ct={class:"text-sm font-medium text-gray-800"},mt={class:"text-xs text-gray-500"},pt={key:0,class:"px-3 py-2 text-sm text-gray-500"},ft={key:1,class:"mt-2 text-xs text-amber-600"},vt={key:2,class:"mt-2 text-xs text-gray-600 truncate"},gt={class:"relative"},bt={key:0,class:"absolute z-20 w-full mt-1 overflow-auto bg-white border rounded-md shadow max-h-60"},yt=["onClick"],xt={class:"text-sm font-medium text-gray-800"},_t={key:0,class:"text-xs text-gray-500"},wt={class:"text-xs text-gray-500"},ht={key:0,class:"px-3 py-2 text-sm text-gray-500"},kt={key:1,class:"mt-2 text-xs text-amber-600"},It={key:2,class:"mt-2 text-xs text-gray-600 truncate"},St={class:"grid grid-cols-1 gap-4 sm:grid-cols-3"},$t=["max"],Lt={class:"mt-1 text-xs text-gray-500"},Pt=["value"],Ct=["value"],Bt={class:"grid grid-cols-1 gap-4 mt-4 sm:grid-cols-2"},Tt={class:"relative"},zt={class:"relative"},Mt={class:"flex justify-end gap-4 pt-2"},Ut=["disabled"],Nt=["disabled"],Rt={key:0,class:"w-5 h-5 mr-3 -ml-1 text-white animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},At={class:"bg-white rounded-lg w-[95%] max-w-3xl overflow-hidden"},Et={class:"flex items-center justify-between p-4 border-b border-gray-300"},Ot={class:"text-lg font-semibold text-gray-900"},Ht={class:"p-0"},jt={class:"flex items-center justify-between p-4 border-t border-gray-200"},Vt={class:"text-sm text-gray-700 truncate"},Dt={class:"truncate"},Kt=["disabled"],qt={__name:"edit",setup(Yt){var ge,be;Ie.locale("th"),Xe({script:(ge=window.google)!=null&&ge.maps?[]:[{src:`https://maps.googleapis.com/maps/api/js?key=${ye().public.googleMapsApiKey}&libraries=places,geometry`,async:!0,defer:!0}]});const X=Ke().params.id,{toast:R}=Je(),V=ye(),L=((be=qe("token"))==null?void 0:be.value)||localStorage.getItem("token"),M=c(!1),_=Ye({numberOfSeats:1,status:""}),w=c(""),h=c(""),k=c({lat:null,lng:null,placeId:null,address:null,name:null}),I=c({lat:null,lng:null,placeId:null,address:null,name:null}),S=c(""),U=c(""),$=c(null),D=c(""),P=c([]),K=c(!1),Z=c(""),b=c(""),C=c(""),q=c(""),B=c([]),Y=c(!1),G=c(""),Se=J(()=>S.value&&(K.value||P.value.length>0)),$e=J(()=>b.value&&(Y.value||B.value.length>0));function ne(t){var a,o;const e=((a=t.startLocation)==null?void 0:a.name)||"ต้นทาง",s=((o=t.endLocation)==null?void 0:o.name)||"ปลายทาง",n=t.driver?`${t.driver.firstName||""} ${t.driver.lastName||""}`.trim():"";return`${e} → ${s}${n?" • "+n:""}`}function ee(t){return t?Ie(t).format("D MMM YYYY HH:mm"):"-"}let oe=null;async function Le(){S.value!==Z.value&&(U.value="",$.value=null,D.value=""),clearTimeout(oe);const t=S.value.trim();if(!t){P.value=[];return}oe=setTimeout(async()=>{try{K.value=!0;const e=await $fetch("/routes/admin",{baseURL:V.public.apiBase,headers:{Accept:"application/json",...L?{Authorization:`Bearer ${L}`}:{}},query:{q:t,page:1,limit:10}});P.value=(e==null?void 0:e.data)||[]}catch{P.value=[]}finally{K.value=!1}},300)}function ie(t){U.value=t.id,$.value=t;const e=`${ne(t)} • ${ee(t.departureTime)}`;S.value=e,Z.value=e,D.value=e,P.value=[]}let ue=null;async function Pe(){b.value!==G.value&&(C.value=""),clearTimeout(ue);const t=b.value.trim();if(!t){B.value=[];return}ue=setTimeout(async()=>{try{Y.value=!0;const e=await $fetch("/users/admin",{baseURL:V.public.apiBase,headers:{Accept:"application/json",...L?{Authorization:`Bearer ${L}`}:{}},query:{q:t,page:1,limit:10}});B.value=(e==null?void 0:e.data)||[]}catch{B.value=[]}finally{Y.value=!1}},300)}function Ce(t){C.value=t.id;const e=`${t.firstName||""} ${t.lastName||""} (${t.username?"@"+t.username:t.email})`;b.value=e,G.value=e,q.value=e,B.value=[]}const te=c(null),ae=c(null),N=c(null),re=c(null);let F=null,A=null,E=null,T=null;const y=c({name:"",lat:null,lng:null,placeId:null,address:null});function de(){var t;if((t=window.google)!=null&&t.maps&&(E||(E=new google.maps.Geocoder),!T)){const e=document.createElement("div"),s=new google.maps.Map(e,{center:{lat:13.7563,lng:100.5018},zoom:3});T=new google.maps.places.PlacesService(s)}}function ce(){var e,s;if(!((s=(e=window.google)==null?void 0:e.maps)!=null&&s.places))return;de();const t={fields:["place_id","name","formatted_address","geometry"],types:["geocode","establishment"],componentRestrictions:{country:["th"]}};if(te.value){const n=new google.maps.places.Autocomplete(te.value,t);n.addListener("place_changed",()=>{var o,i,r,u,d,m;const a=n.getPlace();a&&(w.value=a.name||a.formatted_address||w.value,k.value={lat:((r=(i=(o=a.geometry)==null?void 0:o.location)==null?void 0:i.lat)==null?void 0:r.call(i))??null,lng:((m=(d=(u=a.geometry)==null?void 0:u.location)==null?void 0:d.lng)==null?void 0:m.call(d))??null,placeId:a.place_id||null,address:a.formatted_address||null,name:a.name||null})})}if(ae.value){const n=new google.maps.places.Autocomplete(ae.value,t);n.addListener("place_changed",()=>{var o,i,r,u,d,m;const a=n.getPlace();a&&(h.value=a.name||a.formatted_address||h.value,I.value={lat:((r=(i=(o=a.geometry)==null?void 0:o.location)==null?void 0:i.lat)==null?void 0:r.call(i))??null,lng:((m=(d=(u=a.geometry)==null?void 0:u.location)==null?void 0:d.lng)==null?void 0:m.call(d))??null,placeId:a.place_id||null,address:a.formatted_address||null,name:a.name||null})})}}function Be(){var e,s;if((s=(e=window.google)==null?void 0:e.maps)!=null&&s.places){ce();return}const t=tt(()=>{var n,a;(a=(n=window.google)==null?void 0:n.maps)!=null&&a.places&&(clearInterval(t),ce())},100)}function me(t){N.value=t,y.value={name:"",lat:null,lng:null,placeId:null,address:null},xe(()=>{de();const e={lat:13.7563,lng:100.5018},s=t==="pickup"?k.value:I.value,n=s.lat&&s.lng?{lat:s.lat,lng:s.lng}:e;F=new google.maps.Map(re.value,{center:n,zoom:s.lat?15:6,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1}),F.addListener("click",async a=>{const o=a.latLng;Te(o),await pe(o)})})}function le(){N.value=null,F=null,A=null}function Te(t){if(A)return A.setPosition(t);A=new google.maps.Marker({position:t,map:F,draggable:!0}),A.addListener("dragend",e=>pe(e.latLng))}async function pe(t){const e=t.lat(),s=t.lng(),n=await new Promise(r=>{E.geocode({location:{lat:e,lng:s}},(u,d)=>{d==="OK"&&(u!=null&&u.length)?r(u[0]):r(null)})});let a="",o=(n==null?void 0:n.place_id)||null,i=(n==null?void 0:n.formatted_address)||null;if(n&&(a=await Ue(n)),!a){const r=await Me(e,s,120);if(r!=null&&r.place_id){o=r.place_id;const u=await new Promise(d=>{T.getDetails({placeId:r.place_id,fields:["name","formatted_address"]},(m,g)=>d(g===google.maps.places.PlacesServiceStatus.OK?m:null))});a=(u==null?void 0:u.name)||r.name||a,i=(u==null?void 0:u.formatted_address)||i}}i&&(i=i.replace(/,?\s*(Thailand|ไทย|ประเทศ)\s*$/i,"")),y.value={name:a,lat:e,lng:s,placeId:o,address:i}}function ze(){if(!N.value||!y.value.name)return;const t={lat:y.value.lat,lng:y.value.lng,placeId:y.value.placeId,address:y.value.address,name:y.value.name};N.value==="pickup"?(w.value=t.name||t.address||"",k.value=t):(h.value=t.name||t.address||"",I.value=t),le()}function Me(t,e,s=100){return new Promise(n=>{if(!T)return n(null);T.nearbySearch({location:{lat:t,lng:e},radius:s},(a,o)=>{o===google.maps.places.PlacesServiceStatus.OK&&(a!=null&&a.length)?n(a[0]):n(null)})})}async function Ue(t){const e=t.address_components||[],s=m=>{var g;return(g=e.find(x=>x.types.includes(m)))==null?void 0:g.long_name},n=m=>{var g;return(g=e.find(x=>x.types.includes(m)))==null?void 0:g.short_name},a=t.types||[];if((a.includes("point_of_interest")||a.includes("establishment")||a.includes("premise"))&&t.place_id&&T){const m=await new Promise(g=>{T.getDetails({placeId:t.place_id,fields:["name"]},(x,Q)=>g(Q===google.maps.places.PlacesServiceStatus.OK?x==null?void 0:x.name:null))});if(m)return m}const i=s("street_number"),r=s("route");let u=i&&r?`${i} ${r}`:r||t.formatted_address||"";const d=s("administrative_area_level_1")||n("administrative_area_level_1");return d&&(u=u.replace(new RegExp(`,?\\s*(${d}|Thailand|ไทย)\\s*$`,"i"),"")),u.trim()}const se=J(()=>{var t;return((t=$.value)==null?void 0:t.availableSeats)??null}),fe=J(()=>!!U.value&&!!C.value&&_.numberOfSeats>=1&&(!se.value||_.numberOfSeats<=se.value)&&(!!k.value.lat||!!w.value)&&(!!I.value.lat||!!h.value));async function ve(t){return new Promise(e=>{if(!t||!E)return e(null);E.geocode({address:t},(s,n)=>{var o,i,r,u,d,m,g,x,Q;if(n!=="OK"||!(s!=null&&s.length))return e(null);const a=s[0];e({lat:((r=(i=(o=a.geometry)==null?void 0:o.location)==null?void 0:i.lat)==null?void 0:r.call(i))??null,lng:((m=(d=(u=a.geometry)==null?void 0:u.location)==null?void 0:d.lng)==null?void 0:m.call(d))??null,placeId:a.place_id||null,address:((g=a.formatted_address)==null?void 0:g.replace(/,?\s*(Thailand|ไทย|ประเทศ)\s*$/i,""))||null,name:((Q=(x=a.address_components)==null?void 0:x[0])==null?void 0:Q.long_name)||a.formatted_address||null})})})}function Ne(t){var r,u,d;const e=(t==null?void 0:t.statusCode)||(t==null?void 0:t.status)||((r=t==null?void 0:t.response)==null?void 0:r.status)||((u=t==null?void 0:t.data)==null?void 0:u.statusCode),s=((d=t==null?void 0:t.data)==null?void 0:d.message)||(t==null?void 0:t.message)||"",n=String(s||"").trim(),a=n.toLowerCase();let o="เกิดข้อผิดพลาด",i=n||"ไม่สามารถบันทึกการจองได้";return/driver cannot book their own route/i.test(n)?(o="ไม่สามารถดำเนินการ",i="ผู้ขับไม่สามารถจองเส้นทางของตนเองได้ (Driver cannot book their own route.)"):/booking already exists|duplicate booking/i.test(a)||e===409?(o="ข้อมูลซ้ำ",i=n||"มีคำขอจองนี้อยู่ในระบบแล้ว"):/no available seats|route .* full|insufficient seats|exceeds available seats/i.test(a)?(o="ที่นั่งไม่เพียงพอ",i="จำนวนที่นั่งไม่พอหรือเส้นทางเต็มแล้ว"):/route not found/i.test(a)?(o="ไม่พบเส้นทาง",i="กรุณาเลือกเส้นทางใหม่อีกครั้ง"):/passenger not found|user not found/i.test(a)?(o="ไม่พบผู้โดยสาร",i="ตรวจสอบผู้โดยสารที่เลือกอีกครั้ง"):e===400?(o="ข้อมูลไม่ถูกต้อง",i=n||"รูปแบบข้อมูลไม่ถูกต้อง"):(e===401||e===403)&&(o="ไม่ได้รับอนุญาต",i="สิทธิ์ไม่เพียงพอสำหรับการกระทำนี้"),{title:o,body:i,status:e,raw:n}}async function Re(){if(!fe.value){R.warning("ข้อมูลไม่ครบถ้วน","กรุณาเลือกเส้นทาง/ผู้โดยสาร ระบุจำนวนที่นั่ง และกำหนดจุดรับ-ส่งให้ถูกต้อง");return}if(w.value&&!k.value.lat){const t=await ve(w.value);t&&(k.value=t)}if(h.value&&!I.value.lat){const t=await ve(h.value);t&&(I.value=t)}if(!k.value.lat||!I.value.lat){R.warning("ข้อมูลไม่ครบถ้วน","กรุณาเลือกจุดขึ้นรถและจุดลงรถจากรายการหรือปักหมุดบนแผนที่");return}M.value=!0;try{const t={routeId:U.value,passengerId:C.value,numberOfSeats:Number(_.numberOfSeats),pickupLocation:k.value,dropoffLocation:I.value,..._.status?{status:_.status}:{}};await $fetch(`/bookings/admin/${X}`,{baseURL:V.public.apiBase,method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",...L?{Authorization:`Bearer ${L}`}:{}},body:t}),R.success("บันทึกสำเร็จ","อัปเดตการจองเรียบร้อย"),ke(`/admin/bookings/${X}`).catch(()=>{})}catch(t){const e=Ne(t);console.error("Update booking error:",{status:e.status,message:e.raw}),R.error(e.title,e.body)}finally{M.value=!1}}function Ae(){ke("/admin/bookings")}async function Ee(){try{const t=await $fetch(`/bookings/admin/${X}`,{baseURL:V.public.apiBase,headers:{Accept:"application/json",...L?{Authorization:`Bearer ${L}`}:{}}}),e=(t==null?void 0:t.data)||t;_.numberOfSeats=Number((e==null?void 0:e.numberOfSeats)||1),_.status=(e==null?void 0:e.status)||"";const s=(e==null?void 0:e.passenger)||(e==null?void 0:e.user);if(s!=null&&s.id){C.value=s.id;const i=`${s.firstName||""} ${s.lastName||""} (${s.username?"@"+s.username:s.email||""})`.trim();b.value=i,G.value=i,q.value=i}else e!=null&&e.passengerId&&(C.value=e.passengerId,b.value=`ผู้โดยสาร: ${e.passengerId}`,G.value=b.value,q.value=b.value);const n=e==null?void 0:e.route;n!=null&&n.id?ie(n):e!=null&&e.routeId&&(U.value=e.routeId,S.value=`เส้นทาง: ${e.routeId}`,Z.value=S.value,D.value=S.value);const a=(e==null?void 0:e.pickupLocation)||{},o=(e==null?void 0:e.dropoffLocation)||{};k.value={lat:a.lat??null,lng:a.lng??null,placeId:a.placeId??null,address:a.address??null,name:a.name??null},I.value={lat:o.lat??null,lng:o.lng??null,placeId:o.placeId??null,address:o.address??null,name:o.name??null},w.value=a.name||a.address||"",h.value=o.name||o.address||""}catch(t){console.error("Load booking failed",t),R.error("ไม่สามารถโหลดข้อมูล","ไม่พบข้อมูลการจองหรือคุณไม่มีสิทธิ์เข้าถึง")}}function Oe(){const t=document.getElementById("sidebar"),e=document.getElementById("overlay");!t||!e||(t.classList.remove("mobile-open"),e.classList.add("hidden"))}function He(){window.__adminResizeHandler__=function(){const t=document.getElementById("sidebar"),e=document.getElementById("main-content"),s=document.getElementById("overlay");!t||!e||!s||(window.innerWidth>=1024?(t.classList.remove("mobile-open"),s.classList.add("hidden"),e.style.marginLeft=t.classList.contains("collapsed")?"80px":"280px"):e.style.marginLeft="0")},window.addEventListener("resize",window.__adminResizeHandler__)}function je(){window.removeEventListener("resize",window.__adminResizeHandler__||(()=>{})),delete window.__adminResizeHandler__}return Ge(()=>{He(),typeof window.__adminResizeHandler__=="function"&&window.__adminResizeHandler__(),xe(()=>Be()),Ee()}),Fe(()=>{je()}),(t,e)=>{var n;const s=Ve;return f(),p("div",null,[W(Ze),W(et),l("main",at,[l("div",lt,[l("div",st,[W(s,{to:"/admin/bookings",class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md hover:bg-gray-50"},{default:_e(()=>e[7]||(e[7]=[l("i",{class:"fa-solid fa-arrow-left"},null,-1),l("span",null,"ย้อนกลับ",-1)])),_:1,__:[7]})]),e[20]||(e[20]=l("div",{class:"flex flex-col gap-3 mb-6 sm:flex-row sm:items-center sm:justify-between"},[l("div",{class:"flex items-center gap-3"},[l("h1",{class:"text-2xl font-semibold text-gray-800"},"แก้ไขการจอง (แอดมิน)"),l("span",{class:"text-sm text-gray-500"},"ปรับเส้นทาง ผู้โดยสาร จำนวนที่นั่ง และจุดรับ-ส่ง")])],-1)),l("div",nt,[l("main",ot,[l("section",null,[e[10]||(e[10]=l("h3",{class:"mb-3 text-sm font-semibold text-gray-700"},"เส้นทางและผู้โดยสาร",-1)),l("div",it,[l("div",ut,[e[8]||(e[8]=l("label",{class:"block mb-2 text-sm font-medium text-gray-700"},[H(" เลือกเส้นทาง (ค้นหา: ต้นทาง/ปลายทาง/ผู้ขับ/เวลา) "),l("span",{class:"text-red-500"},"*")],-1)),O(l("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>S.value=a),onInput:Le,type:"text",placeholder:"เช่น มข. → เซ็นทรัล / ชื่อคนขับ / เวลา",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},null,544),[[j,S.value,void 0,{trim:!0}]]),Se.value?(f(),p("div",rt,[(f(!0),p(we,null,he(P.value,a=>(f(),p("button",{key:a.id,type:"button",onClick:o=>ie(a),class:"w-full px-3 py-2 text-left hover:bg-blue-50"},[l("div",ct,v(ne(a)),1),l("div",mt,v(ee(a.departureTime))+" • ที่นั่งคงเหลือ "+v(a.availableSeats)+" • ฿"+v(a.pricePerSeat)+"/ที่นั่ง ",1)],8,dt))),128)),!K.value&&P.value.length===0?(f(),p("div",pt," ไม่พบเส้นทางที่ตรงกับคำค้น ")):z("",!0)])):z("",!0),U.value?(f(),p("p",vt,"เลือกแล้ว: "+v(D.value),1)):(f(),p("p",ft,"* ต้องเลือกเส้นทางจากรายการ"))]),l("div",gt,[e[9]||(e[9]=l("label",{class:"block mb-2 text-sm font-medium text-gray-700"},[H(" เลือกผู้โดยสาร (ค้นหา: อีเมล / ชื่อ / Username) "),l("span",{class:"text-red-500"},"*")],-1)),O(l("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>b.value=a),onInput:Pe,type:"text",placeholder:"เช่น user1@gmail.com / User1",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},null,544),[[j,b.value,void 0,{trim:!0}]]),$e.value?(f(),p("div",bt,[(f(!0),p(we,null,he(B.value,a=>(f(),p("button",{key:a.id,type:"button",onClick:o=>Ce(a),class:"w-full px-3 py-2 text-left hover:bg-blue-50"},[l("div",xt,[H(v(a.firstName)+" "+v(a.lastName)+" ",1),a.username?(f(),p("span",_t,"(@"+v(a.username)+")",1)):z("",!0)]),l("div",wt,v(a.email),1)],8,yt))),128)),!Y.value&&B.value.length===0?(f(),p("div",ht," ไม่พบผู้ใช้ที่ตรงกับคำค้น ")):z("",!0)])):z("",!0),C.value?(f(),p("p",It,"เลือกแล้ว: "+v(q.value),1)):(f(),p("p",kt,"* ต้องเลือกผู้โดยสารจากรายการ"))])])]),l("section",null,[e[18]||(e[18]=l("h3",{class:"mb-3 text-sm font-semibold text-gray-700"},"รายละเอียดการจอง",-1)),l("div",St,[l("div",null,[e[11]||(e[11]=l("label",{class:"block mb-1 text-xs font-medium text-gray-600"},[H(" จำนวนที่นั่ง "),l("span",{class:"text-red-500"},"*")],-1)),O(l("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>_.numberOfSeats=a),type:"number",min:"1",max:se.value||void 0,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,8,$t),[[j,_.numberOfSeats,void 0,{number:!0}]]),l("p",Lt,v(((n=$.value)==null?void 0:n.availableSeats)!=null?`เลือกได้สูงสุด ${$.value.availableSeats} ที่นั่ง`:"กรุณาเลือกเส้นทางก่อน"),1)]),l("div",null,[e[12]||(e[12]=l("label",{class:"block mb-1 text-xs font-medium text-gray-600"},"ราคาต่อที่นั่ง (อ้างอิงจากเส้นทาง)",-1)),l("input",{value:$.value?$.value.pricePerSeat:"",disabled:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md disabled:bg-gray-100"},null,8,Pt)]),l("div",null,[e[13]||(e[13]=l("label",{class:"block mb-1 text-xs font-medium text-gray-600"},"เวลาออกเดินทาง",-1)),l("input",{value:$.value?ee($.value.departureTime):"",disabled:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md disabled:bg-gray-100"},null,8,Ct)])]),l("div",Bt,[l("div",null,[e[15]||(e[15]=l("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"เลือกจุดขึ้นรถ",-1)),l("div",Tt,[O(l("input",{ref_key:"pickupInputEl",ref:te,"onUpdate:modelValue":e[3]||(e[3]=a=>w.value=a),type:"text",placeholder:"พิมพ์ชื่อสถานที่...",class:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[j,w.value]]),l("button",{type:"button",onClick:e[4]||(e[4]=a=>me("pickup")),class:"absolute inset-y-0 my-auto text-gray-500 right-2 hover:text-blue-600",title:"เลือกจากแผนที่"},e[14]||(e[14]=[l("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 2a7 7 0 00-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 00-7-7zm0 9.5a2.5 2.5 0 110-5 2.5 2.5 0 010 5z"})],-1)]))])]),l("div",null,[e[17]||(e[17]=l("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"เลือกจุดลงรถ",-1)),l("div",zt,[O(l("input",{ref_key:"dropoffInputEl",ref:ae,"onUpdate:modelValue":e[5]||(e[5]=a=>h.value=a),type:"text",placeholder:"พิมพ์ชื่อสถานที่...",class:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[j,h.value]]),l("button",{type:"button",onClick:e[6]||(e[6]=a=>me("dropoff")),class:"absolute inset-y-0 my-auto text-gray-500 right-2 hover:text-blue-600",title:"เลือกจากแผนที่"},e[16]||(e[16]=[l("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 2a7 7 0 00-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 00-7-7zm0 9.5a2.5 2.5 0 110-5 2.5 2.5 0 010 5z"})],-1)]))])])])]),l("div",Mt,[l("button",{type:"button",onClick:Ae,disabled:M.value,class:"px-6 py-3 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-400 disabled:opacity-50"}," ยกเลิก ",8,Ut),l("button",{type:"button",onClick:Re,disabled:!fe.value||M.value,class:"flex items-center px-6 py-3 font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-blue-400 disabled:cursor-not-allowed"},[M.value?(f(),p("svg",Rt,e[19]||(e[19]=[l("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),l("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):z("",!0),H(" "+v(M.value?"กำลังบันทึก...":"บันทึกการเปลี่ยนแปลง"),1)],8,Nt)])])])])]),l("div",{id:"overlay",class:"fixed inset-0 z-40 hidden bg-black bg-opacity-50 lg:hidden",onClick:Oe}),W(Qe,{name:"modal-fade"},{default:_e(()=>[N.value?(f(),p("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/60",onClick:We(le,["self"])},[l("div",At,[l("div",Et,[l("h3",Ot,"เลือก"+v(N.value==="pickup"?"จุดขึ้นรถ":"จุดลงรถ"),1),l("button",{onClick:le,class:"text-gray-400 hover:text-gray-600"},e[21]||(e[21]=[l("i",{class:"fa-solid fa-xmark"},null,-1)]))]),l("div",Ht,[l("div",{ref_key:"bookingPickerMapEl",ref:re,class:"w-full",style:{height:"65vh"}},null,512),l("div",jt,[l("div",Vt,[e[22]||(e[22]=l("span",{class:"font-medium"},"ตำแหน่ง:",-1)),l("span",Dt,v(y.value.name||"— ยังไม่เลือก —"),1)]),l("button",{class:"px-4 py-2 text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed",disabled:!y.value.name,onClick:ze}," ใช้ตำแหน่งนี้ ",8,Kt)])])])])):z("",!0)]),_:1})])}}},aa=De(qt,[["__scopeId","data-v-b56e96ba"]]);export{aa as default};
