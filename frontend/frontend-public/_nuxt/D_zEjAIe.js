import{_ as Ne,m as $e,r as p,y as Ve,x as je,i as ze,c as r,a as e,b as ge,f as D,h as C,v as $,z as pe,t as o,g as x,F as k,q as M,w as ve,T as fe,B as Fe,o as d,d as be,n as Ie,C as ye,s as Ee}from"./DPSIKoxe.js";import{d as O}from"./B5yDJBm8.js";import{b as Ue}from"./C5FTVxxA.js";import{u as De}from"./DOK8vhV6.js";import{u as Oe}from"./BaxiziUg.js";import{s as Ke}from"./x_rD_Ya3.js";import"./Cpj98o6Y.js";const Ge={class:"px-4 py-8 mx-auto max-w-7xl sm:px-6 lg:px-8"},He={class:"p-6 mb-8 bg-white border border-gray-300 rounded-lg shadow-md"},Ze={class:"relative"},qe={class:"relative"},Re={class:"grid grid-cols-1 gap-6 lg:grid-cols-3"},We={class:"lg:col-span-2"},Je={class:"bg-white border border-gray-300 rounded-lg shadow-md"},Qe={class:"p-6 border-b border-gray-300"},Xe={class:"text-lg font-semibold text-gray-900"},Ye={key:0,class:"p-6 text-center text-gray-500"},et={key:1,class:"divide-y divide-gray-200"},tt={key:0,class:"p-6 text-center text-gray-500"},lt=["onClick"],st={class:"mb-6 font-semibold text-center text-gray-900"},at={class:"flex items-start space-x-4"},nt=["src","alt"],ot={class:"flex-1"},it={class:"flex items-start justify-between"},rt={class:"flex items-center"},dt={class:"font-semibold text-gray-900"},ut={key:0,class:"relative group ml-1.5 flex items-center"},ct={class:"flex items-center mt-1"},mt={class:"flex text-yellow-400"},gt={class:"ml-2 text-sm text-gray-600"},pt={class:"text-right"},vt={class:"text-lg font-bold text-blue-600"},ft={class:"mt-3"},bt={class:"flex flex-wrap items-center text-sm text-gray-600"},yt={class:"font-medium"},xt={class:"ml-1"},_t={class:"ml-1"},ht={class:"ml-1"},wt={class:"flex items-center mt-2 text-sm text-gray-600"},kt={key:0,class:"pt-4 mt-4 duration-300 border-t border-gray-300 animate-in slide-in-from-top"},Mt={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},Pt={class:"space-y-1 text-sm text-gray-600"},Ct={key:0},At={key:1},Lt={class:"space-y-1 text-sm text-gray-600"},St={class:"space-y-1 text-sm text-gray-600"},Tt={class:"mt-4 space-y-4"},Bt={key:0},Nt={class:"p-3 text-sm text-gray-700 border border-gray-300 rounded-md bg-gray-50"},$t={key:1},Vt={class:"grid grid-cols-3 gap-2 mt-2"},jt=["src"],zt={class:"flex justify-end mt-4"},Ft=["onClick","disabled"],It={class:"lg:col-span-1"},Et={class:"sticky overflow-hidden bg-white border border-gray-300 rounded-lg shadow-md top-8"},Ut={class:"modal-content"},Dt={class:"p-6"},Ot={class:"mb-6"},Kt={class:"flex items-center p-3 space-x-3 rounded-lg bg-gray-50"},Gt=["src","alt"],Ht={class:"flex items-center"},Zt={class:"font-medium text-gray-900"},qt={key:0,class:"relative group ml-1.5 flex items-center"},Rt={class:"flex items-center"},Wt={class:"flex text-sm text-yellow-400"},Jt={class:"ml-2 text-sm text-gray-600"},Qt={class:"grid grid-cols-1 gap-6 mb-6 md:grid-cols-2"},Xt={class:"p-3 text-gray-900 rounded-lg bg-gray-50"},Yt={class:"p-3 text-gray-900 rounded-lg bg-gray-50"},el={class:"mb-6"},tl={class:"flex items-center p-3 space-x-4 rounded-lg bg-gray-50"},ll={class:"flex-1"},sl={class:"font-medium text-gray-900"},al={class:"flex-1 text-right"},nl={class:"font-medium text-gray-900"},ol={class:"mb-6 space-y-4"},il=["value"],rl={class:"p-4 mb-6 rounded-lg bg-blue-50"},dl={class:"flex items-center justify-between mb-2"},ul={class:"font-medium text-gray-900"},cl={class:"flex items-center justify-between mb-2"},ml={class:"font-medium text-gray-900"},gl={class:"pt-2 mt-2 border-t border-gray-300"},pl={class:"flex items-center justify-between"},vl={class:"text-lg font-bold text-blue-600"},fl={class:"modal-content"},bl={class:"flex items-center justify-between p-4 border-b border-gray-300"},yl={class:"text-lg font-semibold text-gray-900"},xl={class:"p-4 space-y-3"},_l={class:"text-sm text-gray-700"},hl={class:"truncate"},wl={key:0,class:"text-gray-500"},kl={class:"flex gap-3 pt-2"},Ml=["disabled"],le="__gmapsReady__",Pl={__name:"index_v5",setup(Cl){var me;O.locale("th"),O.extend(Ue);const{$api:se}=$e(),{toast:K}=Ee(),{token:xe}=De(),_e=Ve(),G=p(null),H=p(null);let Z=null,q=null;const R=p(!1),A=p(null),ae=p(null);let V=null,S=null;const f=p({name:"",lat:null,lng:null}),he=[];(me=window.google)!=null&&me.maps||he.push({key:"gmaps",src:`https://maps.googleapis.com/maps/api/js?key=${_e.public.googleMapsApiKey}&libraries=places,geometry&callback=${le}`,async:!0,defer:!0}),Oe({});const c=p({origin:"",destination:"",date:"",seats:"1"}),b=p([]),P=p(null),W=p(!1),J=p(null);let _=null,j=null,z=null,F=null,I=null,T=null;const Q=p(!1),X=p(!1),m=p(null),L=p(1),B=p(""),N=p(""),we=je(()=>m.value?L.value*m.value.price:0);async function Y(){W.value=!0,P.value=null;try{const a=await se("/routes"),t=((a==null?void 0:a.data)||a||[]).filter(s=>s.status==="AVAILABLE");b.value=t.map(s=>{var n,i,u,v,g,y;return{id:s.id,availableSeats:s.availableSeats,price:s.pricePerSeat,departureTime:O(s.departureTime).format("HH:mm น."),date:O(s.departureTime).format("D MMMM BBBB"),start:s.startLocation,end:s.endLocation,originName:`(${s.startLocation.lat.toFixed(2)}, ${s.startLocation.lng.toFixed(2)})`,destinationName:`(${s.endLocation.lat.toFixed(2)}, ${s.endLocation.lng.toFixed(2)})`,driver:{name:`${((n=s.driver)==null?void 0:n.firstName)||""} ${((i=s.driver)==null?void 0:i.lastName)||""}`.trim()||"ไม่ระบุชื่อ",image:((u=s.driver)==null?void 0:u.profilePicture)||`https://ui-avatars.com/api/?name=${encodeURIComponent(((v=s.driver)==null?void 0:v.firstName)||"U")}&background=random&size=64`,rating:4.5,reviews:Math.floor(Math.random()*50)+5,isVerified:!!((g=s.driver)!=null&&g.isVerified)},carDetails:s.vehicle?[`${s.vehicle.vehicleModel} (${s.vehicle.vehicleType})`,...s.vehicle.amenities||[]]:["ไม่มีข้อมูลรถ"],conditions:s.conditions,photos:((y=s.vehicle)==null?void 0:y.photos)||[],durationText:s.duration||"-",distanceText:s.distance||"-",polyline:s.routePolyline||null}}),await oe();const l=b.value.map(async(s,n)=>{const[i,u]=await Promise.all([ne(s.start.lat,s.start.lng),ne(s.end.lat,s.end.lng)]),v=await ee(i),g=await ee(u);b.value[n].originName=v.name||b.value[n].originName,b.value[n].destinationName=g.name||b.value[n].destinationName,b.value[n].originArea=v.area||null,b.value[n].destinationArea=g.area||null});await Promise.allSettled(l)}catch(a){console.error("Failed to fetch routes:",a),b.value=[]}finally{W.value=!1}}function ne(a,t){return new Promise(l=>{if(!I)return l(null);I.geocode({location:{lat:a,lng:t}},(s,n)=>{if(n!=="OK"||!(s!=null&&s.length))return l(null);l(s[0])})})}async function ee(a){if(!a)return{name:null,area:null};const t=a.address_components||[],l=h=>{var w;return(w=t.find(te=>te.types.includes(h)))==null?void 0:w.long_name},s=h=>{var w;return(w=t.find(te=>te.types.includes(h)))==null?void 0:w.short_name},n=a.types||[],i=n.includes("point_of_interest")||n.includes("establishment")||n.includes("premise");let u=null;if(i&&a.place_id){const h=await Pe(a.place_id);h&&(u=h)}if(!u){const h=l("street_number"),w=l("route");u=h&&w?`${h} ${w}`:w||a.formatted_address||null}const v=l("sublocality")||l("neighborhood")||l("locality")||l("administrative_area_level_2"),g=l("administrative_area_level_1")||s("administrative_area_level_1");let y=null;return v&&g?y=`${v}, ${g}`:g&&(y=g),u&&(u=u.replace(/,?\s*(Thailand|ไทย)\s*$/i,"")),{name:u,area:y}}const ke=a=>{P.value&&P.value.id===a.id?(P.value=null,ie()):(P.value=a,Me(a))};function oe(){return new Promise(a=>{if(Q.value)return a(!0);const t=Ke(()=>{Q.value&&(clearInterval(t),a(!0))},50)})}function ie(){j&&(j.setMap(null),j=null),z&&(z.setMap(null),z=null),F&&(F.setMap(null),F=null)}async function Me(a){var t;if(a&&(await oe(),!(!_||!(_ instanceof google.maps.Map))))if(ie(),z=new google.maps.Marker({position:{lat:a.start.lat,lng:a.start.lng},map:_,label:"A"}),F=new google.maps.Marker({position:{lat:a.end.lat,lng:a.end.lng},map:_,label:"B"}),a.polyline&&((t=google.maps.geometry)!=null&&t.encoding)){const l=google.maps.geometry.encoding.decodePath(a.polyline);j=new google.maps.Polyline({path:l,map:_,strokeColor:"#2563eb",strokeOpacity:.9,strokeWeight:5});const s=new google.maps.LatLngBounds;l.forEach(n=>s.extend(n)),_.fitBounds(s)}else{const l=new google.maps.LatLng(Math.min(a.start.lat,a.end.lat),Math.min(a.start.lng,a.end.lng)),s=new google.maps.LatLng(Math.max(a.start.lat,a.end.lat),Math.max(a.start.lng,a.end.lng)),n=new google.maps.LatLngBounds(l,s);_.fitBounds(n)}}function Pe(a){return new Promise(t=>{if(!T||!a)return t(null);T.getDetails({placeId:a,fields:["name"]},(l,s)=>{s===google.maps.places.PlacesServiceStatus.OK&&(l!=null&&l.name)?t(l.name):t(null)})})}function Ce(a){if(!xe.value)return ye("/login");a&&a.availableSeats>0&&(m.value=a,L.value=1,B.value="",N.value="",X.value=!0)}function E(){X.value=!1,setTimeout(()=>{m.value=null},300)}async function Ae(){var t;if(!m.value)return;if(!B.value.trim()||!N.value.trim()){K.warning("ข้อมูลไม่ครบถ้วน","กรุณากรอกข้อมูลจุดรับและจุดส่งให้ครบถ้วน");return}const a={routeId:m.value.id,numberOfSeats:L.value,pickupLocation:{name:B.value,lat:16.432,lng:102.833},dropoffLocation:{name:N.value,lat:16.456,lng:102.876}};try{await se("/bookings",{method:"POST",body:a}),E(),K.success("ส่งคำขอจองสำเร็จ!","คำขอของคุณถูกส่งไปให้ผู้ขับแล้ว โปรดรอการยืนยัน"),setTimeout(()=>{ye("/myTrip")},1500)}catch(l){console.error("Failed to create booking:",l),K.error("เกิดข้อผิดพลาดในการจอง",((t=l.data)==null?void 0:t.message)||"โปรดลองใหม่อีกครั้งในภายหลัง")}}const re=()=>{!J.value||_||(_=new google.maps.Map(J.value,{center:{lat:13.7563,lng:100.5018},zoom:6,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!0}),I=new google.maps.Geocoder,T=new google.maps.places.PlacesService(_),Q.value=!0)};function de(){var t,l;if(!G.value||!H.value||!((l=(t=window.google)==null?void 0:t.maps)!=null&&l.places))return;const a={fields:["place_id","name","formatted_address","geometry"]};Z=new google.maps.places.Autocomplete(G.value,{...a,types:["geocode","establishment"]}),Z.addListener("place_changed",()=>{var n,i,u,v,g,y;const s=Z.getPlace();s&&(c.value.origin=s.name||s.formatted_address||c.value.origin,c.value._originMeta={placeId:s.place_id||null,fullAddress:s.formatted_address||null,lat:((u=(i=(n=s.geometry)==null?void 0:n.location)==null?void 0:i.lat)==null?void 0:u.call(i))??null,lng:((y=(g=(v=s.geometry)==null?void 0:v.location)==null?void 0:g.lng)==null?void 0:y.call(g))??null})}),q=new google.maps.places.Autocomplete(H.value,{...a,types:["geocode","establishment"]}),q.addListener("place_changed",()=>{var n,i,u,v,g,y;const s=q.getPlace();s&&(c.value.destination=s.name||s.formatted_address||c.value.destination,c.value._destinationMeta={placeId:s.place_id||null,fullAddress:s.formatted_address||null,lat:((u=(i=(n=s.geometry)==null?void 0:n.location)==null?void 0:i.lat)==null?void 0:u.call(i))??null,lng:((y=(g=(v=s.geometry)==null?void 0:v.location)==null?void 0:g.lng)==null?void 0:y.call(g))??null})})}function ue(a){A.value=a,f.value={name:"",lat:null,lng:null},R.value=!0,Fe(()=>{const t={lat:13.7563,lng:100.5018},l=a==="origin"?c.value._originMeta:c.value._destinationMeta,s=l!=null&&l.lat&&(l!=null&&l.lng)?{lat:l.lat,lng:l.lng}:t;V=new google.maps.Map(ae.value,{center:s,zoom:l!=null&&l.lat?14:6,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1}),V.addListener("click",n=>{const i=n.latLng;Le(i),ce(i)})})}function Le(a){if(S){S.setPosition(a);return}S=new google.maps.Marker({position:a,map:V,draggable:!0}),S.addListener("dragend",t=>{ce(t.latLng)})}async function ce(a){const t=a.lat(),l=a.lng(),s=await new Promise(i=>{I.geocode({location:{lat:t,lng:l}},(u,v)=>{v==="OK"&&(u!=null&&u.length)?i(u[0]):i(null)})});let n="";if(s&&(n=(await ee(s)).name||""),!n||Te(n)){const i=await Be(t,l,120);i!=null&&i.name?n=i.name:s!=null&&s.formatted_address&&(n=s.formatted_address.replace(/,?\s*(Thailand|ไทย)\s*$/i,""))}f.value={name:n,lat:t,lng:l}}function Se(){!A.value||!f.value.name||(A.value==="origin"?(c.value.origin=f.value.name,c.value._originMeta={placeId:null,fullAddress:null,lat:f.value.lat,lng:f.value.lng}):A.value==="destination"&&(c.value.destination=f.value.name,c.value._destinationMeta={placeId:null,fullAddress:null,lat:f.value.lat,lng:f.value.lng}),U())}function U(){R.value=!1,A.value=null,S=null,V=null}function Te(a){return a?/^[A-Z0-9]{4,}\+[A-Z0-9]{2,}/i.test(a.trim()):!1}function Be(a,t,l=100){return new Promise(s=>{if(!T)return s(null);T.nearbySearch({location:{lat:a,lng:t},radius:l},(n,i)=>{i===google.maps.places.PlacesServiceStatus.OK&&(n!=null&&n.length)?s(n[0]):s(null)})})}return ze(()=>{var a;if((a=window.google)!=null&&a.maps){re(),de(),Y();return}window[le]=()=>{try{delete window[le]}catch{}re(),de(),Y()}}),(a,t)=>(d(),r("div",null,[e("div",Ge,[e("div",He,[t[17]||(t[17]=e("h2",{class:"mb-6 text-xl font-semibold text-gray-900"},"ค้นหาการเดินทาง",-1)),e("form",{onSubmit:D(Y,["prevent"]),class:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-5"},[e("div",null,[t[10]||(t[10]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"จุดเริ่มต้น",-1)),e("div",Ze,[C(e("input",{ref_key:"originInputEl",ref:G,"onUpdate:modelValue":t[0]||(t[0]=l=>c.value.origin=l),type:"text",placeholder:"เช่น กรุงเทพฯ",class:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[$,c.value.origin]]),e("button",{type:"button",onClick:t[1]||(t[1]=l=>ue("origin")),class:"absolute inset-y-0 my-auto text-gray-500 right-2 hover:text-blue-600",title:"เลือกจากแผนที่"},t[9]||(t[9]=[e("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[e("path",{d:"M12 2a7 7 0 00-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 00-7-7zm0 9.5a2.5 2.5 0 110-5 2.5 2.5 0 010 5z"})],-1)]))])]),e("div",null,[t[12]||(t[12]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"จุดปลายทาง",-1)),e("div",qe,[C(e("input",{ref_key:"destinationInputEl",ref:H,"onUpdate:modelValue":t[2]||(t[2]=l=>c.value.destination=l),type:"text",placeholder:"เช่น เชียงใหม่",class:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[$,c.value.destination]]),e("button",{type:"button",onClick:t[3]||(t[3]=l=>ue("destination")),class:"absolute inset-y-0 my-auto text-gray-500 right-2 hover:text-blue-600",title:"เลือกจากแผนที่"},t[11]||(t[11]=[e("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[e("path",{d:"M12 2a7 7 0 00-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 00-7-7zm0 9.5a2.5 2.5 0 110-5 2.5 2.5 0 010 5z"})],-1)]))])]),e("div",null,[t[13]||(t[13]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"วันที่",-1)),C(e("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>c.value.date=l),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[$,c.value.date]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"จำนวนที่นั่ง",-1)),C(e("select",{"onUpdate:modelValue":t[5]||(t[5]=l=>c.value.seats=l),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},t[14]||(t[14]=[e("option",{value:"1"},"1 ที่นั่ง",-1),e("option",{value:"2"},"2 ที่นั่ง",-1),e("option",{value:"3"},"3 ที่นั่ง",-1),e("option",{value:"4"},"4 ที่นั่ง",-1)]),512),[[pe,c.value.seats]])]),t[16]||(t[16]=e("div",{class:"flex items-end"},[e("button",{type:"submit",class:"w-full px-4 py-2 text-white transition duration-200 bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"}," ค้นหา ")],-1))],32)]),e("div",Re,[e("div",We,[e("div",Je,[e("div",Qe,[e("h3",Xe,"ผลการค้นหา ("+o(b.value.length)+" รายการ)",1)]),W.value?(d(),r("div",Ye," กำลังค้นหาเส้นทาง... ")):(d(),r("div",et,[b.value.length===0?(d(),r("div",tt," ไม่พบเส้นทางที่ค้นหา ")):x("",!0),(d(!0),r(k,null,M(b.value,l=>(d(),r("div",{key:l.id,class:"p-6 transition-all duration-300 cursor-pointer route-card hover:shadow-lg",onClick:s=>ke(l)},[e("h1",st,[be(o(l.originName)+" ",1),t[18]||(t[18]=e("span",{class:"mx-1 font-semibold text-gray-900"},"→",-1)),be(" "+o(l.destinationName),1)]),e("div",at,[e("img",{src:l.driver.image,alt:l.driver.name,class:"object-cover w-12 h-12 rounded-full"},null,8,nt),e("div",ot,[e("div",it,[e("div",null,[e("div",rt,[e("h4",dt,o(l.driver.name),1),l.driver.isVerified?(d(),r("div",ut,t[19]||(t[19]=[e("svg",{class:"w-5 h-5 text-blue-600",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8.603 3.799A4.49 4.49 0 0112 2.25c1.357 0 2.573.6 3.397 1.549a4.49 4.49 0 013.498 1.307 4.491 4.491 0 011.307 3.497A4.49 4.49 0 0121.75 12c0 1.357-.6 2.573-1.549 3.397a4.49 4.49 0 01-1.307 3.498 4.491 4.491 0 01-3.497 1.307A4.49 4.49 0 0112 21.75a4.49 4.49 0 01-3.397-1.549 4.49 4.49 0 01-3.498-1.306 4.491 4.491 0 01-1.307-3.498A4.49 4.49 0 012.25 12c0-1.357.6-2.573 1.549-3.397a4.49 4.49 0 011.307-3.497 4.49 4.49 0 013.497-1.307zm7.007 6.387a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.07-.01l3.5-4.875z","clip-rule":"evenodd"})],-1),e("span",{class:"absolute px-2 py-1 mb-2 text-xs text-white transition-opacity -translate-x-1/2 bg-gray-800 rounded-md opacity-0 pointer-events-none bottom-full left-1/2 w-max group-hover:opacity-100"}," ผู้ขับขี่ยืนยันตัวตนแล้ว ",-1)]))):x("",!0)]),e("div",ct,[e("div",mt,[(d(),r(k,null,M(5,s=>e("span",{key:s},o(s<=l.driver.rating?"★":"☆"),1)),64))]),e("span",gt,o(l.driver.rating)+" ("+o(l.driver.reviews)+" รีวิว) ",1)])]),e("div",pt,[e("div",vt,o(l.price)+" บาท",1),t[20]||(t[20]=e("div",{class:"text-sm text-gray-600"},"ต่อที่นั่ง",-1))])]),e("div",ft,[e("div",bt,[e("span",yt,o(l.date),1),t[21]||(t[21]=e("span",{class:"mx-2 text-gray-300"},"|",-1)),t[22]||(t[22]=e("span",{class:"font-medium"},"เวลาออก:",-1)),e("span",xt,o(l.departureTime),1),t[23]||(t[23]=e("span",{class:"mx-2 text-gray-300"},"|",-1)),t[24]||(t[24]=e("span",{class:"font-medium"},"ระยะเวลา:",-1)),e("span",_t,o(l.durationText),1),t[25]||(t[25]=e("span",{class:"mx-2 text-gray-300"},"|",-1)),t[26]||(t[26]=e("span",{class:"font-medium"},"ระยะทาง:",-1)),e("span",ht,o(l.distanceText),1)]),e("div",wt,[e("span",{class:Ie(["px-2 py-1 rounded-full text-xs font-medium",l.availableSeats>2?"bg-green-100 text-green-800":l.availableSeats>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"])},o(l.availableSeats>0?`เหลือ ${l.availableSeats}
                                                    ที่นั่ง`:"เต็มแล้ว"),3)])])])]),P.value&&P.value.id===l.id?(d(),r("div",kt,[e("div",Mt,[e("div",null,[t[27]||(t[27]=e("h5",{class:"mb-2 font-medium text-gray-900"},"รายละเอียดเส้นทาง",-1)),e("ul",Pt,[l.originArea?(d(),r("li",Ct,"• จุดเริ่มต้น (พื้นที่): "+o(l.originArea),1)):x("",!0),l.destinationArea?(d(),r("li",At,"• จุดปลายทาง (พื้นที่): "+o(l.destinationArea),1)):x("",!0),(d(!0),r(k,null,M(l.stops,s=>(d(),r("li",{key:s},"• "+o(s),1))),128))]),e("ul",Lt,[(d(!0),r(k,null,M(l.stops,s=>(d(),r("li",{key:s},"• "+o(s),1))),128))])]),e("div",null,[t[28]||(t[28]=e("h5",{class:"mb-2 font-medium text-gray-900"},"รายละเอียดรถ",-1)),e("ul",St,[(d(!0),r(k,null,M(l.carDetails,s=>(d(),r("li",{key:s},"• "+o(s),1))),128))])])]),e("div",Tt,[l.conditions?(d(),r("div",Bt,[t[29]||(t[29]=e("h5",{class:"mb-2 font-medium text-gray-900"},"เงื่อนไขการเดินทาง",-1)),e("p",Nt,o(l.conditions),1)])):x("",!0),l.photos&&l.photos.length>0?(d(),r("div",$t,[t[30]||(t[30]=e("h5",{class:"mb-2 font-medium text-gray-900"},"รูปภาพรถยนต์",-1)),e("div",Vt,[(d(!0),r(k,null,M(l.photos.slice(0,3),(s,n)=>(d(),r("div",{key:n,class:""},[e("img",{src:s,alt:"Vehicle photo",class:"object-cover w-full transition-opacity border border-gray-300 rounded-lg shadow-sm cursor-pointer aspect-video hover:opacity-90"},null,8,jt)]))),128))])])):x("",!0)]),e("div",zt,[e("button",{onClick:D(s=>Ce(l),["stop"]),disabled:l.availableSeats===0,class:"px-6 py-2 text-white transition duration-200 bg-blue-600 rounded-md hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed"}," จองที่นั่ง ",8,Ft)])])):x("",!0)],8,lt))),128))]))])]),e("div",It,[e("div",Et,[t[31]||(t[31]=e("div",{class:"p-6 border-b border-gray-300"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"แผนที่เส้นทาง")],-1)),e("div",{ref_key:"mapContainer",ref:J,class:"h-96"},null,512)])])])]),ge(fe,{name:"modal-fade"},{default:ve(()=>[X.value&&m.value?(d(),r("div",{key:0,class:"modal-overlay",onClick:D(E,["self"])},[e("div",Ut,[e("div",{class:"flex items-center justify-between p-6 border-b border-gray-300"},[t[33]||(t[33]=e("h3",{class:"text-xl font-semibold text-gray-900"},"ยืนยันการจอง",-1)),e("button",{onClick:E,class:"text-gray-400 hover:text-gray-600"},t[32]||(t[32]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",Dt,[e("div",Ot,[t[35]||(t[35]=e("h4",{class:"mb-3 font-semibold text-gray-900"},"เดินทางกับ",-1)),e("div",Kt,[e("img",{src:m.value.driver.image,alt:m.value.driver.name,class:"object-cover w-12 h-12 rounded-full"},null,8,Gt),e("div",null,[e("div",Ht,[e("div",Zt,o(m.value.driver.name),1),m.value.driver.isVerified?(d(),r("div",qt,t[34]||(t[34]=[e("svg",{class:"w-5 h-5 text-blue-600",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8.603 3.799A4.49 4.49 0 0112 2.25c1.357 0 2.573.6 3.397 1.549a4.49 4.49 0 013.498 1.307 4.491 4.491 0 011.307 3.497A4.49 4.49 0 0121.75 12c0 1.357-.6 2.573-1.549 3.397a4.49 4.49 0 01-1.307 3.498 4.491 4.491 0 01-3.497 1.307A4.49 4.49 0 0112 21.75a4.49 4.49 0 01-3.397-1.549 4.49 4.49 0 01-3.498-1.306 4.491 4.491 0 01-1.307-3.498A4.49 4.49 0 012.25 12c0-1.357.6-2.573 1.549-3.397a4.49 4.49 0 011.307-3.497 4.49 4.49 0 013.497-1.307zm7.007 6.387a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.07-.01l3.5-4.875z","clip-rule":"evenodd"})],-1),e("span",{class:"absolute px-2 py-1 mb-2 text-xs text-white transition-opacity -translate-x-1/2 bg-gray-800 rounded-md opacity-0 pointer-events-none bottom-full left-1/2 w-max group-hover:opacity-100"}," ผู้ขับขี่ยืนยันตัวตนแล้ว ",-1)]))):x("",!0)]),e("div",Rt,[e("div",Wt,[(d(),r(k,null,M(5,l=>e("span",{key:l},o(l<=m.value.driver.rating?"★":"☆"),1)),64))]),e("span",Jt,o(m.value.driver.rating)+" ("+o(m.value.driver.reviews)+" รีวิว)",1)])])])]),e("div",Qt,[e("div",null,[t[36]||(t[36]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"วันที่เดินทาง",-1)),e("div",Xt,o(m.value.date),1)]),e("div",null,[t[37]||(t[37]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"เวลาออก",-1)),e("div",Yt,o(m.value.departureTime),1)])]),e("div",el,[t[41]||(t[41]=e("h4",{class:"mb-3 font-semibold text-gray-900"},"เส้นทางการเดินทาง",-1)),e("div",tl,[e("div",ll,[e("div",sl,o(m.value.originName),1),t[38]||(t[38]=e("div",{class:"text-sm text-gray-600"},"จุดเริ่มต้น",-1))]),t[40]||(t[40]=e("div",{class:"text-blue-600"},[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})])],-1)),e("div",al,[e("div",nl,o(m.value.destinationName),1),t[39]||(t[39]=e("div",{class:"text-sm text-gray-600"},"จุดปลายทาง",-1))])])]),e("div",ol,[e("div",null,[t[42]||(t[42]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"จำนวนที่นั่งที่ต้องการจอง",-1)),C(e("select",{"onUpdate:modelValue":t[6]||(t[6]=l=>L.value=l),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},[(d(!0),r(k,null,M(m.value.availableSeats,l=>(d(),r("option",{key:l,value:l},o(l)+" ที่นั่ง ",9,il))),128))],512),[[pe,L.value]])]),e("div",null,[t[43]||(t[43]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"เลือกจุดขึ้นรถ",-1)),C(e("input",{type:"text","onUpdate:modelValue":t[7]||(t[7]=l=>B.value=l),placeholder:"กรอกเพื่อค้นหาจุดขึ้นรถ...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[$,B.value]])]),e("div",null,[t[44]||(t[44]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"เลือกจุดลงรถ",-1)),C(e("input",{type:"text","onUpdate:modelValue":t[8]||(t[8]=l=>N.value=l),placeholder:"กรอกเพื่อค้นหาจุดลงรถ...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[$,N.value]])])]),e("div",rl,[e("div",dl,[t[45]||(t[45]=e("span",{class:"text-gray-700"},"ราคาต่อที่นั่ง",-1)),e("span",ul,o(m.value.price)+" บาท",1)]),e("div",cl,[t[46]||(t[46]=e("span",{class:"text-gray-700"},"จำนวนที่นั่ง",-1)),e("span",ml,o(L.value)+" ที่นั่ง",1)]),e("div",gl,[e("div",pl,[t[47]||(t[47]=e("span",{class:"font-semibold text-gray-900"},"ยอดรวม",-1)),e("span",vl,o(we.value)+" บาท",1)])])]),e("div",{class:"flex space-x-4"},[e("button",{onClick:E,class:"flex-1 px-4 py-3 font-semibold text-gray-800 transition duration-200 bg-gray-200 rounded-md hover:bg-gray-300"}," ยกเลิก "),e("button",{onClick:Ae,class:"flex-1 px-4 py-3 font-semibold text-white transition duration-200 bg-blue-600 rounded-md hover:bg-blue-700"}," ยืนยันการจอง ")])])])])):x("",!0)]),_:1}),ge(fe,{name:"modal-fade"},{default:ve(()=>[R.value?(d(),r("div",{key:0,class:"modal-overlay",onClick:D(U,["self"])},[e("div",fl,[e("div",bl,[e("h3",yl,"เลือก"+o(A.value==="origin"?"จุดเริ่มต้น":"จุดปลายทาง"),1),e("button",{onClick:U,class:"text-gray-400 hover:text-gray-600"},t[48]||(t[48]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",xl,[e("div",{ref_key:"placePickerMapEl",ref:ae,class:"w-full border border-gray-200 rounded-md h-80"},null,512),e("div",_l,[t[49]||(t[49]=e("div",{class:"font-medium"},"ตำแหน่งที่เลือก:",-1)),e("div",hl,o(f.value.name||"— ยังไม่เลือก —"),1),f.value.lat&&f.value.lng?(d(),r("div",wl," lat: "+o(f.value.lat.toFixed(6))+", lng: "+o(f.value.lng.toFixed(6)),1)):x("",!0)]),e("div",kl,[e("button",{onClick:U,class:"flex-1 px-4 py-2 font-semibold text-gray-800 bg-gray-200 rounded-md hover:bg-gray-300"}," ยกเลิก "),e("button",{disabled:!f.value.name,onClick:Se,class:"flex-1 px-4 py-2 font-semibold text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed"}," ใช้ตำแหน่งนี้ ",8,Ml)])])])])):x("",!0)]),_:1})]))}},Vl=Ne(Pl,[["__scopeId","data-v-cf4a614d"]]);export{Vl as default};
